!function(t){function e(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var r={};e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=31)}([function(t,e,r){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e,r,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a(this,t),this.label=e,this.type=r,this._data=n,this._init(r,i),this.updated=!0}return i(t,[{key:"_init",value:function(t,e){var r=this;switch(this.type){case 35675:this.bind=function(t,e){t.uniformMatrix3fv(e,!1,r.data)};break;case 35676:this.bind=function(t,e){t.uniformMatrix4fv(e,!1,r.data)};break;case 35664:this.bind=function(t,e){t.uniform2f.apply(t,[e].concat(n(r.data)))};break;case 35665:this.bind=function(t,e){t.uniform3f.apply(t,[e].concat(n(r.data)))};break;case 5124:this.bind=function(t,e){t.uniform1i(e,r.data)};break;case-1:this.bind=function(t,e){t.uniform1fv(e,r.data)};break;default:console.error("Uniform type unknow: {label:",this.label,", type:",t,"}")}}},{key:"data",get:function(){return this._data},set:function(t){this._data=t,this.updated=!0}}]),t}();e.default=o},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(){n(this,t),this.lastTexture=null,this.lastProgram=null,this.lastDepthTest=!1}return a(t,[{key:"optimizeTexture",value:function(t){var e=this.lastTexture;return this.lastTexture=t,t===e}},{key:"optimizeProgram",value:function(t){var e=this.lastProgram;return this.lastProgram=t,t===e}},{key:"optimizeDepthTest",value:function(t){var e=this.lastDepthTest;return this.lastDepthTest=t,e===t}}],[{key:"getInstance",value:function(e){var r=t.glList.indexOf(e);if(r<0){var n=new t;return t.glList.push(e),t.list.push(n),n}return t.list[r]}}]),t}();i.glList=[],i.list=[],e.default=i},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=0,o=function(){function t(e,r){n(this,t),this.vertexShaderSrc=e,this.fragmentShaderSrc=r,this.attribLocation={},this.uniformLocation={},this.textureLocation={},this.textureIndex={},this.textureNum=0,this.id=i++}return a(t,[{key:"isInitialized",value:function(){return!!this.pointer}},{key:"init",value:function(t){this.vertexShader=this._createShader(t,35633,this.vertexShaderSrc),this.fragmentShader=this._createShader(t,35632,this.fragmentShaderSrc);var e=t.createProgram();return t.attachShader(e,this.vertexShader),t.attachShader(e,this.fragmentShader),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)?(t.useProgram(e),this.pointer=e,!0):(console.error("Shader initialization error"),!1)}},{key:"getAttribLocation",value:function(t,e){var r=e.label;if(!this.attribLocation.hasOwnProperty(r)){var n=t.getAttribLocation(this.pointer,r);return t.enableVertexAttribArray(n),this.attribLocation[r]=n,n}return this.attribLocation[r]}},{key:"getUniformLocation",value:function(t,e){var r=e.label;if(!this.uniformLocation.hasOwnProperty(r)){var n=t.getUniformLocation(this.pointer,r);return this.uniformLocation[r]=n,n}return this.uniformLocation[r]}},{key:"getTextureLocationIndex",value:function(t,e){var r=e.label;if(!this.textureLocation.hasOwnProperty(r)||!this.textureIndex.hasOwnProperty(r)){var n=t.getUniformLocation(this.pointer,r);return this.textureLocation[r]=n,this.textureIndex[r]=this.textureNum,[n,this.textureNum++]}return[this.textureLocation[r],this.textureIndex[r]]}},{key:"bind",value:function(t){t.useProgram(this.pointer)}},{key:"_createShader",value:function(t,e,r){var n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:console.error("Une erreur est survenue au cours de la compilation du shader: "+t.getShaderInfoLog(n))}}]),t}();e.default=o},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(7),u=n(o),s=r(11),l=n(s),f=function(){function t(){a(this,t),this.attributes=[],this.buffers=[],this.hasIndices=!1,this.numItems=0}return i(t,[{key:"addVertices",value:function(t,e,r){var n=new l.default(t);n.setArray(new Float32Array(e),34962),n.setItems(5126,r),this.attributes.push(n),this.numItems<1&&(this.numItems=e.length/r)}},{key:"addIndices",value:function(t){var e=new u.default;e.setArray(new Uint16Array(t),34963),e.setItems(5125,1),this.hasIndices=!0,this.buffers.push(e),this.numItems=t.length}},{key:"display",value:function(t){this.hasIndices?t.drawElements(t.TRIANGLES,this.numItems,t.UNSIGNED_SHORT,0):t.drawArrays(t.TRIANGLES,0,this.numItems)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t;return e.attributes=this.attributes.map(function(t){return t.clone()}),e.buffers=this.buffers.map(function(t){return t.clone()}),e.hasIndices=this.hasIndices,e.numItems=this.numItems,e}}]),t}();e.default=f},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function t(e,r,n){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,r);if(void 0===a){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(n)},l=r(6),f=n(l),c=r(12),h=n(c),d=function(t){function e(t,r){a(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));n.depthTest=!0;var o=new h.default("uMVMatrix");return n.transform=o,n.addUniform(o),n}return o(e,t),u(e,[{key:"draw",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.transform&&this.transform.update(),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,r)}},{key:"position",get:function(){return this.transform.getTranslation()}},{key:"rotation",get:function(){return this.transform.getRotation()}}]),e}(f.default);e.default=d},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,r,n,a,i,o,u,s,l,f,c,h,d,p,v,y){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=s,t[8]=l,t[9]=f,t[10]=c,t[11]=h,t[12]=d,t[13]=p,t[14]=v,t[15]=y,t}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){a=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(){function t(){n(this,t),console.warn("Matrix4 is a static class")}return o(t,null,[{key:"create",value:function(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}},{key:"clone",value:function(e){return t.copy(e)}},{key:"copy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16);return e.set(t),e}},{key:"identity",value:function(t){return a(t,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}},{key:"add",value:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[3],t[4]+=e[4],t[5]+=e[5],t[6]+=e[6],t[7]+=e[7],t[8]+=e[8],t[9]+=e[9],t[10]+=e[10],t[11]+=e[11],t[12]+=e[12],t[13]+=e[13],t[14]+=e[14],t[15]+=e[15],t}},{key:"subtract",value:function(t,e){return t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t[3]-=e[3],t[4]-=e[4],t[5]-=e[5],t[6]-=e[6],t[7]-=e[7],t[8]-=e[8],t[9]-=e[9],t[10]-=e[10],t[11]-=e[11],t[12]-=e[12],t[13]-=e[13],t[14]-=e[14],t[15]-=e[15],t}},{key:"multiplyScalar",value:function(t){return m1[0]*=t,m1[1]*=t,m1[2]*=t,m1[3]*=t,m1[4]*=t,m1[5]*=t,m1[6]*=t,m1[7]*=t,m1[8]*=t,m1[9]*=t,m1[10]*=t,m1[11]*=t,m1[12]*=t,m1[13]*=t,m1[14]*=t,m1[15]*=t,m1}},{key:"multiplyScalarAndAdd",value:function(t,e,r){return t[0]+=e[0]*r,t[1]+=e[1]*r,t[2]+=e[2]*r,t[3]+=e[3]*r,t[4]+=e[4]*r,t[5]+=e[5]*r,t[6]+=e[6]*r,t[7]+=e[7]*r,t[8]+=e[8]*r,t[9]+=e[9]*r,t[10]+=e[10]*r,t[11]+=e[11]*r,t[12]+=e[12]*r,t[13]+=e[13]*r,t[14]+=e[14]*r,t[15]+=e[15]*r,t}},{key:"exactEquals",value:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}},{key:"equals",value:function(t,e){var r=i(t,16),n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],l=r[5],f=r[6],c=r[7],h=r[8],d=r[9],p=r[10],v=r[11],y=r[12],m=r[13],b=r[14],g=r[15],_=i(e,16),w=_[0],x=_[1],M=_[2],T=_[3],k=_[4],P=_[5],O=_[6],E=_[7],D=_[8],C=_[9],j=_[10],I=_[11],R=_[12],F=_[13],S=_[14],A=_[15];return Math.abs(n-w)<=1e-6*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(a-x)<=1e-6*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-M)<=1e-6*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(u-T)<=1e-6*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(s-k)<=1e-6*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(l-P)<=1e-6*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(f-O)<=1e-6*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(c-E)<=1e-6*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(h-D)<=1e-6*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(d-C)<=1e-6*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(p-j)<=1e-6*Math.max(1,Math.abs(p),Math.abs(j))&&Math.abs(v-I)<=1e-6*Math.max(1,Math.abs(v),Math.abs(I))&&Math.abs(y-R)<=1e-6*Math.max(1,Math.abs(y),Math.abs(R))&&Math.abs(m-F)<=1e-6*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(b-S)<=1e-6*Math.max(1,Math.abs(b),Math.abs(S))&&Math.abs(g-A)<=1e-6*Math.max(1,Math.abs(g),Math.abs(A))}},{key:"transpose",value:function(t,e){if(e===t){var r=e[1],n=e[2],i=e[3],o=e[6],u=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=u,t[14]=s}else a(t,e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]);return t}},{key:"invert",value:function(t){var e=i(t,16),r=e[0],n=e[1],o=e[2],u=e[3],s=e[4],l=e[5],f=e[6],c=e[7],h=e[8],d=e[9],p=e[10],v=e[11],y=e[12],m=e[13],b=e[14],g=e[15],_=r*l-n*s,w=r*f-o*s,x=r*c-u*s,M=n*f-o*l,T=n*c-u*l,k=o*c-u*f,P=h*m-d*y,O=h*b-p*y,E=h*g-v*y,D=d*b-p*m,C=d*g-v*m,j=p*g-v*b,I=_*j-w*C+x*D+M*E-T*O+k*P;return I?(I=1/I,a(t,(l*j-f*C+c*D)*I,(o*C-n*j-u*D)*I,(m*k-b*T+g*M)*I,(p*T-d*k-v*M)*I,(f*E-s*j-c*O)*I,(r*j-o*E+u*O)*I,(b*x-y*k-g*w)*I,(h*k-p*x+v*w)*I,(s*C-l*E+c*P)*I,(n*E-r*C-u*P)*I,(y*T-m*x+g*_)*I,(d*x-h*T-v*_)*I,(l*O-s*D-f*P)*I,(r*D-n*O+o*P)*I,(m*w-y*M-b*_)*I,(h*M-d*w+p*_)*I)):t}},{key:"adjoint",value:function(t){var e=i(t,16),r=e[0],n=e[1],o=e[2],u=e[3],s=e[4],l=e[5],f=e[6],c=e[7],h=e[8],d=e[9],p=e[10],v=e[11],y=e[12],m=e[13],b=e[14],g=e[15];return a(t,l*(p*g-v*b)-d*(f*g-c*b)+m*(f*v-c*p),-(n*(p*g-v*b)-d*(o*g-u*b)+m*(o*v-u*p)),n*(f*g-c*b)-l*(o*g-u*b)+m*(o*c-u*f),-(n*(f*v-c*p)-l*(o*v-u*p)+d*(o*c-u*f)),-(s*(p*g-v*b)-h*(f*g-c*b)+y*(f*v-c*p)),r*(p*g-v*b)-h*(o*g-u*b)+y*(o*v-u*p),-(r*(f*g-c*b)-s*(o*g-u*b)+y*(o*c-u*f)),r*(f*v-c*p)-s*(o*v-u*p)+h*(o*c-u*f),s*(d*g-v*m)-h*(l*g-c*m)+y*(l*v-c*d),-(r*(d*g-v*m)-h*(n*g-u*m)+y*(n*v-u*d)),r*(l*g-c*m)-s*(n*g-u*m)+y*(n*c-u*l),-(r*(l*v-c*d)-s*(n*v-u*d)+h*(n*c-u*l)),-(s*(d*b-p*m)-h*(l*b-f*m)+y*(l*p-f*d)),r*(d*b-p*m)-h*(n*b-o*m)+y*(n*p-o*d),-(r*(l*b-f*m)-s*(n*b-o*m)+y*(n*f-o*l)),r*(l*p-f*d)-s*(n*p-o*d)+h*(n*f-o*l))}},{key:"determinant",value:function(t){var e=i(t,16),r=e[0],n=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=e[6],f=e[7],c=e[8],h=e[9],d=e[10],p=e[11],v=e[12],y=e[13],m=e[14],b=e[15];return(r*s-n*u)*(d*b-p*m)-(r*l-a*u)*(h*b-p*y)+(r*f-o*u)*(h*m-d*y)+(n*l-a*s)*(c*b-p*v)-(n*f-o*s)*(c*m-d*v)+(a*f-o*l)*(c*y-h*v)}},{key:"multiply",value:function(t,e){var r=i(t,16),n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],l=r[5],f=r[6],c=r[7],h=r[8],d=r[9],p=r[10],v=r[11],y=r[12],m=r[13],b=r[14],g=r[15],_=i(e,4),w=_[0],x=_[1],M=_[2],T=_[3];return t[0]=w*n+x*s+M*h+T*y,t[1]=w*a+x*l+M*d+T*m,t[2]=w*o+x*f+M*p+T*b,t[3]=w*u+x*c+M*v+T*g,w=e[4],x=e[5],M=e[6],T=e[7],t[4]=w*n+x*s+M*h+T*y,t[5]=w*a+x*l+M*d+T*m,t[6]=w*o+x*f+M*p+T*b,t[7]=w*u+x*c+M*v+T*g,w=e[8],x=e[9],M=e[10],T=e[11],t[8]=w*n+x*s+M*h+T*y,t[9]=w*a+x*l+M*d+T*m,t[10]=w*o+x*f+M*p+T*b,t[11]=w*u+x*c+M*v+T*g,w=e[12],x=e[13],M=e[14],T=e[15],t[12]=w*n+x*s+M*h+T*y,t[13]=w*a+x*l+M*d+T*m,t[14]=w*o+x*f+M*p+T*b,t[15]=w*u+x*c+M*v+T*g,t}},{key:"translate",value:function(t,e){var r=i(e,3),n=r[0],a=r[1],o=r[2];return t[12]=t[0]*n+t[4]*a+t[8]*o+t[12],t[13]=t[1]*n+t[5]*a+t[9]*o+t[13],t[14]=t[2]*n+t[6]*a+t[10]*o+t[14],t[15]=t[3]*n+t[7]*a+t[11]*o+t[15],t}},{key:"scale",value:function(t,e){var r=i(e,3),n=r[0],a=r[1],o=r[2];return t[0]*=n,t[1]*=n,t[2]*=n,t[3]*=n,t[4]*=a,t[5]*=a,t[6]*=a,t[7]*=a,t[8]*=o,t[9]*=o,t[10]*=o,t[11]*=o,t}},{key:"rotate",value:function(t,e,r){var n=i(r,3),a=n[0],o=n[1],u=n[2],s=Math.sqrt(a*a+o*o+u*u);if(Math.abs(s)>1e-6){s=1/s,a*=s,o*=s,u*=s;var l=Math.sin(e),f=Math.cos(e),c=1-f,h=i(t,12),d=h[0],p=h[1],v=h[2],y=h[3],m=h[4],b=h[5],g=h[6],_=h[7],w=h[8],x=h[9],M=h[10],T=h[11],k=a*a*c+f,P=o*a*c+u*l,O=u*a*c-o*l,E=a*o*c-u*l,D=o*o*c+f,C=u*o*c+a*l,j=a*u*c+o*l,I=o*u*c-a*l,R=u*u*c+f;t[0]=d*k+m*P+w*O,t[1]=p*k+b*P+x*O,t[2]=v*k+g*P+M*O,t[3]=y*k+_*P+T*O,t[4]=d*E+m*D+w*C,t[5]=p*E+b*D+x*C,t[6]=v*E+g*D+M*C,t[7]=y*E+_*D+T*C,t[8]=d*j+m*I+w*R,t[9]=p*j+b*I+x*R,t[10]=v*j+g*I+M*R,t[11]=y*j+_*I+T*R}return t}},{key:"rotateX",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),a=t[4],i=t[5],o=t[6],u=t[7],s=t[8],l=t[9],f=t[10],c=t[11];return t[4]=a*n+s*r,t[5]=i*n+l*r,t[6]=o*n+f*r,t[7]=u*n+c*r,t[8]=s*n-a*r,t[9]=l*n-i*r,t[10]=f*n-o*r,t[11]=c*n-u*r,t}},{key:"rotateY",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),a=i(t,4),o=a[0],u=a[1],s=a[2],l=a[3],f=t[8],c=t[9],h=t[10],d=t[11];return t[0]=o*n-f*r,t[1]=u*n-c*r,t[2]=s*n-h*r,t[3]=l*n-d*r,t[8]=o*r+f*n,t[9]=u*r+c*n,t[10]=s*r+h*n,t[11]=l*r+d*n,t}},{key:"rotateZ",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),a=i(t,8),o=a[0],u=a[1],s=a[2],l=a[3],f=a[4],c=a[5],h=a[6],d=a[7];return t[0]=o*n+f*r,t[1]=u*n+c*r,t[2]=s*n+h*r,t[3]=l*n+d*r,t[4]=f*n-o*r,t[5]=c*n-u*r,t[6]=h*n-s*r,t[7]=d*n-l*r,t}},{key:"fromTranslation",value:function(t){var e=i(t,3),r=e[0],n=e[1],o=e[2];return a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),1,0,0,0,0,1,0,0,0,0,1,0,r,n,o,1)}},{key:"fromScaling",value:function(t){var e=i(t,3),r=e[0],n=e[1],o=e[2];return a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),r,0,0,0,0,n,0,0,0,0,o,0,0,0,0,1)}},{key:"fromRotation",value:function(t,e){var r=i(e,3),n=r[0],o=r[1],u=r[2],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Float32Array(16),l=Math.sqrt(n*n+o*o+u*u);if(Math.abs(l)>1e-6){l=1/l,n*=l,o*=l,u*=l;var f=Math.sin(t),c=Math.cos(t),h=1-c;a(s,n*n*h+c,o*n*h+u*f,u*n*h-o*f,0,n*o*h-u*f,o*o*h+c,u*o*h+n*f,0,n*u*h+o*f,o*u*h-n*f,u*u*h+c,0,0,0,0,1)}return s}},{key:"fromXRotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),r=Math.sin(t),n=Math.cos(t);return a(e,1,0,0,0,0,n,r,0,0,-r,n,0,0,0,0,1)}},{key:"fromYRotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),r=Math.sin(t),n=Math.cos(t);return a(e,n,0,-r,0,0,1,0,0,r,0,n,0,0,0,0,1)}},{key:"fromZRotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),r=Math.sin(t),n=Math.cos(t);return a(e,n,r,0,0,-r,n,0,0,0,0,1,0,0,0,0,1)}},{key:"fromQuat",value:function(t){var e=i(t,4),r=e[0],n=e[1],o=e[2],u=e[3],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),l=r+r,f=n+n,c=o+o,h=r*l,d=n*l,p=n*f,v=o*l,y=o*f,m=o*c,b=u*l,g=u*f,_=u*c;return a(s,1-p-m,d+_,v-g,0,d-_,1-h-m,y+b,0,v+g,y-b,1-h-p,0,0,0,0,1)}},{key:"fromQuatTranslation",value:function(t,e){var r=i(t,4),n=r[0],o=r[1],u=r[2],s=r[3],l=i(e,3),f=l[0],c=l[1],h=l[2],d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Float32Array(16),p=n+n,v=o+o,y=u+u,m=n*p,b=n*v,g=n*y,_=o*v,w=o*y,x=u*y,M=s*p,T=s*v,k=s*y;return a(d,1-(_+x),b+k,g-T,0,b-k,1-(m+x),w+M,0,g+T,w-M,1-(m+_),0,f,c,h,1)}},{key:"fromQuatTranslationScale",value:function(t,e,r){var n=i(t,4),o=n[0],u=n[1],s=n[2],l=n[3],f=i(e,3),c=f[0],h=f[1],d=f[2],p=i(r,3),v=p[0],y=p[1],m=p[2],b=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Float32Array(16),g=o+o,_=u+u,w=s+s,x=o*g,M=o*_,T=o*w,k=u*_,P=u*w,O=s*w,E=l*g,D=l*_,C=l*w;return a(b,(1-(k+O))*v,(M+C)*v,(T-D)*v,0,(M-C)*y,(1-(x+O))*y,(P+E)*y,0,(T+D)*m,(P-E)*m,(1-(x+k))*m,0,c,h,d,1)}},{key:"fromQuatTranslationScaleOrigin",value:function(t,e,r,n){var o=i(t,4),u=o[0],s=o[1],l=o[2],f=o[3],c=i(e,3),h=c[0],d=c[1],p=c[2],v=i(r,3),y=v[0],m=v[1],b=v[2],g=i(n,3),_=g[0],w=g[1],x=g[2],M=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Float32Array(16),T=u+u,k=s+s,P=l+l,O=u*T,E=u*k,D=u*P,C=s*k,j=s*P,I=l*P,R=f*T,F=f*k,S=f*P;return a(M,(1-(C+I))*y,(E+S)*y,(D-F)*y,0,(E-S)*m,(1-(O+I))*m,(j+R)*m,0,(D+F)*b,(j-R)*b,(1-(O+C))*b,0,h+_-(M[0]*_+M[4]*w+M[8]*x),d+w-(M[1]*_+M[5]*w+M[9]*x),p+x-(M[2]*_+M[6]*w+M[10]*x),1),M}},{key:"getTranslation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(3);return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}},{key:"getQuat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(4),r=t[0]+t[5]+t[10];if(r>0){var n=2*Math.sqrt(r+1);e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n,e[3]=.25*n}else if(t[0]>t[5]&t[0]>t[10]){var a=2*Math.sqrt(1+t[0]-t[5]-t[10]);e[0]=.25*a,e[1]=(t[1]+t[4])/a,e[2]=(t[8]+t[2])/a,e[3]=(t[6]-t[9])/a}else if(t[5]>t[10]){var i=Math.sqrt(1+t[5]-t[0]-t[10]);e[0]=(t[1]+t[4])/i*2,e[1]=.25*i,e[2]=(t[6]+t[9])/i,e[3]=(t[8]-t[2])/i}else{var o=2*Math.sqrt(1+t[10]-t[0]-t[5]);e[0]=(t[8]+t[2])/o,e[1]=(t[6]+t[9])/o,e[2]=.25*o,e[3]=(t[1]-t[4])/o}return e}},{key:"frustrum",value:function(t,e,r,n,i,o,u){var s=1/(r-e),l=1/(i-n),f=1/(o-u);return a(t,2*o*s,0,0,0,0,2*o*l,0,0,(r+e)*s,(i+n)*l,(u+o)*f,-1,0,0,u*o*2*f,0)}},{key:"perspective",value:function(t,e,r,n,i){var o=1/Math.tan(e/2),u=1/(n-i);return a(t,o/r,0,0,0,0,o,0,0,0,0,(i+n)*u,-1,0,0,2*i*n*u,0)}},{key:"perspectiveFromFieldOfView",value:function(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),u=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(u+s),f=2/(i+o);return a(t,l,0,0,0,0,f,0,0,-(u-s)*l*.5,(i-o)*f*.5,n/(r-n),-1,0,0,n*r/(r-n),0)}},{key:"ortho",value:function(t,e,r,n,i,o,u){var s=1/(e-r),l=1/(n-i),f=1/(o-u);return a(t,-2*s,0,0,0,0,-2*l,0,0,0,0,2*f,0,(e+r)*s,(i+n)*l,(u+o)*f,1)}},{key:"lookAt",value:function(e,r,n,o){var u=i(r,3),s=u[0],l=u[1],f=u[2],c=i(o,3),h=c[0],d=c[1],p=c[2],v=i(n,3),y=v[0],m=v[1],b=v[2];if(Math.abs(s-y)<1e-6&&Math.abs(l-m)<1e-6&&Math.abs(f-b)<1e-6)return t.identity(e);var g=s-y,_=l-m,w=f-b,x=1/Math.sqrt(g*g+_*_+w*w);g*=x,_*=x,w*=x;var M=d*w-p*_,T=p*g-h*w,k=h*_-d*g;x=Math.sqrt(M*M+T*T+k*k),x?(x=1/x,M*=x,T*=x,k*=x):(M=0,T=0,k=0);var P=_*k-w*T,O=w*M-g*k,E=g*T-_*M;return x=Math.sqrt(P*P+O*O+E*E),x?(x=1/x,P*=x,O*=x,E*=x):(P=0,O=0,E=0),a(e,M,P,g,0,T,O,_,0,k,E,w,0,-(M*s+T*l+k*f),-(P*s+O*l+E*f),-(g*s+_*l+w*f),1)}},{key:"frob",value:function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}}]),t}();e.default=u},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){a=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(1),u=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(e,r){n(this,t),this.geom=e,this.program=r,this.uniforms=[],this.globalUniforms=[],this.textures=[],this.localCalls=[],this.globalCalls=[],this.order=1,this.visible=!0,this.depthTest=!1,this.blending={},this._isInitialized=!1}return i(t,[{key:"addBlending",value:function(t,e){this.blending[t]=e}},{key:"addUniform",value:function(t){this.uniforms.push(t)}},{key:"removeUniform",value:function(t){var e=this.uniforms.indexOf(t);e>-1&&this.uniforms.splice(e,1)}},{key:"addGlobalUniform",value:function(t){this.globalUniforms.push(t)}},{key:"removeGlobalUniform",value:function(t){var e=this.globalUniforms.indexOf(t);e>-1&&this.globalUniforms.splice(e,1)}},{key:"addTexture",value:function(t){this.textures.push(t)}},{key:"removeTexture",value:function(t){var e=this.textures.indexOf(t);e>-1&&this.textures.splice(e,1)}},{key:"isInitialized",value:function(){var t=this._isInitialized;if(t)return t;this.program.isInitialized()||(t=!1);var e=!0,r=!1,n=void 0;try{for(var a,i=this.geom.attributes[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){a.value.isInitialized()||(t=!1)}}catch(t){r=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(r)throw n}}var o=!0,u=!1,s=void 0;try{for(var l,f=this.geom.buffers[Symbol.iterator]();!(o=(l=f.next()).done);o=!0){l.value.isInitialized()||(t=!1)}}catch(t){u=!0,s=t}finally{try{!o&&f.return&&f.return()}finally{if(u)throw s}}var c=!0,h=!1,d=void 0;try{for(var p,v=this.textures[Symbol.iterator]();!(c=(p=v.next()).done);c=!0){p.value.isInitialized()||(t=!1)}}catch(t){h=!0,d=t}finally{try{!c&&v.return&&v.return()}finally{if(h)throw d}}return t}},{key:"_setCalls",value:function(t){var e=this,r=this.program,n=!0,i=!1,o=void 0;try{for(var u,s=this.geom.attributes[Symbol.iterator]();!(n=(u=s.next()).done);n=!0){var l=u.value,f=r.getAttribLocation(t,l);this.localCalls.push(l.bind.bind(l,t,f))}}catch(t){i=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}var c=!0,h=!1,d=void 0;try{for(var p,v=this.geom.buffers[Symbol.iterator]();!(c=(p=v.next()).done);c=!0){var y=p.value;this.localCalls.push(y.bind.bind(y,t))}}catch(t){h=!0,d=t}finally{try{!c&&v.return&&v.return()}finally{if(h)throw d}}var m=!0,b=!1,g=void 0;try{for(var _,w=this.uniforms[Symbol.iterator]();!(m=(_=w.next()).done);m=!0){var x=_.value,f=r.getUniformLocation(t,x);this.localCalls.push(x.bind.bind(x,t,f))}}catch(t){b=!0,g=t}finally{try{!m&&w.return&&w.return()}finally{if(b)throw g}}var M=!0,T=!1,k=void 0;try{for(var P,O=this.textures[Symbol.iterator]();!(M=(P=O.next()).done);M=!0){var E=P.value,D=r.getTextureLocationIndex(t,E),C=a(D,2),f=C[0],j=C[1];this.localCalls.push(E.bind.bind(E,t,f,j))}}catch(t){T=!0,k=t}finally{try{!M&&O.return&&O.return()}finally{if(T)throw k}}var I=!0,R=!1,F=void 0;try{for(var S,A=this.globalUniforms[Symbol.iterator]();!(I=(S=A.next()).done);I=!0){var U=S.value;!function(n){var a=r.getUniformLocation(t,n);e.globalCalls.push(function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]||n.updated)&&(n.bind.call(n,t,a),n.updated=!1)})}(U)}}catch(t){R=!0,F=t}finally{try{!I&&A.return&&A.return()}finally{if(R)throw F}}}},{key:"_initData",value:function(t){var e=(this.program,!0),r=!0,n=!1,a=void 0;try{for(var i,o=this.geom.attributes[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value;u.isInitialized()||u.init(t)||(e=!1)}}catch(t){n=!0,a=t}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}var s=!0,l=!1,f=void 0;try{for(var c,h=this.geom.buffers[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){var d=c.value;d.isInitialized()||d.init(t)||(e=!1)}}catch(t){l=!0,f=t}finally{try{!s&&h.return&&h.return()}finally{if(l)throw f}}var p=!0,v=!1,y=void 0;try{for(var m,b=this.textures[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var g=m.value;g.isInitialized()||g.init(t)||(e=!1)}}catch(t){v=!0,y=t}finally{try{!p&&b.return&&b.return()}finally{if(v)throw y}}return e}},{key:"dispose",value:function(){this._isInitialized=!1,this.localCalls.length=0}},{key:"init",value:function(t){var e=(this.program,!0);return this.program.isInitialized()?this.program.bind(t):this.program.init(t)||(e=!1),this._initData(t)||(e=!1),e&&this.localCalls.length<1&&this._setCalls(t),this._callOptimizer=u.default.getInstance(t),this._isInitialized=e,e}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST));var r=this.program;if(this._callOptimizer.optimizeProgram(r)){var n=!0,a=!1,i=void 0;try{for(var o,u=this.globalCalls[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){(0,o.value)(!1)}}catch(t){a=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}}else{this.program.bind(t);var s=!0,l=!1,f=void 0;try{for(var c,h=this.globalCalls[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){(0,c.value)(!0)}}catch(t){l=!0,f=t}finally{try{!s&&h.return&&h.return()}finally{if(l)throw f}}}var d=Object.keys(this.blending),p=!0,v=!1,y=void 0;try{for(var m,b=d[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var g=m.value;t.blendFunc(g,this.blending[g])}}catch(t){v=!0,y=t}finally{try{!p&&b.return&&b.return()}finally{if(v)throw y}}d.length>0&&t.enable(3042);var _=!0,w=!1,x=void 0;try{for(var M,T=this.localCalls[Symbol.iterator]();!(_=(M=T.next()).done);_=!0){(0,M.value)()}}catch(t){w=!0,x=t}finally{try{!_&&T.return&&T.return()}finally{if(w)throw x}}var k=!0,P=!1,O=void 0;try{for(var E,D=e[Symbol.iterator]();!(k=(E=D.next()).done);k=!0){(0,E.value)()}}catch(t){P=!0,O=t}finally{try{!k&&D.return&&D.return()}finally{if(P)throw O}}this.geom.display(t)}}]),t}();e.default=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(){n(this,t),this.pointer=null,this.gl=null,this.arrayType=34962,this.data=null,this.arrayUsage=35044}return a(t,[{key:"isInitialized",value:function(){return!!this.pointer}},{key:"setArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.arrayType,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.arrayUsage;this.arrayType=e,this.data=t,this.arrayUsage=r;var n=this.gl;n&&(n.bindBuffer(e,this.pointer),n.bufferData(e,t,arrayUsage))}},{key:"setItems",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5126,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;this.itemType=t,this.itemSize=e}},{key:"init",value:function(t){var e=t.createBuffer();return t.bindBuffer(this.arrayType,e),t.bufferData(this.arrayType,this.data,this.arrayUsage),this.pointer=e,this.gl=t,!0}},{key:"bind",value:function(t){t.bindBuffer(this.arrayType,this.pointer)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t;return e.setArray(this.data,this.arrayType,this.arrayUsage),e.setItems(this.itemType,this.itemSize),e}}]),t}();e.default=i},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){a=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(1),u=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(){n(this,t),this.meshes=[],this.depthTest=!0,this.sortCompare=function(t,e){return t.order!==e.order?t.order-e.order:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.textures&&e.textures&&t.textures.length>0&&t.textures.length>0?t.textures[0].id-e.textures[1].id:0},this._updateList=[]}return i(t,[{key:"addMesh",value:function(t){this.meshes.push(t)}},{key:"removeMesh",value:function(t){var e=this.meshes.indexOf(t);e>-1&&this.meshes.splice(e,1)}},{key:"sort",value:function(){this.meshes.sort(this.sortCompare)}},{key:"init",value:function(t){console.log(t),this._callOptimizer=u.default.getInstance(t)}},{key:"draw",value:function(t){for(;this._updateList.length>0;)this._updateList.pop()(t);this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT);var e=!0,r=!1,n=void 0;try{for(var a,i=this.meshes[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var o=a.value;o.visible&&(o.isInitialized()?o.draw(t):(o.init(t),o.draw(t)))}}catch(t){r=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(r)throw n}}}},{key:"bgColor",set:function(t){var e=a(t,4),r=e[0],n=e[1],i=e[2],o=e[3],u=void 0===o?1:o;this._updateList.push(function(t){return t.clearColor(r,n,i,u)}),this._bgColor=[r,n,i,u]},get:function(){return this._bgColor}}]),t}();e.default=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(16),o=function(t){return t&&t.__esModule?t:{default:t}}(i),u=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{antialias:!0,stencil:!0,alpha:!0,width:640,height:360};n(this,t),this.width=r.width,this.height=r.height,this.screenRecorder=new o.default(r.width,r.height,!0,!0),this.passEnabled=!0,this.scenes=[],this.passList=[],this.isEnable=!1,this._init(e,{antialias:r.antialias,stencil:r.stencil,alpha:r.alpha}),this._initScreenRecorder(this.gl)}return a(t,[{key:"_init",value:function(t,e){var r=void 0;try{r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)}catch(t){console.error("Could not initialise WebGL:",t.message)}r||console.error("Could not initialise WebGL"),this.gl=r,this.gl.viewport(0,0,this.width,this.height)}},{key:"_initScreenRecorder",value:function(t){if(this.screenRecorder.init(t),!this.screenRecorder.depthTexture){var e=!0,r=!1,n=void 0;try{for(var a,i=this.passList[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var o=a.value;this._disableDepthInTexture(o,t)}}catch(t){r=!0,n=t}finally{try{!e&&i.return&&i.return()}finally{if(r)throw n}}}}},{key:"isInitialized",value:function(){return this.screenRecorder.isInitialized()}},{key:"addScene",value:function(t){t.init(this.gl),this.scenes.push(t)}},{key:"resize",value:function(t,e){this.width=t,this.height=e,this.gl.viewport(0,0,this.width,this.height),this.screenRecorder.resize(t,e,this.gl);var r=!0,n=!1,a=void 0;try{for(var i,o=this.passList[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){i.value.resize(t,e)}}catch(t){n=!0,a=t}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}}},{key:"_disableDepthInTexture",value:function(t,e){t.inDepthTexture&&t.setDepthTexture(!1,e)}},{key:"addPass",value:function(t){t.init(this.gl,[]),this.screenRecorder.isInitialized()&&!this.screenRecorder.depthTexture&&this._disableDepthInTexture(t,this.gl),t.uWidth&&(t.uWidth.data=this.width),t.uHeight&&(t.uHeight.data=this.height),this.passList.push(t),this.isEnable=!0}},{key:"removePass",value:function(t){var e=this.passList.indexOf(t);e>-1&&this.passList.splice(e,1),this.isEnable=this.passList.length>0}},{key:"draw",value:function(){var t=this.gl,e=this.passList.length;if(this.passEnabled&&e>0&&this.scenes.length>0){this.screenRecorder.start(t,!0),this.scenes[0].draw(t),this.screenRecorder.stop(t),this.screenRecorder.pingpong();for(var r=0;r<e;r++){var n=this.passList[r];r>e-2||this.screenRecorder.start(t,!1),this.screenRecorder.pingpong(),n.inColorTexture&&n.inColorTexture.setTexture(this.screenRecorder.colorTexture),n.inDepthTexture&&this.screenRecorder.depthTexture&&n.inDepthTexture.setTexture(this.screenRecorder.depthTexture),n.draw(t),this.screenRecorder.stop(t)}}else this.scenes.length>0&&this.scenes[0].draw(t)}}]),t}();e.default=u},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){a=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(1),u=function(t){return t&&t.__esModule?t:{default:t}}(o),s=0,l=function(){function t(e){n(this,t),this.id=s++,this.label=e,this.mipmap=!0,this.img=null,this.width=null,this.height=null,this.pointer=null,this.parameters=[],this.setType(),this.setInternalFormat(),this.setFormat(),this.setTarget()}return i(t,[{key:"resize",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.width=t,this.height=e,r?(r.bindTexture(this.target,this.pointer),r.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img)):this.updated=!0}},{key:"setTempColor",value:function(t){this.setImg(new Uint8Array(t),1,1)}},{key:"setImg",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array([255,255,255,255]),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.img=t,this.width=e,this.height=r}},{key:"setType",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5121;this.type=t}},{key:"setInternalFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6408;this.internalFormat=t}},{key:"setFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6408;this.format=t}},{key:"setTarget",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3553;this.target=t}},{key:"setParam",value:function(t,e){var r=this.parameters.find(function(e){return e[0]===t});r>-1?this.parameters[r][1]=e:this.parameters.push([t,e])}},{key:"isInitialized",value:function(){return!!this.pointer}},{key:"setDefaultParams",value:function(t){this.mipmap?this.setParam(t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR):(this.setParam(t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),this.setParam(t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this.setParam(t.TEXTURE_MIN_FILTER,t.LINEAR))}},{key:"initParams",value:function(e){if(this.mipmap){var r=this.img;null===r?console.warn("You need an image to set the parameters of texture"):t.IS_POWER_OF_2(r.width)&&t.IS_POWER_OF_2(r.height)?e.generateMipmap(this.target):(this.mipmap=!1,console.warn("You need a power of 2 for the size of the mipmaped texture"))}this.parameters.length<1&&this.setDefaultParams(e);var n=!0,i=!1,o=void 0;try{for(var u,s=this.parameters[Symbol.iterator]();!(n=(u=s.next()).done);n=!0){var l=u.value,f=a(l,2),c=f[0],h=f[1];e.texParameteri(this.target,c,h)}}catch(t){i=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}}},{key:"init",value:function(e){var r=e.createTexture();return t._DATA_INITIALIZED||t.SET_DATA(e),e.bindTexture(this.target,r),e.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.initParams(e),this._callOptimizer=u.default.getInstance(e),this.pointer=r,!0}},{key:"bind",value:function(t,e,r){this._callOptimizer.optimizeTexture(this)||(t.uniform1i(e,r),t.activeTexture(t.TEXTURE0+r),t.bindTexture(this.target,this.pointer),this.updated&&(t.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.updated=!1))}},{key:"free",value:function(t){t.bindTexture(t.TEXTURE_2D,null)}}],[{key:"IS_POWER_OF_2",value:function(t){return 0==(t&t-1)}},{key:"SET_DATA",value:function(e){t.MAX_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE),t.FORMAT={};for(var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)t.FORMAT[r[n]]=!0;t._DATA_INITIALIZED=!0}}]),t}();e.default=l},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function t(e,r,n){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,r);if(void 0===a){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(n)},s=r(7),l=function(t){return t&&t.__esModule?t:{default:t}}(s),f=function(t){function e(t){n(this,e);var r=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.label=t,r}return i(e,t),o(e,[{key:"bind",value:function(t,r){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,t),t.vertexAttribPointer(r,this.itemSize,this.itemType,!1,0,0)}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e(this.label);return t.label=this.label,u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clone",this).call(this,t),t}}]),e}(l.default);e.default=f},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(5),l=n(s),f=r(0),c=n(f),h=function(t){function e(t){a(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,35676,l.default.create()));return r.updateNum=0,r.updated=!0,r.local=l.default.create(),r.parent=null,r}return o(e,t),u(e,[{key:"update",value:function(){var t=this.parent,e=null!==this.parent;if(this.updated||e&&this._parentUpdateNum!==t.updateNum){var r=this._data;e?(l.default.copy(t.global,r),l.default.multiply(r,this.local),this._parentUpdateNum=t.updateNum):l.default.copy(this.local,r),this.updateNum++,this.updated=!0}}},{key:"clear",value:function(){l.default.identity(this.local),this.updateNum++,this.updated=!0}},{key:"scale",value:function(t){l.default.scale(this.local,t),this.updateNum++,this.updated=!0}},{key:"translate",value:function(t){l.default.translate(this.local,t),this.updateNum++,this.updated=!0}},{key:"rotate",value:function(t,e){l.default.rotate(this.local,t,e),this.updateNum++,this.updated=!0}},{key:"rotateX",value:function(t){l.default.rotateX(this.local,t),this.updateNum++,this.updated=!0}},{key:"rotateY",value:function(t){l.default.rotateY(this.local,t),this.updateNum++,this.updated=!0}},{key:"rotateZ",value:function(t){l.default.rotateZ(this.local,t),this.updateNum++,this.updated=!0}},{key:"attach",value:function(t){this.parent=t,this._parentUpdateNum=t.updateNum,this.updateNum++,this.updated=!0}},{key:"detach",value:function(){this.parent=null,this.updateNum++,this.updated=!0}},{key:"global",get:function(){return this.update(),this._data}}]),e}(c.default);e.default=h},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(5),l=n(s),f=r(0),c=n(f),h=function(t){function e(){a(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"uPMatrix",35676,l.default.create()));t.fovy=45,t.near=.1,t.far=100;var r=l.default.create();return t._matrix=r,t.updated=!0,t.updateNum=0,t._ratio=0,t.clear=function(){l.default.identity(r),t.updated=!0},t.translate=function(e){l.default.translate(r,e),t.updated=!0},t.scale=function(e){l.default.scale(r,e),t.updated=!0},t.rotate=function(e,n){l.default.rotate(r,e,n),t.updated=!0},t.rotateX=function(e){l.default.rotateX(r,e),t.updated=!0},t.rotateY=function(e){l.default.rotateY(r,e),t.updated=!0},t.rotateZ=function(e){l.default.rotateZ(r,e),t.updated=!0},t.lookAt=function(e,n,a){l.default.lookAt(r,e,n,a),t.updated=!0},t}return o(e,t),u(e,[{key:"resize",value:function(t,e){this._ratio=t/e,this.updated=!0}},{key:"update",value:function(){l.default.perspective(this._data,this.fovy*Math.PI/180,this._ratio,this.near,this.far),l.default.multiply(this._data,this._matrix),this.updated=!1,this.updateNum++}},{key:"data",get:function(){return this.updated&&this.update(),this._data}},{key:"ratio",get:function(){return this._ratio},set:function(t){this._ratio=t,this.updated=!0}}]),e}(c.default);e.default=h},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(){n(this,t),this.pointer=null}return a(t,[{key:"isInitialized",value:function(){return!!this.pointer}},{key:"init",value:function(t){var e=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,e),this.pointer=e,!0}},{key:"bind",value:function(t){t.bindFramebuffer(t.FRAMEBUFFER,this.pointer)}},{key:"free",value:function(t){t.bindFramebuffer(t.FRAMEBUFFER,null)}}]),t}();e.default=i},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(e,r){n(this,t),this.pointer=null,this.width=e,this.height=r}return a(t,[{key:"resize",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.width=t,this.height=e,r?(r.bindRenderbuffer(r.RENDERBUFFER,this.pointer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,t,e)):this.updated=!0}},{key:"isInitialized",value:function(){return!!this.pointer}},{key:"init",value:function(t){var e=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,e),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),this.pointer=e}},{key:"bind",value:function(t){t.bindRenderbuffer(t.RENDERBUFFER,renderBuffer),this.updated&&(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),this.updated=!1)}}]),t}();e.default=i},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(10),u=n(o),s=r(15),l=n(s),f=r(14),c=n(f),h=function(){function t(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a(this,t),this.captureDepth=n,this.recordDepth=i,this.width=e,this.height=r,this.updated=!1,this._pingpong=!1,this._colorTextures=[this._genColorTexture("frameBufferColor0",e,r),this._genColorTexture("frameBufferColor1",e,r)],this.frameBuffer=new c.default}return i(t,[{key:"_genDepthTexture",value:function(t,e,r){var n=new u.default;return n.mipmap=!1,n.setInternalFormat(6402),n.setFormat(6402),n.setType(5123),n.setParam(10242,33071),n.setParam(10243,33071),n.setParam(10241,9728),n.setParam(10240,9728),n.setImg(null,e,r),n}},{key:"_genColorTexture",value:function(t,e,r){var n=new u.default(t);return n.mipmap=!1,n.setImg(null,e,r),n}},{key:"pingpong",value:function(){this._pingpong=!this._pingpong}},{key:"resize",value:function(t,e,r){this.width=t,this.height=e,this.pingpong(),this.colorTexture.resize(t,e,r),this.pingpong(),this.colorTexture.resize(t,e,r),this.depthTexture&&this.depthTexture.resize(t,e,r),this.renderBuffer&&this.renderBuffer.resize(t,e,r)}},{key:"isInitialized",value:function(){return!!this.frameBuffer.pointer}},{key:"init",value:function(e){return t._DATA_INITIALIZED||t.SET_DATA(e),this.recordDepth&&(t.WEBGL_depth_texture?(this.depthTexture=this._genDepthTexture("frameBufferDepth",this.width,this.height),this.depthTexture.init(e)):(console.warn("WEBGL_depth_texture Extension not available!"),this.recordDepth=!1)),this.captureDepth&&(this.renderBuffer=new l.default(this.width,this.height),this.renderBuffer.init(e)),this.frameBuffer.init(e),this.pingpong(),this.colorTexture.init(e),this.pingpong(),this.colorTexture.init(e),this.depthTexture?e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this.depthTexture.pointer,0):this.renderBuffer&&e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.renderBuffer.pointer),e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),!0}},{key:"start",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.frameBuffer.bind(t),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.colorTexture.pointer,0),this.depthTexture?t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,e?this.depthTexture.pointer:null,0):this.renderBuffer&&t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e?this.renderBuffer.pointer:null)}},{key:"stop",value:function(t){this.frameBuffer.free(t)}},{key:"colorTexture",get:function(){return this._colorTextures[this._pingpong?1:0]}}],[{key:"SET_DATA",value:function(e){t.WEBGL_depth_texture=e.getExtension("WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture"),t._DATA_INITIALIZED=!0}}]),t}();e.default=h},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function t(e,r,n){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,r);if(void 0===a){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(n)},s=r(10),l=function(t){return t&&t.__esModule?t:{default:t}}(s),f=function(t){function e(t){n(this,e);var r=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.srcs=[],r.setTempColor([255,255,255,255]),r}return i(e,t),o(e,[{key:"setTempColor",value:function(t){this.setImg(new Uint8Array(t),1,1)}},{key:"addURL",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={size:r,src:t,img:null,priority:0,isImage:!0,isValid:function(){return!0},init:null};n.init=function(t){t.bindTexture(t.TEXTURE_2D,e.pointer),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,6408,e.format,t.UNSIGNED_BYTE,n.img),e.img=n.img,e.initParams(t)},this.srcs.push(n)}},{key:"init",value:function(t,r){var n=u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t,r);this.pointer;return e.START_LOAD(t,this.srcs),n}}],[{key:"START_LOAD",value:function(t,r){if(r.length>0){r.sort(function(t,e){return t.size===e.size?t.size-e.size:t.priority-e.priority});r.filter(function(e){return e.size>=l.default.MAX_SIZE&&e.isValid(t)});if(r.length>1){var n=r[0],a=r[r.length-1];e.LOAD(n,function(){n.init(t),e.LOAD(a,function(){a.init(t)})})}else if(r.length>0){var i=r[0];e.LOAD(i,function(){i.init(t)})}else console.warn("The GPU can'nt load a texture with size > ",l.default.MAX_SIZE)}else console.warn("URL of your smart texture not found")}},{key:"LOAD",value:function(t,e){if(t.isImage){var r=new Image;r.onload=function(){e(t)},t.img=r,r.src=t.src}else{var n=new XMLHttpRequest;n.responseType="arraybuffer",n.open("GET",t.src,!0),n.onreadystatechange=function(r){n.readyState===XMLHttpRequest.DONE&&(200===n.status?(t.img=n.response,e(t)):console.error("fail to load image ",t.src,"status:",n.status,"statuc text:",n.statusText))},n.send()}}}]),e}(l.default);e.default=f},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(6),l=n(s),f=r(3),c=n(f),h=r(0),d=n(h),p=r(34),v=n(p),y=function(t){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"aVertexPosition";arguments.length>2&&void 0!==arguments[2]&&arguments[2];a(this,e);var n=new c.default,o=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];return n.addVertices(r,o,2),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,t))}return o(e,t),u(e,[{key:"resize",value:function(t,e){this.uWidth&&(this.uWidth.data=t),this.uHeight&&(this.uHeight.data=e)}},{key:"useUWidth",value:function(t,e){var r=new d.default(t,5124,e);this.uWidth=r,this.addUniform(r)}},{key:"useUHeight",value:function(t,e){var r=new d.default(t,5124,e);this.uHeight=r,this.addUniform(r)}},{key:"useColorTexture",value:function(t){var e=new v.default(t);this.inColorTexture=e,this.addTexture(e)}},{key:"useDepthTexture",value:function(t,e){var r=new v.default(t);this.inDepthTexture=r,this.addTexture(r);var n=new d.default(e,5124,1);this._inDetpthEnableUniform=n,this.addUniform(n)}},{key:"setDepthTexture",value:function(t,e){this.removeTexture(this.inDepthTexture),t&&this.addTexture(this.inDepthTexture),this._inDetpthEnableUniform.data=t?1:0;var r=this.globalUniforms;this.dispose(),this.init(e,r)}}]),e}(l.default);e.default=y},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,r,n,a,i,o,u,s,l){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=s,t[8]=l,t}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){a=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(){function t(){n(this,t),console.warn("Matrix3 is a static class")}return o(t,null,[{key:"create",value:function(){var t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}},{key:"fromMarix4",value:function(t){return a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(9),matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5],matrix[6],matrix[7],matrix[8])}},{key:"clone",value:function(e){return t.copy(e)}},{key:"copy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(9);return e.set(t),e}},{key:"identity",value:function(t){return a(t,1,0,0,0,1,0,0,0,1)}},{key:"add",value:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[3],t[4]+=e[4],t[5]+=e[5],t[6]+=e[6],t[7]+=e[7],t[8]+=e[8],t}},{key:"subtract",value:function(t,e){return t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t[3]-=e[3],t[4]-=e[4],t[5]-=e[5],t[6]-=e[6],t[7]-=e[7],t[8]-=e[8],t}},{key:"multiplyScalar",value:function(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,t}},{key:"multiplyScalarAndAdd",value:function(t,e,r){return t[0]+=e[0]*r,t[1]+=e[1]*r,t[2]+=e[2]*r,t[3]+=e[3]*r,t[4]+=e[4]*r,t[5]+=e[5]*r,t[6]+=e[6]*r,t[7]+=e[7]*r,t[8]+=e[8]*r,t}},{key:"exactEquals",value:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}},{key:"equals",value:function(t,e){var r=i(t,9),n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],l=r[5],f=r[6],c=r[7],h=r[8],d=i(e,9),p=d[0],v=d[1],y=d[2],m=d[3],b=d[4],g=d[5],_=d[6],w=d[7],x=d[8];return Math.abs(n-p)<=1e-6*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(a-v)<=1e-6*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(o-y)<=1e-6*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(u-m)<=1e-6*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(s-b)<=1e-6*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(l-g)<=1e-6*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(f-_)<=1e-6*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(c-w)<=1e-6*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(h-x)<=1e-6*Math.max(1,Math.abs(h),Math.abs(x))}},{key:"transpose",value:function(t,e){if(e===t){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else a(t,e[0],e[4],e[6],e[1],e[4],e[5],e[2],e[7],e[8]);return t}},{key:"invert",value:function(t){var e=i(t,9),r=e[0],n=e[1],o=e[2],u=e[3],s=e[4],l=e[5],f=e[6],c=e[7],h=e[8],d=l*f-h*u,p=f*s-c*u,v=r*b01+n*d+o*p;return v?(v=1/v,a(t,b01*v,(-h*n+o*c)*v,(l*n-o*s)*v,d*v,(h*r-o*f)*v,(-l*r+o*u)*v,p*v,(-c*r+n*f)*v,(s*r-n*u)*v)):t}},{key:"adjoint",value:function(t){var e=i(t,9),r=e[0],n=e[1],o=e[2],u=e[3],s=e[4],l=e[5],f=e[6],c=e[7],h=e[8];return a(t,s*h-l*c,o*c-n*h,n*l-o*s,l*f-u*h,r*h-o*f,o*u-r*l,u*c-s*f,n*f-r*c,r*s-n*u),t}},{key:"determinant",value:function(t){var e=i(t,9),r=e[0],n=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=e[6],f=e[7],c=e[8];return r*(c*u-s*f)+n*(-c*o+s*l)+a*(f*o-u*l)}},{key:"multiply",value:function(t,e){var r=i(t,9),n=r[0],o=r[1],u=r[2],s=r[3],l=r[4],f=r[5],c=r[6],h=r[7],d=r[8],p=i(e,9),v=p[0],y=p[1],m=p[2],b=p[3],g=p[4],_=p[5],w=p[6],x=p[7],M=p[8];return a(t,v*n+y*s+m*c,v*o+y*l+m*h,v*u+y*f+m*d,b*n+g*s+_*c,b*o+g*l+_*h,b*u+g*f+_*d,w*n+x*s+M*c,w*o+x*l+M*h,w*u+x*f+M*d)}},{key:"translate",value:function(t,e){var r=i(e,2),n=r[0],a=r[1],o=i(t,9),u=o[0],s=o[1],l=o[2],f=o[3],c=o[4],h=o[5],d=o[6],p=o[7],v=o[8];return t[6]=n*u+a*f+d,t[7]=n*s+a*c+p,t[8]=n*l+a*h+v,t}},{key:"rotate",value:function(t,e){var r=i(t,9),n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],l=r[5],f=(r[6],r[7],r[8],Math.sin(e)),c=Math.cos(e);return t[0]=c*n+80*u,t[1]=c*a+f*s,t[2]=c*o+f*l,t[3]=c*u-f*n,t[4]=c*s-f*a,t[5]=c*l-f*o,t}},{key:"scale",value:function(t,e){var r=i(e,2),n=r[0],a=r[1];return t[0]*=n,t[1]*=n,t[2]*=n,t[3]*=a,t[4]*=a,t[5]*=a,t}},{key:"fromTranslation",value:function(t){var e=i(t,2),r=e[0],n=e[1];return a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(9),1,0,0,0,1,0,r,n,1)}},{key:"fromScaling",value:function(t){var e=i(t,2),r=e[0],n=e[1];return a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(9),r,0,0,0,n,0,0,0,1)}},{key:"fromMatrix2",value:function(t){return a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(9),matrix2[0],matrix2[1],0,matrix2[2],matrix2[3],0,matrix2[4],matrix2[5],1)}},{key:"fromQuat",value:function(t){var e=i(t,4),r=e[0],n=e[1],o=e[2],u=e[3],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(9),l=r+r,f=n+n,c=o+o,h=r*l,d=n*l,p=n*f,v=o*l,y=o*f,m=o*c,b=u*l,g=u*f,_=u*c;return a(s,1-p-m,d-_,v+g,d+_,1-h-m,y-b,v-g,y+b,1-h-p)}},{key:"normalFromMatrix4",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(9),r=i(t,16),n=r[0],o=r[1],u=r[2],s=r[3],l=r[4],f=r[5],c=r[6],h=r[7],d=r[8],p=r[9],v=r[10],y=r[11],m=r[12],b=r[13],g=r[14],_=r[15],w=n*f-o*l,x=n*c-u*l,M=n*h-s*l,T=o*c-u*f,k=o*h-s*f,P=u*h-s*c,O=d*b-p*m,E=d*g-v*m,D=d*_-y*m,C=p*g-v*b,j=p*_-y*b,I=v*_-y*g,R=w*I-x*j+M*C+T*D-k*E+P*O;if(!R)return e;R=1/R,a(e,(f*I-c*j+h*C)*R,(c*D-l*I-h*E)*R,(l*j-f*D+h*O)*R,(u*j-o*I-s*C)*R,(n*I-u*D+s*E)*R,(o*D-n*j-s*O)*R,(b*P-g*k+_*T)*R,(g*M-m*P-_*x)*R,(m*k-b*M+_*w)*R)}},{key:"frob",value:function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}}]),t}();e.default=u},,,function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=r(4),u=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(t){function e(t,r){n(this,e);var i=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.depthTest=!1,i.order=-1,i}return i(e,t),e}(u.default);e.default=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(1),o=function(t){return t&&t.__esModule?t:{default:t}}(i),u=function(){function t(){n(this,t),this.meshs=[],this.order=0,this.visible=!0,this.mask=null,this._isInitialized=!1,this.sortCompare=function(t,e){return t.order!==e.order?t.order-e.order:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.textures&&e.textures&&t.textures.length>0&&t.textures.length>0?t.textures[0].id-e.textures[1].id:0}}return a(t,[{key:"setMask",value:function(t){this.mask=t}},{key:"addMesh",value:function(t){this.meshs.push(t)}},{key:"removeMesh",value:function(t){var e=this.meshs.indexOf(t);e>-1&&this.meshs.splice(e,1)}},{key:"sort",value:function(){this.meshs.sort(this.sortCompare)}},{key:"isInitialized",value:function(){if(null!==this.mask&&!this.mask.isInitialized())return!1;var t=!0,e=!1,r=void 0;try{for(var n,a=this.meshs[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){if(!n.value.isInitialized())return!1}}catch(t){e=!0,r=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw r}}return!0}},{key:"dispose",value:function(){var t=!0,e=!1,r=void 0;try{for(var n,a=this.meshs[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){n.value.dispose()}}catch(t){e=!0,r=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw r}}return!0}},{key:"init",value:function(t){var e=!0;null!==this.mask&&this.mask.init(t);var r=!0,n=!1,a=void 0;try{for(var i,u=this.meshs[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){i.value.init(t)||(e=!1)}}catch(t){n=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(n)throw a}}return this._callOptimizer=o.default.getInstance(t),e}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.mask&&this.mask.before(t);var r=!0,n=!1,a=void 0;try{for(var i,o=this.meshs[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){i.value.draw(t,e)}}catch(t){n=!0,a=t}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}this.mask&&this.mask.after(t)}}]),t}();e.default=u},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(1),o=function(t){return t&&t.__esModule?t:{default:t}}(i),u=function(){function t(e){n(this,t),this.mesh=e,this.setMaskFunc(519,1,255),this.setDisplayFunc(517,0,255)}return a(t,[{key:"setMaskFunc",value:function(t,e,r){this.maskFunc=t,this.maskRef=e,this.maskMask=r}},{key:"setDisplayFunc",value:function(t,e,r){this.displayFunc=t,this.displayRef=e,this.displayMask=r}},{key:"isInitialized",value:function(){return this.mesh.isInitialized()}},{key:"init",value:function(t){this.mesh.init(t),this._callOptimizer=o.default.getInstance(t)}},{key:"before",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.enable(2960),t.depthMask(!1),t.clear(1024),t.colorMask(!1,!1,!1,!1),t.stencilOp(7680,7680,7682),t.stencilFunc(this.maskFunc,this.maskRef,this.maskMask),this.mesh.draw(t,e),this._callOptimizer.optimizeProgram(null),t.stencilFunc(this.displayFunc,this.displayRef,this.displayMask),t.depthMask(!0),t.colorMask(!0,!0,!0,!0),t.stencilOp(7680,7680,7680)}},{key:"after",value:function(t){t.disable(2960)}}]),t}();e.default=u},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function t(e,r,n){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,r);if(void 0===a){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(n)},l=r(6),f=n(l),c=r(35),h=n(c),d=function(t){function e(t,r){a(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));n.depthTest=!1;var o=new h.default("uMVMatrix");return n.transform=o,n.addUniform(o),n}return o(e,t),u(e,[{key:"draw",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.transform&&this.transform.update(),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,r)}},{key:"position",get:function(){return this.transform.getTranslation()}},{key:"rotation",get:function(){return this.transform.getRotation()}}]),e}(f.default);e.default=d},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(5),l=n(s),f=r(0),c=n(f),h=new Float32Array(3),d=function(t){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;a(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,35676,l.default.create()));return o.camera3D=r,o.updateNum=-1,o.distance=n,o}return o(e,t),u(e,[{key:"update",value:function(){var t=this.camera3D,e=t._matrix;l.default.getTranslation(e,h),h[0]=-h[0]*this.distance,h[1]=-h[1]*this.distance,h[2]=-h[2]*this.distance,l.default.perspective(this._data,t.fovy*Math.PI/180,t.ratio,t.near,t.far),l.default.translate(this._data,h),l.default.multiply(this._data,e),this.updateNum=this.camera3D.updateNum}},{key:"data",get:function(){return this.updateNum!==this.camera3D.updateNum&&this.update(),this._data}}]),e}(c.default);e.default=d},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(19),l=n(s),f=r(0),c=n(f),h=function(t){function e(){a(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"uPMatrix",35675,l.default.create()));return t._matrix=l.default.create(),t.updated=!0,t.updateNum=0,t._minX=-1,t._maxX=1,t._minY=-1,t._maxY=1,t.clear=function(){matrix.identity(),t.updated=!0},t.translate=function(e){matrix.translate(e),t.updated=!0},t.scale=function(e){matrix.scale(e),t.updated=!0},t.rotate=function(e){matrix.rotate(e),t.updated=!0},t}return o(e,t),u(e,[{key:"setArea",value:function(t,e,r,n){this._minX=t,this._minY=e,this._maxX=r,this._maxY=n,this.updated=!0}},{key:"update",value:function(){l.default.identity(this._data);var t=this._maxX-this._minX,e=this._maxY-this._minY;l.default.scale(this._data,[1/t,1/e]),l.default.multiply(this._data,this._matrix),this.updated=!1,this.updateNum++}},{key:"data",get:function(){return this.updated&&this.update(),this._data}}]),e}(c.default);e.default=h},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){return Number.isInteger(t)?t.toFixed(1):t}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=r(18),f=n(l),c=r(2),h=n(c),d=r(0),p=n(d),v="\n    attribute vec3 aVertexPosition;\n    varying vec2 vTextureCoord;\n\n    void main(void)\n    {\n        vTextureCoord = vec2(aVertexPosition.x * 0.5 + 0.5, aVertexPosition.y * 0.5 + 0.5);\n        gl_Position = vec4(aVertexPosition, 1.0);\n    }",y="\n    precision mediump float;\n    varying vec2 vTextureCoord;\n    uniform sampler2D uColor;\n    uniform sampler2D uDepth;\n\n    uniform vec3 uColorFog;\n    \n    uniform int uDepthEnable;\n\n    void main(void)\n    {\n        $chunkcall\n        gl_FragColor = color;\n    }",m=function(t){function e(t){var r=t.minDepth,n=void 0===r?.1:r,o=t.maxDepth,u=void 0===o?.2:o,s=t.minPower,l=void 0===s?.2:s,f=t.maxPower,c=void 0===f?1:f,d=t.depthCurve,y=void 0===d?100:d,m=t.color,b=void 0===m?[1,1,1]:m;a(this,e);var g=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,null,"aVertexPosition","uColor"));g.useColorTexture("uColor"),g.useDepthTexture("uDepth","uDepthEnable");var _=new p.default("uColorFog",35665,b);g.addUniform(_);var w=g._initFragmentShader(n,u,l,c,y);return g.program=new h.default(v,w),g}return o(e,t),s(e,[{key:"_initFragmentShader",value:function(t,e,r,n,a){var i="\n            float depthValue = 0.0;\n            if (uDepthEnable >= 0) {\n                vec4 depth = texture2D(uDepth, vTextureCoord.xy);\n                depthValue = pow(depth.x, "+u(a)+");\n                depthValue = (depthValue - "+u(t)+") / "+u(e-t)+";\n                depthValue = clamp(depthValue, "+u(r)+", "+u(n)+");\n            }\n            vec4 originalColor = texture2D(uColor, vTextureCoord.xy); \n            vec4 color = vec4(mix(originalColor.xyz, uColorFog, depthValue), originalColor.w);\n        ";return y.replace("$chunkcall",i)}}]),e}(f.default);e.default=m},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){return Number.isInteger(t)?t.toFixed(1):t}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=r(18),f=n(l),c=r(2),h=n(c),d=r(0),p=(n(d),"\n    attribute vec3 aVertexPosition;\n    varying vec2 vTextureCoord;\n\n    void main(void)\n    {\n        vTextureCoord = vec2(aVertexPosition.x * 0.5 + 0.5, aVertexPosition.y * 0.5 + 0.5);\n        gl_Position = vec4(aVertexPosition, 1.0);\n    }"),v="\n    precision mediump float;\n    varying vec2 vTextureCoord;\n    uniform sampler2D uColor;\n    uniform sampler2D uDepth;\n    uniform int uSize;\n    uniform int uDepthEnable;\n\n    $chunkfct\n\n    void main(void)\n    {\n        $chunkcall\n        gl_FragColor = color;\n    }",y=function(t){function e(t){var r=t.minDepth,n=void 0===r?.1:r,o=t.maxDepth,u=void 0===o?.2:o,s=t.samples,l=void 0===s?5:s,f=t.xBlur,c=void 0===f||f,d=t.power,v=void 0===d?1:d,y=t.depthCurve,m=void 0===y?100:y;a(this,e);var b=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,null,"aVertexPosition","uColor"));b.power=v,b.xBlur=c,b.depthCurve=m,b.useColorTexture("uColor"),b.useDepthTexture("uDepth","uDepthEnable");var g=b._initFragmentShader(n,u,l);return b.program=new h.default(p,g),c?b.useUWidth("uSize",1):b.useUHeight("uSize",1),b}return o(e,t),s(e,[{key:"_initFragmentShader",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=this.xBlur,a=u(this.power),i=[],o=0;o<r;o++){var s=this._getKernels(o+1);i.push(s)}for(var l="",f=0;f<i.length;f++){var c=i[f];l+="\n            vec4 blur"+(f+1)+"(sampler2D i, vec2 uv) {\n                vec2 m;\n                vec4 color = texture2D(i, uv) * "+u(c[0])+";";for(var h=1;h<c.length;h++)l+="\n                m = "+(n?"vec2("+h+".0 * "+a+" / float(uSize), 0.0)":"vec2(0.0, "+h+".0 * "+a+" / float(uSize))")+";\n                color += texture2D(i, uv + m) * "+u(c[h])+";\n                color += texture2D(i, uv - m) * "+u(c[h])+";";l+="return color; }"}for(var d="\n            float depthValue = 0.0;\n            vec4 color;\n            if (uDepthEnable >= 0) {\n                vec4 depth = texture2D(uDepth, vTextureCoord.xy);\n                depthValue = pow(depth.x, "+u(this.depthCurve)+");\n                \n                int blurPower = int(floor(0.5 + (depthValue - "+u(t)+") * "+u(r)+" / "+u(e-t)+"));   \n        ",p=0;p<r;p++){var y="blurPower"+(p>r-2?" >= "+p:p<1?" < 1":" == "+p);d+=(p>0?" else if":"if")+" ( "+y+") {\n                color = blur"+(p+1)+"(uColor, vTextureCoord.xy);\n            }"}return d+="\n        } else {\n            color = texture2D(uColor, vTextureCoord.xy);\n        }\n        ",v.replace("$chunkfct",l).replace("$chunkcall",d)}},{key:"_getKernels",value:function(t){for(var e=[],r=0,n=1;n<t+2;n++){var a=3*(n-1)/t,i=Math.exp(-a*a);r+=n<2?i:i+i,e.push(i)}for(var o=0;o<e.length;o++)e[o]/=r;return e}}]),e}(f.default);e.default=y},,function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=0;t&&(t.wheelDelta?e=t.wheelDelta:t.detail?e=-40*t.detail:t.deltaY&&(e=-40*t.deltaY)),Rt-=e/1e3,Rt=Math.min(Math.max(Rt,.37),3),W.fovy=45*Rt}function i(t){var e=document.body;St[0]=t.clientX,St[1]=t.clientY,e.removeEventListener("mousemove",o),e.removeEventListener("mouseup",u),e.removeEventListener("mouseleave",u),e.addEventListener("mousemove",o),e.addEventListener("mouseup",u),e.addEventListener("mouseleave",u),e.classList.add("is-grabbing")}function o(t){var e=t.clientX,r=t.clientY,n=(e-St[0])/Ft[0],a=(r-St[1])/Ft[1];St[0]=e,St[1]=r,jt+=n*Math.PI*2,It+=a*Math.PI,It=Math.max(Math.min(It,.3*Math.PI),.3*-Math.PI)}function u(t){var e=document.body;e.removeEventListener("mousemove",o),e.removeEventListener("mouseup",u),e.removeEventListener("mouseleave",u),e.classList.remove("is-grabbing")}function s(){Ft[0]=window.innerWidth,Ft[1]=window.innerHeight,Pt.resize(1*Ft[0],1*Ft[1]),G.width=1*Ft[0],G.height=1*Ft[1],W.resize.apply(W,Ft),Y.setArea.apply(Y,[0,0].concat(Ft))}function l(){W.clear(),W.translate([0,0,-Rt]),W.rotate(It,[1,0,0]),W.rotate(jt,[0,1,0]),et.transform.rotateY(.005),vt.transform.rotate(-.005,[0,1,0]),pt.transform.rotate(.01,[0,1,0]),wt.transform.rotate(-.01,[0,1,0]),xt.transform.rotate(.025,[.72,-.33,.5]),Pt.draw(),requestAnimationFrame(l)}var f=r(0),c=(n(f),r(12)),h=(n(c),r(26)),d=n(h),p=r(11),v=(n(p),r(2)),y=n(v),m=r(3),b=n(m),g=r(17),_=n(g),w=r(6),x=(n(w),r(25)),M=n(x),T=r(4),k=n(T),P=r(23),O=n(P),E=r(24),D=n(E),C=r(22),j=n(C),I=r(27),R=n(I),F=r(13),S=n(F),A=r(8),U=n(A),L=r(18),z=(n(L),r(9)),N=n(z),V=r(29),B=n(V),X=r(28),H=n(X),G=document.body.querySelector("canvas"),W=new S.default,Y=new R.default,q=new U.default;q.bgColor=[0,0,.1,1],q.depthTest=!0;var Z="\n    precision mediump float;\n\n    varying vec4 vColor;\n\n    void main(void) {\n        gl_FragColor = vColor;\n    }\n",Q=new y.default("      \n    attribute vec3 aVertexPosition;\n    attribute vec4 aVertexColor;\n\n    uniform mat4 uMVMatrix;\n    uniform mat4 uPMatrix;\n\n    varying vec4 vColor;\n\n    void main(void) {\n        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n        vColor = aVertexColor;\n    }\n",Z),$=new y.default("\n    attribute vec3 aVertexPosition;\n    attribute vec4 aVertexColor;\n\n    uniform mat4 uMVMatrix;\n    uniform mat4 uPMatrix;\n\n    varying vec4 vColor;\n\n    void main(void) {\n        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n        float zDepth = 0.2 * (8.0 - gl_Position.z);\n        vec4 modifyColor = vec4(aVertexColor.rgb * zDepth, aVertexColor.a);\n        vColor = modifyColor;\n    }\n",Z),K=[0,1,0,-1,-1,1,1,-1,1,0,1,0,1,-1,1,1,-1,-1,0,1,0,1,-1,-1,-1,-1,-1,0,1,0,-1,-1,-1,-1,-1,1],J=[1,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,1,1,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,1],tt=new b.default;tt.addVertices("aVertexPosition",K,3),tt.addVertices("aVertexColor",J,4);var et=new k.default(tt,Q);et.transform.translate([-1.5,-1.5,0]),et.addGlobalUniform(W);var rt=new y.default("      \n    attribute vec2 aVertexPosition;\n\n    uniform mat3 uMVMatrix;\n    uniform mat3 uPMatrix;\n\n    varying vec2 vTextureCoord;\n\n    void main(void) {\n        vec3 pos = uPMatrix * uMVMatrix * vec3(aVertexPosition, 0.0);\n        gl_Position = vec4(pos.xy, 0.0, 1.0);\n    }\n","\n    precision mediump float;\n\n    uniform sampler2D uDiffuse1;\n\n    void main(void) {\n        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    }\n"),nt=[-1,-1,-1,1,1,-1,-1,1,1,1,1,-1],at=new b.default;at.addVertices("aVertexPosition",nt,2);var it=new M.default(at,rt);it.order=1,it.transform.scale([320,320]),it.addGlobalUniform(Y);var ot=new O.default;ot.addMesh(et),q.addMesh(ot),ot.setMask(new D.default(it));var ut=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],st=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],lt=[[1,0,0,1],[1,1,0,1],[0,1,0,1],[1,.5,.5,1],[1,0,1,1],[0,0,1,1]],ft=[];for(var ct in lt)for(var ht=0;ht<4;ht++)ft=ft.concat(lt[ct]);var dt=new b.default;dt.addVertices("aVertexPosition",ut,3),dt.addVertices("aVertexColor",ft,4),dt.addIndices(st);var pt=new k.default(dt,$);pt.transform.translate([1.5,-1.5,0]),pt.addGlobalUniform(W),q.addMesh(pt);var vt=new k.default(tt,Q);vt.transform.translate([-1.5,1.5,0]),vt.transform.scale([1,-1,1]),vt.addGlobalUniform(W),q.addMesh(vt);var yt=new y.default("   \n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    uniform mat4 uMVMatrix;\n    uniform mat4 uPMatrix;\n\n    varying vec2 vTextureCoord;\n\n    void main(void) {\n        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n        vTextureCoord = aTextureCoord;\n    }","\n    precision mediump float;\n\n    varying vec2 vTextureCoord;\n\n    uniform sampler2D uDiffuse1;\n    uniform sampler2D uDiffuse2;\n\n    void main(void) {\n        vec4 color1 = texture2D(uDiffuse1, vec2(vTextureCoord.s, vTextureCoord.t));\n        vec4 color2 = texture2D(uDiffuse2, vec2(vTextureCoord.s, vTextureCoord.t));\n        float power = ((sin(vTextureCoord.s * 3.1415)) * (sin(vTextureCoord.t * 3.1415)));\n        gl_FragColor = mix(color1, color2, power);\n    }"),mt=[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1],bt=new _.default("uDiffuse1");bt.addURL("assets/cube-diffuse.jpg");var gt=new _.default("uDiffuse2");gt.setParam(10240,9728),gt.setParam(10241,9728),gt.addURL("assets/cube-diffuse-2.png");var _t=new b.default;_t.addVertices("aVertexPosition",ut,3),_t.addVertices("aTextureCoord",mt,2),_t.addIndices(st);var wt=new k.default(_t,yt);wt.addTexture(bt),wt.addTexture(gt),wt.transform.translate([1.5,1.5,0]),wt.addGlobalUniform(W),q.addMesh(wt);var xt=new k.default(_t,yt);xt.addTexture(bt),xt.addTexture(gt),xt.transform.translate([0,0,-8]),xt.addGlobalUniform(W),q.addMesh(xt);var Mt=new d.default("uPMatrix",W,1),Tt=new y.default("   \n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    uniform mat4 uMVMatrix;\n    uniform mat4 uPMatrix;\n\n    varying vec2 vTextureCoord;\n\n    void main(void) {\n\n        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n        vTextureCoord = aTextureCoord;\n    }","\n    precision mediump float;\n\n    varying vec2 vTextureCoord;\n\n    uniform sampler2D uDiffuse1;\n\n    void main(void) {\n        vec4 color1 = texture2D(uDiffuse1, vec2(vTextureCoord.s, vTextureCoord.t));\n        gl_FragColor = color1;\n    }"),kt=new j.default(_t,Tt);kt.addTexture(bt),kt.addUniform(Mt),q.addMesh(kt),q.sort();var Pt=new N.default(G);Pt.passEnabled=!0,Pt.addScene(q);var Ot=new H.default({minDepth:.5,maxDepth:.6,minPower:0,maxPower:.5,depthCurve:100,color:[.9,.95,1]});Pt.addPass(Ot);var Et={minDepth:.95,maxDepth:1,samples:20,xBlur:!0,power:1,depthCurve:1},Dt=new B.default(Et);Pt.addPass(Dt),Et.xBlur=!1;var Ct=new B.default(Et);Pt.addPass(Ct);var jt=0,It=0,Rt=2.5,Ft=[0,0],St=[0,0];document.body.addEventListener("mousedown",i),window.addEventListener("wheel",a),window.onresize=s,s(),a(),window.scene=q,window.render=Pt,l()},,,function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(e){n(this,t),this.label=e}return a(t,[{key:"isInitialized",value:function(){return!0}},{key:"init",value:function(t){return!0}},{key:"setTexture",value:function(t){this.pointer=t.pointer,this.target=t.target}},{key:"bind",value:function(t,e,r){t.uniform1i(e,r),t.activeTexture(t.TEXTURE0+r),t.bindTexture(this.target,this.pointer)}}]),t}();e.default=i},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(19),l=n(s),f=r(0),c=n(f),h=function(t){function e(t){a(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,35675,l.default.create()));return r.updateNum=0,r.updated=!0,r.local=l.default.create(),r.parent=null,r}return o(e,t),u(e,[{key:"update",value:function(){var t=this.parent,e=null!==this.parent;if(this.updated||e&&this._parentUpdateNum!==t.updateNum){var r=this._data;e?(l.default.copy(t.global,r),l.default.multiply(r,this.local),this._parentUpdateNum=t.updateNum):l.default.copy(this.local,r),this.updateNum++,this.updated=!0}}},{key:"clear",value:function(){l.default.identity(this.local),this.updateNum++,this.updated=!0}},{key:"scale",value:function(t){l.default.scale(this.local,t),this.updateNum++,this.updated=!0}},{key:"translate",value:function(t){l.default.translate(this.local,t),this.updateNum++,this.updated=!0}},{key:"rotate",value:function(t){l.default.rotate(this.local,t),this.updateNum++,this.updated=!0}},{key:"attach",value:function(t){this.parent=t,this._parentUpdateNum=t.updateNum,this.updateNum++,this.updated=!0}},{key:"detach",value:function(){this.parent=null,this.updateNum++,this.updated=!0}},{key:"global",get:function(){return this.update(),this._data}}]),e}(c.default);e.default=h}]);