var _Mathmin=Math.min,_NumberisInteger=Number.isInteger,_Mathpow=Math.pow,_MathPI=Math.PI,_Mathtan=Math.tan,_Mathcos=Math.cos,_Mathsin=Math.sin,_Mathsqrt=Math.sqrt,_Mathmax=Math.max,_Mathabs=Math.abs;(function(d){function n(o){if(u[o])return u[o].exports;var l=u[o]={i:o,l:!1,exports:{}};return d[o].call(l.exports,l,l.exports,n),l.l=!0,l.exports}var u={};return n.m=d,n.c=u,n.i=function(o){return o},n.d=function(o,l,m){n.o(o,l)||Object.defineProperty(o,l,{configurable:!1,enumerable:!0,get:m})},n.n=function(o){var l=o&&o.__esModule?function(){return o['default']}:function(){return o};return n.d(l,'a',l),l},n.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},n.p='',n(n.s=31)})([function(d,n){'use strict';class o{constructor(l,m,h,T=!1){this.label=l,this.type=m,this._data=h,this._init(m,T)}get data(){return this._data}set data(l){this._data=l}_init(l){switch(this.type){case 35675:{this.bind=(h,T)=>{h.uniformMatrix3fv(T,!1,this.data)};break}case 35676:{this.bind=(h,T)=>{h.uniformMatrix4fv(T,!1,this.data)};break}case 35665:{this.bind=(h,T)=>{h.uniform3f(T,...this.data)};break}case 5124:this.bind=(h,T)=>{h.uniform1i(T,this.data)};break;case-1:this.bind=(h,T)=>{h.uniform1fv(T,this.data)};break;default:console.error('Uniform type unknow: {label:',this.label,', type:',l,'}');}}}n.a=o},function(d,n){'use strict';class o{constructor(){this.lastTexture=null,this.lastProgram=null,this.lastDepthTest=!1}optimizeTexture(l){const m=this.lastTexture;return this.lastTexture=l,l===m}optimizeProgram(l){const m=this.lastProgram;return this.lastProgram=l,l===m}optimizeDepthTest(l){const m=this.lastDepthTest;return this.lastDepthTest=l,m===l}static getInstance(l){const m=o.glList.indexOf(l);if(0>m){const h=new o;return o.glList.push(l),o.list.push(h),h}return o.list[m]}}o.glList=[],o.list=[],n.a=o},function(d,n){'use strict';let o=0;n.a=class{constructor(m,h){this.vertexShaderSrc=m,this.fragmentShaderSrc=h,this.attribLocation={},this.uniformLocation={},this.textureLocation={},this.textureIndex={},this.textureNum=0,this.id=o++}isInitialized(){return!!this.pointer}init(m){this.vertexShader=this._createShader(m,35633,this.vertexShaderSrc),this.fragmentShader=this._createShader(m,35632,this.fragmentShaderSrc);const h=m.createProgram();return(m.attachShader(h,this.vertexShader),m.attachShader(h,this.fragmentShader),m.linkProgram(h),!m.getProgramParameter(h,m.LINK_STATUS))?(console.error('Shader initialization error'),!1):(m.useProgram(h),this.pointer=h,!0)}getAttribLocation(m,h){const T=h.label;if(!this.attribLocation.hasOwnProperty(T)){const E=m.getAttribLocation(this.pointer,T);return m.enableVertexAttribArray(E),this.attribLocation[T]=E,E}return this.attribLocation[T]}getUniformLocation(m,h){const T=h.label;if(!this.uniformLocation.hasOwnProperty(T)){const E=m.getUniformLocation(this.pointer,T);return this.uniformLocation[T]=E,E}return this.uniformLocation[T]}getTextureLocationIndex(m,h){const T=h.label;if(!this.textureLocation.hasOwnProperty(T)||!this.textureIndex.hasOwnProperty(T)){const E=m.getUniformLocation(this.pointer,T);return this.textureLocation[T]=E,this.textureIndex[T]=this.textureNum,[E,this.textureNum++]}return[this.textureLocation[T],this.textureIndex[T]]}bind(m){m.useProgram(this.pointer)}_createShader(m,h,T){const E=m.createShader(h);return m.shaderSource(E,T),m.compileShader(E),m.getShaderParameter(E,m.COMPILE_STATUS)?E:console.error('Une erreur est survenue au cours de la compilation du shader: '+m.getShaderInfoLog(E))}}},function(d,n,u){'use strict';var o=u(7),l=u(11);class m{constructor(){this.attributes=[],this.buffers=[],this.hasIndices=!1,this.numItems=0}addVertices(h,T,E){const _=new l.a(h);_.setArray(new Float32Array(T),34962),_.setItems(5126,E),this.attributes.push(_),1>this.numItems&&(this.numItems=T.length/E)}addIndices(h){this.hasIndices=!0;const T=new o.a;T.setArray(new Uint16Array(h),34963),T.setItems(5125,1),this.buffers.push(T),this.numItems=h.length}display(h){this.hasIndices?h.drawElements(h.TRIANGLES,this.numItems,h.UNSIGNED_SHORT,0):h.drawArrays(h.TRIANGLES,0,this.numItems)}clone(h=new m){return h.attributes=this.attributes.map((T)=>T.clone()),h.buffers=this.buffers.map((T)=>T.clone()),h.hasIndices=this.hasIndices,h.numItems=this.numItems,h}}n.a=m},function(d,n,u){'use strict';var o=u(6),l=u(12);class m extends o.a{constructor(h,T){super(h,T),this.depthTest=!0;const E=new l.a('uMVMatrix');this.transform=E,this.addUniform(E)}get position(){return this.transform.getTranslation()}get rotation(){return this.transform.getRotation()}draw(h,T=[]){this.transform&&this.transform.update(),super.draw(h,T)}}n.a=m},function(d,n){'use strict';function o(h,T,E,_,I,R,D,P,F,L,N,U,A,C,M,B,v){h[0]=T,h[1]=E,h[2]=_,h[3]=I,h[4]=R,h[5]=D,h[6]=P,h[7]=F,h[8]=L,h[9]=N,h[10]=U,h[11]=A,h[12]=C,h[13]=M,h[14]=B,h[15]=v}const l=1e-6;class m extends Float32Array{constructor(){super(16),this[0]=1,this[5]=1,this[10]=1,this[15]=1}clone(){const h=new m;return h.set(this),h}copy(h){return h.set(this),this}identity(){return o(this,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}add(h){return this[0]+=h[0],this[1]+=h[1],this[2]+=h[2],this[3]+=h[3],this[4]+=h[4],this[5]+=h[5],this[6]+=h[6],this[7]+=h[7],this[8]+=h[8],this[9]+=h[9],this[10]+=h[10],this[11]+=h[11],this[12]+=h[12],this[13]+=h[13],this[14]+=h[14],this[15]+=h[15],this}subtract(h){return this[0]-=h[0],this[1]-=h[1],this[2]-=h[2],this[3]-=h[3],this[4]-=h[4],this[5]-=h[5],this[6]-=h[6],this[7]-=h[7],this[8]-=h[8],this[9]-=h[9],this[10]-=h[10],this[11]-=h[11],this[12]-=h[12],this[13]-=h[13],this[14]-=h[14],this[15]-=h[15],this}multiplyScalar(h){return this[0]*=h,this[1]*=h,this[2]*=h,this[3]*=h,this[4]*=h,this[5]*=h,this[6]*=h,this[7]*=h,this[8]*=h,this[9]*=h,this[10]*=h,this[11]*=h,this[12]*=h,this[13]*=h,this[14]*=h,this[15]*=h,this}multiplyScalarAndAdd(h,T){return this[0]+=h[0]*T,this[1]+=h[1]*T,this[2]+=h[2]*T,this[3]+=h[3]*T,this[4]+=h[4]*T,this[5]+=h[5]*T,this[6]+=h[6]*T,this[7]+=h[7]*T,this[8]+=h[8]*T,this[9]+=h[9]*T,this[10]+=h[10]*T,this[11]+=h[11]*T,this[12]+=h[12]*T,this[13]+=h[13]*T,this[14]+=h[14]*T,this[15]+=h[15]*T,this}exactEquals(h){return this[0]===h[0]&&this[1]===h[1]&&this[2]===h[2]&&this[3]===h[3]&&this[4]===h[4]&&this[5]===h[5]&&this[6]===h[6]&&this[7]===h[7]&&this[8]===h[8]&&this[9]===h[9]&&this[10]===h[10]&&this[11]===h[11]&&this[12]===h[12]&&this[13]===h[13]&&this[14]===h[14]&&this[15]===h[15]}equals(h){const[T,E,_,I,R,D,P,F,L,N,U,A,C,M,B,v]=this,[O,k,X,H,G,V,W,Y,Z,q,K,$,J,Q,ee,te]=h;return _Mathabs(T-O)<=l*_Mathmax(1,_Mathabs(T),_Mathabs(O))&&_Mathabs(E-k)<=l*_Mathmax(1,_Mathabs(E),_Mathabs(k))&&_Mathabs(_-X)<=l*_Mathmax(1,_Mathabs(_),_Mathabs(X))&&_Mathabs(I-H)<=l*_Mathmax(1,_Mathabs(I),_Mathabs(H))&&_Mathabs(R-G)<=l*_Mathmax(1,_Mathabs(R),_Mathabs(G))&&_Mathabs(D-V)<=l*_Mathmax(1,_Mathabs(D),_Mathabs(V))&&_Mathabs(P-W)<=l*_Mathmax(1,_Mathabs(P),_Mathabs(W))&&_Mathabs(F-Y)<=l*_Mathmax(1,_Mathabs(F),_Mathabs(Y))&&_Mathabs(L-Z)<=l*_Mathmax(1,_Mathabs(L),_Mathabs(Z))&&_Mathabs(N-q)<=l*_Mathmax(1,_Mathabs(N),_Mathabs(q))&&_Mathabs(U-K)<=l*_Mathmax(1,_Mathabs(U),_Mathabs(K))&&_Mathabs(A-$)<=l*_Mathmax(1,_Mathabs(A),_Mathabs($))&&_Mathabs(C-J)<=l*_Mathmax(1,_Mathabs(C),_Mathabs(J))&&_Mathabs(M-Q)<=l*_Mathmax(1,_Mathabs(M),_Mathabs(Q))&&_Mathabs(B-ee)<=l*_Mathmax(1,_Mathabs(B),_Mathabs(ee))&&_Mathabs(v-te)<=l*_Mathmax(1,_Mathabs(v),_Mathabs(te))}transpose(h){if(h===this){const T=h[1],E=h[2],_=h[3],I=h[6],R=h[7],D=h[11];this[1]=h[4],this[2]=h[8],this[3]=h[12],this[4]=T,this[6]=h[9],this[7]=h[13],this[8]=E,this[9]=I,this[11]=h[14],this[12]=_,this[13]=R,this[14]=D}else o(this,h[0],h[4],h[8],h[12],h[1],h[5],h[9],h[13],h[2],h[6],h[10],h[14],h[3],h[7],h[11],h[15]);return this}invert(){const[h,T,E,_,I,R,D,P,F,L,N,U,A,C,M,B]=this,v=h*R-T*I,O=h*D-E*I,k=h*P-_*I,X=T*D-E*R,H=T*P-_*R,G=E*P-_*D,V=F*C-L*A,W=F*M-N*A,Y=F*B-U*A,Z=L*M-N*C,q=L*B-U*C,K=N*B-U*M;let $=v*K-O*q+k*Z+X*Y-H*W+G*V;return $?($=1/$,o(this,(R*K-D*q+P*Z)*$,(E*q-T*K-_*Z)*$,(C*G-M*H+B*X)*$,(N*H-L*G-U*X)*$,(D*Y-I*K-P*W)*$,(h*K-E*Y+_*W)*$,(M*k-A*G-B*O)*$,(F*G-N*k+U*O)*$,(I*q-R*Y+P*V)*$,(T*Y-h*q-_*V)*$,(A*H-C*k+B*v)*$,(L*k-F*H-U*v)*$,(R*W-I*Z-D*V)*$,(h*Z-T*W+E*V)*$,(C*O-A*X-M*v)*$,(F*X-L*O+N*v)*$),this):this}adjoint(){const[h,T,E,_,I,R,D,P,F,L,N,U,A,C,M,B]=this;return o(this,R*(N*B-U*M)-L*(D*B-P*M)+C*(D*U-P*N),-(T*(N*B-U*M)-L*(E*B-_*M)+C*(E*U-_*N)),T*(D*B-P*M)-R*(E*B-_*M)+C*(E*P-_*D),-(T*(D*U-P*N)-R*(E*U-_*N)+L*(E*P-_*D)),-(I*(N*B-U*M)-F*(D*B-P*M)+A*(D*U-P*N)),h*(N*B-U*M)-F*(E*B-_*M)+A*(E*U-_*N),-(h*(D*B-P*M)-I*(E*B-_*M)+A*(E*P-_*D)),h*(D*U-P*N)-I*(E*U-_*N)+F*(E*P-_*D),I*(L*B-U*C)-F*(R*B-P*C)+A*(R*U-P*L),-(h*(L*B-U*C)-F*(T*B-_*C)+A*(T*U-_*L)),h*(R*B-P*C)-I*(T*B-_*C)+A*(T*P-_*R),-(h*(R*U-P*L)-I*(T*U-_*L)+F*(T*P-_*R)),-(I*(L*M-N*C)-F*(R*M-D*C)+A*(R*N-D*L)),h*(L*M-N*C)-F*(T*M-E*C)+A*(T*N-E*L),-(h*(R*M-D*C)-I*(T*M-E*C)+A*(T*D-E*R)),h*(R*N-D*L)-I*(T*N-E*L)+F*(T*D-E*R)),this}determinant(){const[h,T,E,_,I,R,D,P,F,L,N,U,A,C,M,B]=this;return(h*R-T*I)*(N*B-U*M)-(h*D-E*I)*(L*B-U*C)+(h*P-_*I)*(L*M-N*C)+(T*D-E*R)*(F*B-U*A)-(T*P-_*R)*(F*M-N*A)+(E*P-_*D)*(F*C-L*A)}multiply(h){const[T,E,_,I,R,D,P,F,L,N,U,A,C,M,B,v]=this;let[O,k,X,H]=h;return this[0]=O*T+k*R+X*L+H*C,this[1]=O*E+k*D+X*N+H*M,this[2]=O*_+k*P+X*U+H*B,this[3]=O*I+k*F+X*A+H*v,O=h[4],k=h[5],X=h[6],H=h[7],this[4]=O*T+k*R+X*L+H*C,this[5]=O*E+k*D+X*N+H*M,this[6]=O*_+k*P+X*U+H*B,this[7]=O*I+k*F+X*A+H*v,O=h[8],k=h[9],X=h[10],H=h[11],this[8]=O*T+k*R+X*L+H*C,this[9]=O*E+k*D+X*N+H*M,this[10]=O*_+k*P+X*U+H*B,this[11]=O*I+k*F+X*A+H*v,O=h[12],k=h[13],X=h[14],H=h[15],this[12]=O*T+k*R+X*L+H*C,this[13]=O*E+k*D+X*N+H*M,this[14]=O*_+k*P+X*U+H*B,this[15]=O*I+k*F+X*A+H*v,this}translate([h,T,E]){return this[12]=this[0]*h+this[4]*T+this[8]*E+this[12],this[13]=this[1]*h+this[5]*T+this[9]*E+this[13],this[14]=this[2]*h+this[6]*T+this[10]*E+this[14],this[15]=this[3]*h+this[7]*T+this[11]*E+this[15],this}scale([h,T,E]){return this[0]*=h,this[1]*=h,this[2]*=h,this[3]*=h,this[4]*=T,this[5]*=T,this[6]*=T,this[7]*=T,this[8]*=E,this[9]*=E,this[10]*=E,this[11]*=E,this}rotate(h,[T,E,_]){let I=_Mathsqrt(T*T+E*E+_*_);if(_Mathabs(I)>l){I=1/I,T*=I,E*=I,_*=I;const R=_Mathsin(h),D=_Mathcos(h),P=1-D,[F,L,N,U,A,C,M,B,v,O,k,X]=this,H=T*T*P+D,G=E*T*P+_*R,V=_*T*P-E*R,W=T*E*P-_*R,Y=E*E*P+D,Z=_*E*P+T*R,q=T*_*P+E*R,K=E*_*P-T*R,$=_*_*P+D;this[0]=F*H+A*G+v*V,this[1]=L*H+C*G+O*V,this[2]=N*H+M*G+k*V,this[3]=U*H+B*G+X*V,this[4]=F*W+A*Y+v*Z,this[5]=L*W+C*Y+O*Z,this[6]=N*W+M*Y+k*Z,this[7]=U*W+B*Y+X*Z,this[8]=F*q+A*K+v*$,this[9]=L*q+C*K+O*$,this[10]=N*q+M*K+k*$,this[11]=U*q+B*K+X*$}return this}rotateX(h){const T=_Mathsin(h),E=_Mathcos(h),_=this[4],I=this[5],R=this[6],D=this[7],P=this[8],F=this[9],L=this[10],N=this[11];return this[4]=_*E+P*T,this[5]=I*E+F*T,this[6]=R*E+L*T,this[7]=D*E+N*T,this[8]=P*E-_*T,this[9]=F*E-I*T,this[10]=L*E-R*T,this[11]=N*E-D*T,this}rotateY(h){const T=_Mathsin(h),E=_Mathcos(h),[_,I,R,D]=this,P=this[8],F=this[9],L=this[10],N=this[11];return this[0]=_*E-P*T,this[1]=I*E-F*T,this[2]=R*E-L*T,this[3]=D*E-N*T,this[8]=_*T+P*E,this[9]=I*T+F*E,this[10]=R*T+L*E,this[11]=D*T+N*E,this}rotateZ(h){const T=_Mathsin(h),E=_Mathcos(h),[_,I,R,D,P,F,L,N]=this;return this[0]=_*E+P*T,this[1]=I*E+F*T,this[2]=R*E+L*T,this[3]=D*E+N*T,this[4]=P*E-_*T,this[5]=F*E-I*T,this[6]=L*E-R*T,this[7]=N*E-D*T,this}fromTranslation(h){return o(this,1,0,0,0,0,1,0,0,0,0,1,0,h[0],h[1],h[2],1),this}fromScaling(h){return o(this,h[0],0,0,0,0,h[1],0,0,0,0,h[2],0,0,0,0,1),this}fromRotation(h,[T,E,_]){let I=_Mathsqrt(T*T+E*E+_*_);if(_Mathabs(I)>l){I=1/I,T*=I,E*=I,_*=I;const R=_Mathsin(h),D=_Mathcos(h),P=1-D;o(this,T*T*P+D,E*T*P+_*R,_*T*P-E*R,0,T*E*P-_*R,E*E*P+D,_*E*P+T*R,0,T*_*P+E*R,E*_*P-T*R,_*_*P+D,0,0,0,0,1)}return this}fromXRotation(h){const T=_Mathsin(h),E=_Mathcos(h);return o(this,1,0,0,0,0,E,T,0,0,-T,E,0,0,0,0,1),this}fromYRotation(h){const T=_Mathsin(h),E=_Mathcos(h);return o(this,E,0,-T,0,0,1,0,0,T,0,E,0,0,0,0,1),this}fromZRotation(h){const T=_Mathsin(h),E=_Mathcos(h);return o(this,E,T,0,0,-T,E,0,0,0,0,1,0,0,0,0,1),this}fromQuat(h){const[T,E,_,I]=h,R=T+T,D=E+E,P=_+_,F=T*R,L=E*R,N=E*D,U=_*R,A=_*D,C=_*P,M=I*R,B=I*D,v=I*P;return o(this,1-N-C,L+v,U-B,0,L-v,1-F-C,A+M,0,U+B,A-M,1-F-N,0,0,0,0,1),this}fromRotationTranslation(h,T){const[E,_,I,R]=h,D=E+E,P=_+_,F=I+I,L=E*D,N=E*P,U=E*F,A=_*P,C=_*F,M=I*F,B=R*D,v=R*P,O=R*F;return o(this,1-(A+M),N+O,U-v,0,N-O,1-(L+M),C+B,0,U+v,C-B,1-(L+A),0,T[0],T[1],T[2],1),this}fromRotationTranslationScale(h,T,[E,_,I]){const[R,D,P,F]=h,L=R+R,N=D+D,U=P+P,A=R*L,C=R*N,M=R*U,B=D*N,v=D*U,O=P*U,k=F*L,X=F*N,H=F*U;return o(this,(1-(B+O))*E,(C+H)*E,(M-X)*E,0,(C-H)*_,(1-(A+O))*_,(v+k)*_,0,(M+X)*I,(v-k)*I,(1-(A+B))*I,0,T[0],T[1],T[2],1),this}fromRotationTranslationScaleOrigin(h,T,E,_){const[I,R,D,P]=h,F=I+I,L=R+R,N=D+D,U=I*F,A=I*L,C=I*N,M=R*L,B=R*N,v=D*N,O=P*F,k=P*L,X=P*N,[H,G,V]=E,[W,Y,Z]=_;return o(this,(1-(M+v))*H,(A+X)*H,(C-k)*H,0,(A-X)*G,(1-(U+v))*G,(B+O)*G,0,(C+k)*V,(B-O)*V,(1-(U+M))*V,0,T[0]+W-(this[0]*W+this[4]*Y+this[8]*Z),T[1]+Y-(this[1]*W+this[5]*Y+this[9]*Z),T[2]+Z-(this[2]*W+this[6]*Y+this[10]*Z),1),this}getTranslation(h=new Float32Array(3)){return h[0]=this[12],h[1]=this[13],h[2]=this[14],h}getRotation(h=new Float32Array(4)){var T=this[0]+this[5]+this[10];if(0<T){const E=2*_Mathsqrt(T+1);h[0]=(this[6]-this[9])/E,h[1]=(this[8]-this[2])/E,h[2]=(this[1]-this[4])/E,h[3]=0.25*E}else if(this[0]>this[5]&this[0]>this[10]){const E=2*_Mathsqrt(1+this[0]-this[5]-this[10]);h[0]=0.25*E,h[1]=(this[1]+this[4])/E,h[2]=(this[8]+this[2])/E,h[3]=(this[6]-this[9])/E}else if(this[5]>this[10]){const E=_Mathsqrt(1+this[5]-this[0]-this[10]);h[0]=2*((this[1]+this[4])/E),h[1]=0.25*E,h[2]=(this[6]+this[9])/E,h[3]=(this[8]-this[2])/E}else{const E=2*_Mathsqrt(1+this[10]-this[0]-this[5]);h[0]=(this[8]+this[2])/E,h[1]=(this[6]+this[9])/E,h[2]=0.25*E,h[3]=(this[1]-this[4])/E}return h}frustrum(h,T,E,_,I,R){const D=1/(T-h),P=1/(_-E),F=1/(I-R);return o(this,2*I*D,0,0,0,0,2*I*P,0,0,(T+h)*D,(_+E)*P,(R+I)*F,-1,0,0,2*(R*I)*F,0),this}perspective(h,T,E,_){const I=1/_Mathtan(h/2),R=1/(E-_);return o(this,I/T,0,0,0,0,I,0,0,0,0,(_+E)*R,-1,0,0,2*_*E*R,0),this}perspectiveFromFieldOfView(h,T,E){const _=_Mathtan(h.upDegrees*_MathPI/180),I=_Mathtan(h.downDegrees*_MathPI/180),R=_Mathtan(h.leftDegrees*_MathPI/180),D=_Mathtan(h.rightDegrees*_MathPI/180),P=2/(R+D),F=2/(_+I);return o(this,P,0,0,0,0,F,0,0,0.5*(-(R-D)*P),0.5*((_-I)*F),E/(T-E),-1,0,0,E*T/(T-E),0),this}ortho(h,T,E,_,I,R){const D=1/(h-T),P=1/(E-_),F=1/(I-R);return o(this,-2*D,0,0,0,0,-2*P,0,0,0,0,2*F,0,(h+T)*D,(_+E)*P,(R+I)*F,1),this}lookAt(h,T,E){const[_,I,R]=h,[D,P,F]=E,[L,N,U]=T;if(_Mathabs(_-L)<l&&_Mathabs(I-N)<l&&_Mathabs(R-U)<l)return this.identity();let A=_-L,C=I-N,M=R-U,B=1/_Mathsqrt(A*A+C*C+M*M);A*=B,C*=B,M*=B;let v=P*M-F*C,O=F*A-D*M,k=D*C-P*A;B=_Mathsqrt(v*v+O*O+k*k),B?(B=1/B,v*=B,O*=B,k*=B):(v=0,O=0,k=0);let X=C*k-M*O,H=M*v-A*k,G=A*O-C*v;return B=_Mathsqrt(X*X+H*H+G*G),B?(B=1/B,X*=B,H*=B,G*=B):(X=0,H=0,G=0),o(this,v,X,A,0,O,H,C,0,k,G,M,0,-(v*_+O*I+k*R),-(X*_+H*I+G*R),-(A*_+C*I+M*R),1),this}frob(){return _Mathsqrt(_Mathpow(this[0],2)+_Mathpow(this[1],2)+_Mathpow(this[2],2)+_Mathpow(this[3],2)+_Mathpow(this[4],2)+_Mathpow(this[5],2)+_Mathpow(this[6],2)+_Mathpow(this[7],2)+_Mathpow(this[8],2)+_Mathpow(this[9],2)+_Mathpow(this[10],2)+_Mathpow(this[11],2)+_Mathpow(this[12],2)+_Mathpow(this[13],2)+_Mathpow(this[14],2)+_Mathpow(this[15],2))}}n.a=m},function(d,n,u){'use strict';var o=u(1);n.a=class{constructor(m,h){this.geom=m,this.program=h,this.uniforms=[],this.globalUniforms=[],this.textures=[],this.localCalls=[],this.globalCalls=[],this.order=1,this.visible=!0,this.depthTest=!1,this._isInitialized=!1}addUniform(m){this.uniforms.push(m)}rmUniform(m){const h=this.uniforms.indexOf(m);-1<h&&this.uniforms.splice(h,1)}addGlobalUniform(m){this.globalUniforms.push(m)}rmGlobalUniform(m){const h=this.globalUniforms.indexOf(m);-1<h&&this.globalUniforms.splice(h,1)}addTexture(m){this.textures.push(m)}rmTexture(m){const h=this.textures.indexOf(m);-1<h&&this.textures.splice(h,1)}isInitialized(){let m=this._isInitialized;if(m)return m;this.program.isInitialized()||(m=!1);for(const h of this.geom.attributes)h.isInitialized()||(m=!1);for(const h of this.geom.buffers)h.isInitialized()||(m=!1);for(const h of this.textures)h.isInitialized()||(m=!1);return m}_setCalls(m){const h=this.program;for(const T of this.geom.attributes){const E=h.getAttribLocation(m,T);this.localCalls.push(T.bind.bind(T,m,E))}for(const T of this.geom.buffers)this.localCalls.push(T.bind.bind(T,m));for(const T of this.uniforms){const E=h.getUniformLocation(m,T);this.localCalls.push(T.bind.bind(T,m,E))}for(const T of this.textures){const[E,_]=h.getTextureLocationIndex(m,T);this.localCalls.push(T.bind.bind(T,m,E,_))}for(const T of this.globalUniforms){const E=h.getUniformLocation(m,T);this.globalCalls.push(T.bind.bind(T,m,E))}}_initData(m){this.program;let T=!0;for(const E of this.geom.attributes)E.isInitialized()||E.init(m)||(T=!1);for(const E of this.geom.buffers)E.isInitialized()||E.init(m)||(T=!1);for(const E of this.textures)E.isInitialized()||E.init(m)||(T=!1);return T}dispose(){this._isInitialized=!1,this.localCalls.length=0}init(m){this.program;let T=!0;return this.program.isInitialized()?this.program.bind(m):!this.program.init(m)&&(T=!1),this._initData(m)||(T=!1),T&&1>this.localCalls.length&&this._setCalls(m),this._callOptimizer=o.a.getInstance(m),this._isInitialized=T,T}draw(m,h=[]){this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST));const T=this.program;if(!this._callOptimizer.optimizeProgram(T)){this.program.bind(m);for(const E of this.globalCalls)E()}for(const E of this.localCalls)E();for(const E of h)E();this.geom.display(m)}}},function(d,n){'use strict';class o{constructor(){this.pointer=null,this.gl=null,this.arrayType=34962,this.data=null,this.arrayUsage=35044}isInitialized(){return!!this.pointer}setArray(l,m=this.arrayType,h=this.arrayUsage){this.arrayType=m,this.data=l,this.arrayUsage=h;const T=this.gl;T&&(T.bindBuffer(m,this.pointer),T.bufferData(m,l,arrayUsage))}setItems(l=5126,m=3,h=null){this.itemType=l,this.itemSize=m}init(l){const m=l.createBuffer();return l.bindBuffer(this.arrayType,m),l.bufferData(this.arrayType,this.data,this.arrayUsage),this.pointer=m,this.gl=l,!0}bind(l){l.bindBuffer(this.arrayType,this.pointer)}clone(l=new o){return l.setArray(this.data,this.arrayType,this.arrayUsage),l.setItems(this.itemType,this.itemSize),l}}n.a=o},function(d,n,u){'use strict';var o=u(1);class l{constructor(){this.meshs=[],this.depthTest=!0,this.sortCompare=(m,h)=>{if(m.order!==h.order)return m.order-h.order;return m.program&&h.program&&m.program!==h.program?m.program.id-h.program.id:m.textures&&h.textures&&0<m.textures.length&&0<m.textures.length?m.textures[0].id-h.textures[1].id:0},this._updateList=[]}addMesh(m){this.meshs.push(m)}rmMesh(m){const h=this.meshs.indexOf(m);-1<h&&this.meshs.splice(h,1)}sort(){this.meshs.sort(this.sortCompare)}set bgColor([m,h,T,E=1]){this._updateList.push((_)=>_.clearColor(m,h,T,E)),this._bgColor=[m,h,T,E]}get bgColor(){return this._bgColor}init(m){this._callOptimizer=o.a.getInstance(m)}draw(m){for(;0<this._updateList.length;)this._updateList.pop()(m);this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST)),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT|m.STENCIL_BUFFER_BIT);for(const h of this.meshs)h.visible&&(h.isInitialized()?h.draw(m):(h.init(m),h.draw(m)))}}n.a=l},function(d,n,u){'use strict';var o=u(16);n.a=class{constructor(m,h={antialias:!0,stencil:!0,width:640,height:360}){this.width=h.width,this.height=h.height,this.screenRecorder=new o.a(h.width,h.height,!0,!0),this.passEnabled=!0,this.scenes=[],this.passList=[],this.isEnable=!1,this._init(m,{antialias:h.antialias,stencil:h.stencil}),this._initScreenRecorder(this.gl)}_init(m,h){let T;try{T=m.getContext('webgl',h)||m.getContext('experimental-webgl',h)}catch(E){console.error('Could not initialise WebGL:',E.message)}T||console.error('Could not initialise WebGL'),this.gl=T,this.gl.viewport(0,0,this.width,this.height)}_initScreenRecorder(m){if(this.screenRecorder.init(m),!this.screenRecorder.depthTexture)for(const h of this.passList)this._disableDepthInTexture(h,m)}isInitialized(){return this.screenRecorder.isInitialized()}addScene(m){m.init(this.gl),this.scenes.push(m)}resize(m,h){this.width=m,this.height=h,this.gl.viewport(0,0,this.width,this.height),this.screenRecorder.resize(m,h,this.gl);for(const T of this.passList)T.resize(m,h)}_disableDepthInTexture(m,h){m.inDepthTexture&&m.setDepthTexture(!1,h)}addPass(m){m.init(this.gl,[]),this.screenRecorder.isInitialized()&&!this.screenRecorder.depthTexture&&this._disableDepthInTexture(m,this.gl),m.uWidth&&(m.uWidth.data=this.width),m.uHeight&&(m.uHeight.data=this.height),this.passList.push(m),this.isEnable=!0}removePass(m){const h=this.passList.indexOf(m);-1<h&&this.passList.splice(h,1),this.isEnable=0<this.passList.length}draw(){const m=this.gl,h=this.passList.length;if(this.passEnabled&&0<h&&0<this.scenes.length){this.screenRecorder.start(m,!0),this.scenes[0].draw(m),this.screenRecorder.stop(m),this.screenRecorder.pingpong();for(let T=0;T<h;T++){const E=this.passList[T],_=T>h-2;_||this.screenRecorder.start(m,!1),this.screenRecorder.pingpong(),E.inColorTexture&&E.inColorTexture.setTexture(this.screenRecorder.colorTexture),E.inDepthTexture&&this.screenRecorder.depthTexture&&E.inDepthTexture.setTexture(this.screenRecorder.depthTexture),E.draw(m),this.screenRecorder.stop(m)}}else 0<this.scenes.length&&this.scenes[0].draw(m)}}},function(d,n,u){'use strict';var o=u(1);let l=0;class m{constructor(h){this.id=l++,this.label=h,this.mipmap=!0,this.img=null,this.width=null,this.height=null,this.pointer=null,this.parameters=[],this.setType(),this.setInternalFormat(),this.setFormat(),this.setTarget()}resize(h,T,E=null){this.width=h,this.height=T,E?(E.bindTexture(this.target,this.pointer),E.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img)):this.updated=!0}setTempColor(h){this.setImg(new Uint8Array(h),1,1)}setImg(h=new Uint8Array([255,255,255,255]),T=1,E=1){this.img=h,this.width=T,this.height=E}setType(h=5121){this.type=h}setInternalFormat(h=6408){this.internalFormat=h}setFormat(h=6408){this.format=h}setTarget(h=3553){this.target=h}setParam(h,T){const E=this.parameters.find((_)=>_[0]===h);-1<E?this.parameters[E][1]=T:this.parameters.push([h,T])}isInitialized(){return!!this.pointer}static IS_POWER_OF_2(h){return 0==(h&h-1)}static SET_DATA(h){m.MAX_SIZE=h.getParameter(h.MAX_TEXTURE_SIZE),m.FORMAT={};const T=h.getParameter(h.COMPRESSED_TEXTURE_FORMATS);for(let E=0;E<T.length;E++)m.FORMAT[T[E]]=!0;m._DATA_INITIALIZED=!0}setDefaultParams(h){this.mipmap?this.setParam(h.TEXTURE_MIN_FILTER,h.LINEAR_MIPMAP_LINEAR):(this.setParam(h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),this.setParam(h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),this.setParam(h.TEXTURE_MIN_FILTER,h.LINEAR))}initParams(h){if(this.mipmap){const T=this.img;null===T?console.warn('You need an image to set the parameters of texture'):m.IS_POWER_OF_2(T.width)&&m.IS_POWER_OF_2(T.height)?h.generateMipmap(this.target):(this.mipmap=!1,console.warn('You need a power of 2 for the size of the mipmaped texture'))}1>this.parameters.length&&this.setDefaultParams(h);for(const[T,E]of this.parameters)h.texParameteri(this.target,T,E)}init(h){const T=h.createTexture();return m._DATA_INITIALIZED||m.SET_DATA(h),h.bindTexture(this.target,T),h.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.initParams(h),this._callOptimizer=o.a.getInstance(h),this.pointer=T,!0}bind(h,T,E){this._callOptimizer.optimizeTexture(this)||(h.uniform1i(T,E),h.activeTexture(h.TEXTURE0+E),h.bindTexture(this.target,this.pointer),this.updated&&(h.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.updated=!1))}free(h){h.bindTexture(h.TEXTURE_2D,null)}}n.a=m},function(d,n,u){'use strict';var o=u(7);class l extends o.a{constructor(m){super(),this.label=m}bind(m,h){super.bind(m),m.vertexAttribPointer(h,this.itemSize,this.itemType,!1,0,0)}clone(m=new l(this.label)){return m.label=this.label,super.clone(m),m}}n.a=l},function(d,n,u){'use strict';var o=u(5),l=u(0);class m extends l.a{constructor(h){super(h,35676,new o.a),this.updateNum=0,this.updated=!0,this.local=new o.a,this.parent=null}get global(){return this.update(),this._data}update(){const h=this.parent,T=null!==this.parent;if(this.updated||T&&this._parentUpdateNum!==h.updateNum){const E=this._data;T?(h.global.copy(E),E.multiply(this.local),this._parentUpdateNum=h.updateNum):this.local.copy(E),this.updateNum++,this.updated=!0}}clear(){this.local.identity(),this.updateNum++,this.updated=!0}scale(h){this.local.scale(h),this.updateNum++,this.updated=!0}translate(h){this.local.translate(h),this.updateNum++,this.updated=!0}rotate(h,T){this.local.rotate(h,T),this.updateNum++,this.updated=!0}rotateX(h){this.local.rotateX(h),this.updateNum++,this.updated=!0}rotateY(h){this.local.rotateY(h),this.updateNum++,this.updated=!0}rotateZ(h){this.local.rotateZ(h),this.updateNum++,this.updated=!0}attach(h){this.parent=h,this._parentUpdateNum=h.updateNum,this.updateNum++,this.updated=!0}detach(){this.parent=null,this.updateNum++,this.updated=!0}}n.a=m},function(d,n,u){'use strict';var o=u(5),l=u(0);class m extends l.a{constructor(){super('uPMatrix',35676,new o.a),this.fovy=45,this.near=0.1,this.far=100;const h=new o.a;this._matrix=h,this.updated=!0,this.updateNum=0,this._ratio=0,this.clear=()=>{h.identity(),this.updated=!0},this.translate=(T)=>{h.translate(T),this.updated=!0},this.scale=(T)=>{h.scale(T),this.updated=!0},this.rotate=(T,E)=>{h.rotate(T,E),this.updated=!0},this.rotateX=(T)=>{h.rotateX(T),this.updated=!0},this.rotateY=(T)=>{h.rotateY(T),this.updated=!0},this.rotateZ=(T)=>{h.rotateZ(T),this.updated=!0},this.lookAt=(T,E,_)=>{h.lookAt(T,E,_),this.updated=!0}}get data(){return this.updated&&this.update(),this._data}get ratio(){return this._ratio}set ratio(h){this._ratio=h,this.updated=!0}resize(h,T){this._ratio=h/T,this.updated=!0}update(){this._data.perspective(this.fovy*_MathPI/180,this._ratio,this.near,this.far),this._data.multiply(this._matrix),this.updated=!1,this.updateNum++}}n.a=m},function(d,n){'use strict';n.a=class{constructor(){this.pointer=null}isInitialized(){return!!this.pointer}init(l){const m=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,m),this.pointer=m,!0}bind(l){l.bindFramebuffer(l.FRAMEBUFFER,this.pointer)}free(l){l.bindFramebuffer(l.FRAMEBUFFER,null)}}},function(d,n){'use strict';n.a=class{constructor(l,m){this.pointer=null,this.width=l,this.height=m}resize(l,m,h=null){this.width=l,this.height=m,h?(h.bindRenderbuffer(h.RENDERBUFFER,this.pointer),h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_COMPONENT16,l,m)):this.updated=!0}isInitialized(){return!!this.pointer}init(l){const m=l.createRenderbuffer();l.bindRenderbuffer(l.RENDERBUFFER,m),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,this.width,this.height),this.pointer=m}bind(l){l.bindRenderbuffer(l.RENDERBUFFER,renderBuffer),this.updated&&(l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,this.width,this.height),this.updated=!1)}}},function(d,n,u){'use strict';var o=u(10),l=u(15),m=u(14);class h{constructor(T,E,_=!0,I=!1){this.captureDepth=_,this.recordDepth=I,this.width=T,this.height=E,this.updated=!1,this._pingpong=!1,this._colorTextures=[this._genColorTexture('frameBufferColor0',T,E),this._genColorTexture('frameBufferColor1',T,E)],this.frameBuffer=new m.a}_genDepthTexture(T,E,_){const I=new o.a;return I.mipmap=!1,I.setInternalFormat(6402),I.setFormat(6402),I.setType(5123),I.setParam(10242,33071),I.setParam(10243,33071),I.setParam(10241,9728),I.setParam(10240,9728),I.setImg(null,E,_),I}_genColorTexture(T,E,_){const I=new o.a(T);return I.mipmap=!1,!1,I.setImg(null,E,_),I}pingpong(){this._pingpong=!this._pingpong}get colorTexture(){return this._colorTextures[this._pingpong?1:0]}resize(T,E,_){this.width=T,this.height=E,this.pingpong(),this.colorTexture.resize(T,E,_),this.pingpong(),this.colorTexture.resize(T,E,_),this.depthTexture&&this.depthTexture.resize(T,E,_),this.renderBuffer&&this.renderBuffer.resize(T,E,_)}isInitialized(){return!!this.frameBuffer.pointer}static SET_DATA(T){h.WEBGL_depth_texture=T.getExtension('WEBGL_depth_texture')||T.getExtension('WEBKIT_WEBGL_depth_texture')||T.getExtension('MOZ_WEBGL_depth_texture'),h._DATA_INITIALIZED=!0}init(T){return h._DATA_INITIALIZED||h.SET_DATA(T),this.recordDepth&&(h.WEBGL_depth_texture?(this.depthTexture=this._genDepthTexture('frameBufferDepth',this.width,this.height),this.depthTexture.init(T)):(console.warn('WEBGL_depth_texture Extension not available!'),this.recordDepth=!1)),this.captureDepth&&(this.renderBuffer=new l.a(this.width,this.height),this.renderBuffer.init(T)),this.frameBuffer.init(T),this.pingpong(),this.colorTexture.init(T),this.pingpong(),this.colorTexture.init(T),this.depthTexture?T.framebufferTexture2D(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.TEXTURE_2D,this.depthTexture.pointer,0):this.renderBuffer&&T.framebufferRenderbuffer(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.RENDERBUFFER,this.renderBuffer.pointer),T.bindTexture(T.TEXTURE_2D,null),T.bindFramebuffer(T.FRAMEBUFFER,null),T.bindRenderbuffer(T.RENDERBUFFER,null),!0}start(T,E=!0){this.frameBuffer.bind(T),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,this.colorTexture.pointer,0),this.depthTexture?T.framebufferTexture2D(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.TEXTURE_2D,E?this.depthTexture.pointer:null,0):this.renderBuffer&&T.framebufferRenderbuffer(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.RENDERBUFFER,E?this.renderBuffer.pointer:null)}stop(T){this.frameBuffer.free(T)}}n.a=h},function(d,n,u){'use strict';var l=u(10);class m extends l.a{constructor(h){super(h),this.srcs=[],this.setTempColor([255,255,255,255])}setTempColor(h){this.setImg(new Uint8Array(h),1,1)}addURL(h,T=0){const E={size:T,src:h,img:null,priority:0,isImage:!0,isValid:()=>!0,init:null};E.init=(_)=>{_.bindTexture(_.TEXTURE_2D,this.pointer),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!0),_.texImage2D(_.TEXTURE_2D,0,6408,this.format,_.UNSIGNED_BYTE,E.img),this.img=E.img,this.initParams(_)},this.srcs.push(E)}static START_LOAD(h,T){if(0<T.length){T.sort((_,I)=>_.size===I.size?_.size-I.size:_.priority-I.priority);T.filter((_)=>_.size>=l.a.MAX_SIZE&&_.isValid(h));if(1<T.length){const _=T[0],I=T[T.length-1];m.LOAD(_,()=>{_.init(h),m.LOAD(I,()=>{I.init(h)})})}else if(0<T.length){const _=T[0];m.LOAD(_,()=>{_.init(h)})}else console.warn('The GPU can\'nt load a texture with size > ',l.a.MAX_SIZE)}else console.warn('URL of your smart texture not found')}static LOAD(h,T){if(h.isImage){const E=new Image;E.onload=()=>{T(h)},h.img=E,E.src=h.src}else{const E=new XMLHttpRequest;E.responseType='arraybuffer',E.open('GET',h.src,!0),E.onreadystatechange=()=>{E.readyState===XMLHttpRequest.DONE&&(200===E.status?(h.img=E.response,T(h)):console.error('fail to load image ',h.src,'status:',E.status,'statuc text:',E.statusText))},E.send()}}init(h,T){const E=super.init(h,T),_=this.pointer;return m.START_LOAD(h,this.srcs),E}}n.a=m},function(d,n,u){'use strict';var o=u(6),l=u(3),m=u(0),h=u(34);class T extends o.a{constructor(E,_='aVertexPosition',I='uSample'){const R=new l.a;R.addVertices(_,[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1],2),super(R,E)}resize(E,_){this.uWidth&&(this.uWidth.data=E),this.uHeight&&(this.uHeight.data=_)}useUWidth(E,_){const I=new m.a(E,5124,_);this.uWidth=I,this.addUniform(I)}useUHeight(E,_){const I=new m.a(E,5124,_);this.uHeight=I,this.addUniform(I)}useColorTexture(E){const _=new h.a(E);this.inColorTexture=_,this.addTexture(_)}useDepthTexture(E,_){const I=new h.a(E);this.inDepthTexture=I,this.addTexture(I);const R=new m.a(_,5124,1);this._inDetpthEnableUniform=R,this.addUniform(R)}setDepthTexture(E,_){this.rmTexture(this.inDepthTexture),E&&this.addTexture(this.inDepthTexture),this._inDetpthEnableUniform.data=E?1:0;const I=this.globalUniforms;this.dispose(),this.init(_,I)}}n.a=T},function(d,n){'use strict';function o(h,T,E,_,I,R,D,P,F,L){h[0]=T,h[1]=E,h[2]=_,h[3]=I,h[4]=R,h[5]=D,h[6]=P,h[7]=F,h[8]=L}const l=1e-6;class m extends Float32Array{constructor(){super(9),this[0]=1,this[4]=1,this[8]=1}fromMarix4(h){this.setMat(this,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])}clone(){const h=new m;return h.set(this),h}copy(h){return h.set(this),this}identity(){return o(this,1,0,0,0,1,0,0,0,1),this}add(h){return this[0]+=h[0],this[1]+=h[1],this[2]+=h[2],this[3]+=h[3],this[4]+=h[4],this[5]+=h[5],this[6]+=h[6],this[7]+=h[7],this[8]+=h[8],this}subtract(h){return this[0]-=h[0],this[1]-=h[1],this[2]-=h[2],this[3]-=h[3],this[4]-=h[4],this[5]-=h[5],this[6]-=h[6],this[7]-=h[7],this[8]-=h[8],this}multiplyScalar(h){return this[0]*=h,this[1]*=h,this[2]*=h,this[3]*=h,this[4]*=h,this[5]*=h,this[6]*=h,this[7]*=h,this[8]*=h,this}multiplyScalarAndAdd(h,T){return this[0]+=h[0]*T,this[1]+=h[1]*T,this[2]+=h[2]*T,this[3]+=h[3]*T,this[4]+=h[4]*T,this[5]+=h[5]*T,this[6]+=h[6]*T,this[7]+=h[7]*T,this[8]+=h[8]*T,this}exactEquals(h){return this[0]===h[0]&&this[1]===h[1]&&this[2]===h[2]&&this[3]===h[3]&&this[4]===h[4]&&this[5]===h[5]&&this[6]===h[6]&&this[7]===h[7]&&this[8]===h[8]}equals(h){const[T,E,_,I,R,D,P,F,L]=this,[N,U,A,C,M,B,v,O,k]=h;return _Mathabs(T-N)<=l*_Mathmax(1,_Mathabs(T),_Mathabs(N))&&_Mathabs(E-U)<=l*_Mathmax(1,_Mathabs(E),_Mathabs(U))&&_Mathabs(_-A)<=l*_Mathmax(1,_Mathabs(_),_Mathabs(A))&&_Mathabs(I-C)<=l*_Mathmax(1,_Mathabs(I),_Mathabs(C))&&_Mathabs(R-M)<=l*_Mathmax(1,_Mathabs(R),_Mathabs(M))&&_Mathabs(D-B)<=l*_Mathmax(1,_Mathabs(D),_Mathabs(B))&&_Mathabs(P-v)<=l*_Mathmax(1,_Mathabs(P),_Mathabs(v))&&_Mathabs(F-O)<=l*_Mathmax(1,_Mathabs(F),_Mathabs(O))&&_Mathabs(L-k)<=l*_Mathmax(1,_Mathabs(L),_Mathabs(k))}transpose(h){if(h===this){const T=h[1],E=h[2],_=h[5];this[1]=h[3],this[2]=h[6],this[3]=T,this[5]=h[7],this[6]=E,this[7]=_}else o(this,h[0],h[4],h[6],h[1],h[4],h[5],h[2],h[7],h[8]);return this}invert(){const[h,T,E,_,I,R,D,P,F]=this,N=R*D-F*_,U=D*I-P*_;let A=h*b01+T*N+E*U;return A?(A=1/A,o(this,b01*A,(-F*T+E*P)*A,(R*T-E*I)*A,N*A,(F*h-E*D)*A,(-R*h+E*_)*A,U*A,(-P*h+T*D)*A,(I*h-T*_)*A),this):this}adjoint(){const[h,T,E,_,I,R,D,P,F]=this;return o(this,I*F-R*P,E*P-T*F,T*R-E*I,R*D-_*F,h*F-E*D,E*_-h*R,_*P-I*D,T*D-h*P,h*I-T*_),this}determinant(){const[h,T,E,_,I,R,D,P,F]=this;return h*(F*I-R*P)+T*(-F*_+R*D)+E*(P*_-I*D)}multiply(h){const[T,E,_,I,R,D,P,F,L]=this;let[N,U,A,C,M,B,v,O,k]=h;return o(this,N*T+U*I+A*P,N*E+U*R+A*F,N*_+U*D+A*L,C*T+M*I+B*P,C*E+M*R+B*F,C*_+M*D+B*L,v*T+O*I+k*P,v*E+O*R+k*F,v*_+O*D+k*L),this}translate([h,T]){const[E,_,I,R,D,P,F,L,N]=this;return this[6]=h*E+T*R+F,this[7]=h*_+T*D+L,this[8]=h*I+T*P+N,this}rotate(h){const[T,E,_,I,R,D,P,F,L]=this,N=_Mathsin(h),U=_Mathcos(h);return this[0]=U*T+80*I,this[1]=U*a080801+N*R,this[2]=U*_+N*D,this[3]=U*I-N*T,this[4]=U*R-N*E,this[5]=U*D-N*_,this}scale([h,T]){return this[0]*=h,this[1]*=h,this[2]*=h,this[3]*=T,this[4]*=T,this[5]*=T,this}fromTranslation(h){return o(this,1,0,0,0,1,0,h[0],h[1],1),this}fromScaling(h){return o(this,h[0],0,0,0,h[1],0,0,0,1),this}fromMatrix2(h){return o(this,h[0],h[1],0,h[2],h[3],0,h[4],h[5],1),out}fromQuat(h){const[T,E,_,I]=h,R=T+T,D=E+E,P=_+_,F=T*R,L=E*R,N=E*D,U=_*R,A=_*D,C=_*P,M=I*R,B=I*D,v=I*P;return o(this,1-N-C,L-v,U+B,L+v,1-F-C,A-M,U-B,A+M,1-F-N),this}normalFromMatrix4(){const[T,E,_,I,R,D,P,F,L,N,U,A,C,M,B,v]=this,O=T*D-E*R,k=T*P-_*R,X=T*F-I*R,H=E*P-_*D,G=E*F-I*D,V=_*F-I*P,W=L*M-N*C,Y=L*B-U*C,Z=L*v-A*C,q=N*B-U*M,K=N*v-A*M,$=U*v-A*B;let J=O*$-k*K+X*q+H*Z-G*Y+V*W;return J?(J=1/J,o(this,(D*$-P*K+F*q)*J,(P*Z-R*$-F*Y)*J,(R*K-D*Z+F*W)*J,(_*K-E*$-I*q)*J,(T*$-_*Z+I*Y)*J,(E*Z-T*K-I*W)*J,(M*V-B*G+v*H)*J,(B*X-C*V-v*k)*J,(C*G-M*X+v*O)*J),this):null}frob(){return _Mathsqrt(_Mathpow(this[0],2)+_Mathpow(this[1],2)+_Mathpow(this[2],2)+_Mathpow(this[3],2)+_Mathpow(this[4],2)+_Mathpow(this[5],2)+_Mathpow(this[6],2)+_Mathpow(this[7],2)+_Mathpow(this[8],2))}}n.a=m},,,function(d,n,u){'use strict';var o=u(4);class l extends o.a{constructor(m,h){super(m,h),this.depthTest=!1,this.order=-1}}n.a=l},function(d,n,u){'use strict';var o=u(1);n.a=class{constructor(){this.meshs=[],this.order=0,this.visible=!0,this.mask=null,this._isInitialized=!1,this.sortCompare=(m,h)=>{if(m.order!==h.order)return m.order-h.order;return m.program&&h.program&&m.program!==h.program?m.program.id-h.program.id:m.textures&&h.textures&&0<m.textures.length&&0<m.textures.length?m.textures[0].id-h.textures[1].id:0}}setMask(m){this.mask=m}addMesh(m){this.meshs.push(m)}rmMesh(){const m=this.meshs.indexOf(mesh);-1<m&&this.meshs.splice(m,1)}sort(){this.meshs.sort(this.sortCompare)}isInitialized(){if(null!==this.mask&&!this.mask.isInitialized())return!1;for(const m of this.meshs)if(!m.isInitialized())return!1;return!0}dispose(){for(const m of this.meshs)m.dispose();return!0}init(m){let h=!0;null!==this.mask&&this.mask.init(m);for(const T of this.meshs)T.init(m)||(h=!1);return this._callOptimizer=o.a.getInstance(m),h}draw(m,h=[]){this.mask&&this.mask.before(m);for(const T of this.meshs)T.draw(m,h);this.mask&&this.mask.after(m)}}},function(d,n,u){'use strict';var o=u(1);n.a=class{constructor(m){this.mesh=m,this.setMaskFunc(519,1,255),this.setDisplayFunc(517,0,255)}setMaskFunc(m,h,T){this.maskFunc=m,this.maskRef=h,this.maskMask=T}setDisplayFunc(m,h,T){this.displayFunc=m,this.displayRef=h,this.displayMask=T}isInitialized(){return this.mesh.isInitialized()}init(m){this.mesh.init(m),this._callOptimizer=o.a.getInstance(m)}before(m,h=[]){m.enable(m.STENCIL_TEST),m.depthMask(!1),m.clear(m.STENCIL_BUFFER_BIT),m.colorMask(!1,!1,!1,!1),m.stencilOp(m.KEEP,m.KEEP,m.INCR),m.stencilFunc(this.maskFunc,this.maskRef,this.maskMask),this.mesh.draw(m,h),this._callOptimizer.optimizeProgram(null),m.stencilFunc(this.displayFunc,this.displayRef,this.displayMask),m.depthMask(!0),m.colorMask(!0,!0,!0,!0),m.stencilOp(m.KEEP,m.KEEP,m.KEEP)}after(m){m.disable(m.STENCIL_TEST)}}},function(d,n,u){'use strict';var o=u(6),l=u(35);class m extends o.a{constructor(h,T){super(h,T),this.depthTest=!1;const E=new l.a('uMVMatrix');this.transform=E,this.addUniform(E)}get position(){return this.transform.getTranslation()}get rotation(){return this.transform.getRotation()}draw(h,T=[]){this.transform&&this.transform.update(),super.draw(h,T)}}n.a=m},function(d,n,u){'use strict';var o=u(5),l=u(0);const m=new Float32Array(3);class h extends l.a{constructor(T,E,_=1){super(T,35676,new o.a),this.camera3D=E,this.updateNum=-1,this.distance=_}get data(){return this.updateNum!==this.camera3D.updateNum&&this.update(),this._data}update(){const T=this.camera3D,E=T._matrix;E.getTranslation(m),m[0]=-m[0]*this.distance,m[1]=-m[1]*this.distance,m[2]=-m[2]*this.distance,this._data.perspective(T.fovy*_MathPI/180,T.ratio,T.near,T.far),this._data.translate(m),this._data.multiply(E),this.updateNum=this.camera3D.updateNum}}n.a=h},function(d,n,u){'use strict';var o=u(19),l=u(0);class m extends l.a{constructor(){super('uPMatrix',35675,new o.a),this._matrix=new o.a,this.updated=!0,this.updateNum=0,this._minX=-1,this._maxX=1,this._minY=-1,this._maxY=1,this.clear=()=>{matrix.identity(),this.updated=!0},this.translate=(h)=>{matrix.translate(h),this.updated=!0},this.scale=(h)=>{matrix.scale(h),this.updated=!0},this.rotate=(h)=>{matrix.rotate(h),this.updated=!0}}get data(){return this.updated&&this.update(),this._data}setArea(h,T,E,_){this._minX=h,this._minY=T,this._maxX=E,this._maxY=_,this.updated=!0}update(){this._data.identity();const h=this._maxX-this._minX,T=this._maxY-this._minY;this._data.scale([1/h,1/T]),this._data.multiply(this._matrix),this.updated=!1,this.updateNum++}}n.a=m},function(d,n,u){'use strict';function o(I){return _NumberisInteger(I)?I.toFixed(1):I}var l=u(18),m=u(2),h=u(0);const T=`
    attribute vec3 aVertexPosition;
    varying vec2 vTextureCoord;

    void main(void)
    {
        vTextureCoord = vec2(aVertexPosition.x * 0.5 + 0.5, aVertexPosition.y * 0.5 + 0.5);
        gl_Position = vec4(aVertexPosition, 1.0);
    }`,E=`
    precision mediump float;
    varying vec2 vTextureCoord;
    uniform sampler2D uColor;
    uniform sampler2D uDepth;

    uniform vec3 uColorFog;
    
    uniform int uDepthEnable;

    void main(void)
    {
        $chunkcall
        gl_FragColor = color;
    }`;class _ extends l.a{constructor({minDepth:I=0.1,maxDepth:R=0.2,minPower:D=0.2,maxPower:P=1,depthCurve:F=100,color:L=[1,1,1]}){super(null,'aVertexPosition','uColor'),this.useColorTexture('uColor'),this.useDepthTexture('uDepth','uDepthEnable');const N=new h.a('uColorFog',35665,L);this.addUniform(N);const U=this._initFragmentShader(I,R,D,P,F);this.program=new m.a(T,U)}_initFragmentShader(I,R,D,P,F){let L=`
            float depthValue = 0.0;
            if (uDepthEnable >= 0) {
                vec4 depth = texture2D(uDepth, vTextureCoord.xy);
                depthValue = pow(depth.x, ${o(F)});
                depthValue = (depthValue - ${o(I)}) / ${o(R-I)};
                depthValue = clamp(depthValue, ${o(D)}, ${o(P)});
            }
            vec4 originalColor = texture2D(uColor, vTextureCoord.xy); 
            vec4 color = vec4(mix(originalColor.xyz, uColorFog, depthValue), originalColor.w);
        `;const N=E.replace('$chunkcall',L);return N}}n.a=_},function(d,n,u){'use strict';function o(I){return _NumberisInteger(I)?I.toFixed(1):I}var l=u(18),m=u(2),h=u(0);const T=`
    attribute vec3 aVertexPosition;
    varying vec2 vTextureCoord;

    void main(void)
    {
        vTextureCoord = vec2(aVertexPosition.x * 0.5 + 0.5, aVertexPosition.y * 0.5 + 0.5);
        gl_Position = vec4(aVertexPosition, 1.0);
    }`,E=`
    precision mediump float;
    varying vec2 vTextureCoord;
    uniform sampler2D uColor;
    uniform sampler2D uDepth;
    uniform int uSize;
    uniform int uDepthEnable;

    $chunkfct

    void main(void)
    {
        $chunkcall
        gl_FragColor = color;
    }`;class _ extends l.a{constructor({minDepth:I=0.1,maxDepth:R=0.2,samples:D=5,xBlur:P=!0,power:F=1,depthCurve:L=100}){super(null,'aVertexPosition','uColor'),this.power=F,this.xBlur=P,this.depthCurve=L,this.useColorTexture('uColor'),this.useDepthTexture('uDepth','uDepthEnable');const N=this._initFragmentShader(I,R,D);this.program=new m.a(T,N),P?this.useUWidth('uSize',1):this.useUHeight('uSize',1)}_initFragmentShader(I=0.1,R=0.3,D=5){const P=this.xBlur,F=o(this.power),L=[];for(let C=0;C<D;C++){const M=this._getKernels(C+1);L.push(M)}let N='';for(let C=0;C<L.length;C++){const M=L[C];N+=`
            vec4 blur${C+1}(sampler2D i, vec2 uv) {
                vec2 m;
                vec4 color = texture2D(i, uv) * ${o(M[0])};`;for(let B=1;B<M.length;B++)N+=`
                m = ${P?'vec2('+B+'.0 * '+F+' / float(uSize), 0.0)':'vec2(0.0, '+B+'.0 * '+F+' / float(uSize))'};
                color += texture2D(i, uv + m) * ${o(M[B])};
                color += texture2D(i, uv - m) * ${o(M[B])};`;N+='return color; }'}let U=`
            float depthValue = 0.0;
            vec4 color;
            if (uDepthEnable >= 0) {
                vec4 depth = texture2D(uDepth, vTextureCoord.xy);
                depthValue = pow(depth.x, ${o(this.depthCurve)});
                
                int blurPower = int(floor(0.5 + (depthValue - ${o(I)}) * ${o(D)} / ${o(R-I)}));   
        `;for(let C=0;C<D;C++){const M='blurPower'+(C>D-2?' >= '+C:1>C?' < 1':' == '+C);U+=`${0<C?' else if':'if'} ( ${M}) {
                color = blur${C+1}(uColor, vTextureCoord.xy);
            }`}U+=`
        } else {
            color = texture2D(uColor, vTextureCoord.xy);
        }
        `;const A=E.replace('$chunkfct',N).replace('$chunkcall',U);return A}_getKernels(I){const R=[];let D=0;for(let P=1;P<I+2;P++){const F=3*(P-1)/I,L=Math.exp(-F*F);D+=2>P?L:L+L,R.push(L)}for(let P=0;P<R.length;P++)R[P]/=D;return R}}n.a=_},,function(d,n,u){'use strict';function o(Ve=null){let We=0;Ve&&(Ve.wheelDelta?We=Ve.wheelDelta:Ve.detail?We=-40*Ve.detail:Ve.deltaY&&(We=-40*Ve.deltaY)),Xe-=We/1e3,Xe=_Mathmin(_Mathmax(Xe,0.37),3),Y.fovy=45*Xe}function m(Ve){const We=Ve.clientX,Ye=Ve.clientY,Ze=(We-Ge[0])/He[0],qe=(Ye-Ge[1])/He[1];Ge[0]=We,Ge[1]=Ye,Oe+=2*(Ze*_MathPI),ke+=qe*_MathPI,ke=_Mathmax(_Mathmin(ke,0.3*_MathPI),0.3*-_MathPI)}function h(){const We=document.body;We.removeEventListener('mousemove',m),We.removeEventListener('mouseup',h),We.removeEventListener('mouseleave',h),We.classList.remove('is-grabbing')}function T(){const Ve=1;He[0]=window.innerWidth,He[1]=window.innerHeight,Ce.resize(He[0]*Ve,He[1]*Ve),W.width=He[0]*Ve,W.height=He[1]*Ve,Y.resize(...He),Z.setArea(0,0,...He)}function E(){Y.clear(),Y.translate([0,0,-Xe]),Y.rotate(ke,[1,0,0]),Y.rotate(Oe,[0,1,0]),ie.transform.rotateY(5e-3),xe.transform.rotate(-5e-3,[0,1,0]),Te.transform.rotate(0.01,[0,1,0]),Fe.transform.rotate(-0.01,[0,1,0]),Le.transform.rotate(0.025,[0.72,-0.33,0.5]),Ce.draw(),requestAnimationFrame(E)}Object.defineProperty(n,'__esModule',{value:!0});var _=u(0),I=u(12),R=u(26),D=u(11),P=u(2),F=u(3),L=u(17),N=u(6),U=u(25),A=u(4),C=u(23),M=u(24),B=u(22),v=u(27),O=u(13),k=u(8),X=u(18),H=u(9),G=u(29),V=u(28);const W=document.body.querySelector('canvas'),Y=new O.a,Z=new v.a,q=new k.a;q.bgColor=[0,0,0.1,1],q.depthTest=!0;const K=`      
    attribute vec3 aVertexPosition;
    attribute vec4 aVertexColor;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec4 vColor;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vColor = aVertexColor;
    }
`,$=`
    precision mediump float;

    varying vec4 vColor;

    void main(void) {
        gl_FragColor = vColor;
    }
`,J=new P.a(K,$),Q=`
    attribute vec3 aVertexPosition;
    attribute vec4 aVertexColor;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec4 vColor;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        float zDepth = 0.2 * (8.0 - gl_Position.z);
        vec4 modifyColor = vec4(aVertexColor.rgb * zDepth, aVertexColor.a);
        vColor = modifyColor;
    }
`,ee=new P.a(Q,$),re=new F.a;re.addVertices('aVertexPosition',[0,1,0,-1,-1,1,1,-1,1,0,1,0,1,-1,1,1,-1,-1,0,1,0,1,-1,-1,-1,-1,-1,0,1,0,-1,-1,-1,-1,-1,1],3),re.addVertices('aVertexColor',[1,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,1,1,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,1],4);const ie=new A.a(re,J);ie.transform.translate([-1.5,-1.5,0]),ie.addGlobalUniform(Y);const se=`      
    attribute vec2 aVertexPosition;

    uniform mat3 uMVMatrix;
    uniform mat3 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {
        vec3 pos = uPMatrix * uMVMatrix * vec3(aVertexPosition, 0.0);
        gl_Position = vec4(pos.xy, 0.0, 1.0);
    }
`,de=`
    precision mediump float;

    uniform sampler2D uDiffuse1;

    void main(void) {
        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);
    }
`,ne=new P.a(se,de),le=new F.a;le.addVertices('aVertexPosition',[-1,-1,-1,1,1,-1,-1,1,1,1,1,-1],2);const pe=new U.a(le,ne);pe.order=1,pe.transform.scale([320,320]),pe.addGlobalUniform(Z);const me=new C.a;me.addMesh(ie),q.addMesh(me),me.setMask(new M.a(pe));const fe=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],he=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],ce=[[1,0,0,1],[1,1,0,1],[0,1,0,1],[1,0.5,0.5,1],[1,0,1,1],[0,0,1,1]];let ge=[];for(let Ve in ce)for(let We=0;4>We;We++)ge=ge.concat(ce[Ve]);const be=new F.a;be.addVertices('aVertexPosition',fe,3),be.addVertices('aVertexColor',ge,4),be.addIndices(he);const Te=new A.a(be,ee);Te.transform.translate([1.5,-1.5,0]),Te.addGlobalUniform(Y),q.addMesh(Te);const xe=new A.a(re,J);xe.transform.translate([-1.5,1.5,0]),xe.transform.scale([1,-1,1]),xe.addGlobalUniform(Y),q.addMesh(xe);const Ee=`   
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vTextureCoord = aTextureCoord;
    }`,_e=`
    precision mediump float;

    varying vec2 vTextureCoord;

    uniform sampler2D uDiffuse1;
    uniform sampler2D uDiffuse2;

    void main(void) {
        vec4 color1 = texture2D(uDiffuse1, vec2(vTextureCoord.s, vTextureCoord.t));
        vec4 color2 = texture2D(uDiffuse2, vec2(vTextureCoord.s, vTextureCoord.t));
        float power = ((sin(vTextureCoord.s * 3.1415)) * (sin(vTextureCoord.t * 3.1415)));
        gl_FragColor = mix(color1, color2, power);
    }`,Ie=new P.a(Ee,_e);const De=new L.a('uDiffuse1');De.addURL('assets/cube-diffuse.jpg');const Pe=new L.a('uDiffuse2');Pe.setParam(10240,9728),Pe.setParam(10241,9728),Pe.addURL('assets/cube-diffuse-2.png');const we=new F.a;we.addVertices('aVertexPosition',fe,3),we.addVertices('aTextureCoord',[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1],2),we.addIndices(he);const Fe=new A.a(we,Ie);Fe.addTexture(De),Fe.addTexture(Pe),Fe.transform.translate([1.5,1.5,0]),Fe.addGlobalUniform(Y),q.addMesh(Fe);const Le=new A.a(we,Ie);Le.addTexture(De),Le.addTexture(Pe),Le.transform.translate([0,0,-8]),Le.addGlobalUniform(Y),q.addMesh(Le);const Ne=`   
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {

        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vTextureCoord = aTextureCoord;
    }`,Ue=`
    precision mediump float;

    varying vec2 vTextureCoord;

    uniform sampler2D uDiffuse1;

    void main(void) {
        vec4 color1 = texture2D(uDiffuse1, vec2(vTextureCoord.s, vTextureCoord.t));
        gl_FragColor = color1;
    }`,ye=new R.a('uPMatrix',Y,1),Se=new P.a(Ne,Ue),Ae=new B.a(we,Se);Ae.addTexture(De),Ae.addUniform(ye),q.addMesh(Ae),q.sort();const Ce=new H.a(W);Ce.passEnabled=!0,Ce.addScene(q);const Me=new V.a({minDepth:0.5,maxDepth:0.6,minPower:0,maxPower:0.5,depthCurve:100,color:[0.9,0.95,1]});Ce.addPass(Me);const Be={minDepth:0.95,maxDepth:1,samples:20,xBlur:!0,power:1,depthCurve:1},ze=new G.a(Be);Ce.addPass(ze),Be.xBlur=!1;const ve=new G.a(Be);Ce.addPass(ve);let Oe=0,ke=0,Xe=2.5;const He=[0,0],Ge=[0,0];document.body.addEventListener('mousedown',function(Ve){const We=document.body;Ge[0]=Ve.clientX,Ge[1]=Ve.clientY,We.removeEventListener('mousemove',m),We.removeEventListener('mouseup',h),We.removeEventListener('mouseleave',h),We.addEventListener('mousemove',m),We.addEventListener('mouseup',h),We.addEventListener('mouseleave',h),We.classList.add('is-grabbing')}),window.addEventListener('wheel',o),window.onresize=T,T(),o(),window.scene=q,window.render=Ce,E()},,,function(d,n){'use strict';n.a=class{constructor(l){this.label=l}isInitialized(){return!0}init(){return!0}setTexture(l){this.pointer=l.pointer,this.target=l.target}bind(l,m,h){l.uniform1i(m,h),l.activeTexture(l.TEXTURE0+h),l.bindTexture(this.target,this.pointer)}}},function(d,n,u){'use strict';var o=u(19),l=u(0);class m extends l.a{constructor(h){super(h,35675,new o.a),this.updateNum=0,this.updated=!0,this.local=new o.a,this.parent=null}get global(){return this.update(),this._data}update(){const h=this.parent,T=null!==this.parent;if(this.updated||T&&this._parentUpdateNum!==h.updateNum){const E=this._data;T?(h.global.copy(E),E.multiply(this.local),this._parentUpdateNum=h.updateNum):this.local.copy(this._data),this.updateNum++,this.updated=!0}}clear(){this.local.identity(),this.updateNum++,this.updated=!0}scale(h){this.local.scale(h),this.updateNum++,this.updated=!0}translate(h){this.local.translate(h),this.updateNum++,this.updated=!0}rotate(h){this.local.rotate(h),this.updateNum++,this.updated=!0}attach(h){this.parent=h,this._parentUpdateNum=h.updateNum,this.updateNum++,this.updated=!0}detach(){this.parent=null,this.updateNum++,this.updated=!0}}n.a=m}]);