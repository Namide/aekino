var _Mathmin=Math.min,_NumberisInteger=Number.isInteger,_Mathpow=Math.pow,_MathPI=Math.PI,_Mathtan=Math.tan,_Mathcos=Math.cos,_Mathsin=Math.sin,_Mathsqrt=Math.sqrt,_Mathmax=Math.max,_Mathabs=Math.abs;(function(n){function d(o){if(u[o])return u[o].exports;var l=u[o]={i:o,l:!1,exports:{}};return n[o].call(l.exports,l,l.exports,d),l.l=!0,l.exports}var u={};return d.m=n,d.c=u,d.i=function(o){return o},d.d=function(o,l,m){d.o(o,l)||Object.defineProperty(o,l,{configurable:!1,enumerable:!0,get:m})},d.n=function(o){var l=o&&o.__esModule?function(){return o['default']}:function(){return o};return d.d(l,'a',l),l},d.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},d.p='',d(d.s=27)})([function(n,d){'use strict';class o{constructor(l,m,T,E=!1){this.label=l,this.type=m,this._data=T,this._init(m,E)}get data(){return this._data}set data(l){this._data=l}_init(l){switch(this.type){case 35675:{this.bind=(T,E)=>{T.uniformMatrix3fv(E,!1,this.data)};break}case 35676:{this.bind=(T,E)=>{T.uniformMatrix4fv(E,!1,this.data)};break}case 35665:{this.bind=(T,E)=>{T.uniform3f(E,...this.data)};break}case 5124:this.bind=(T,E)=>{T.uniform1i(E,this.data)};break;case-1:this.bind=(T,E)=>{T.uniform1fv(E,this.data)};break;default:console.error('Uniform type unknow: {label:',this.label,', type:',l,'}');}}}d.a=o},function(n,d){'use strict';class o{constructor(){this.lastTexture=null,this.lastProgram=null,this.lastDepthTest=!1}optimizeTexture(l){const m=this.lastTexture;return this.lastTexture=l,l===m}optimizeProgram(l){const m=this.lastProgram;return this.lastProgram=l,l===m}optimizeDepthTest(l){const m=this.lastDepthTest;return this.lastDepthTest=l,m===l}static getInstance(l){const m=o.glList.indexOf(l);if(0>m){const T=new o;return o.glList.push(l),o.list.push(T),T}return o.list[m]}}o.glList=[],o.list=[],d.a=o},function(n,d){'use strict';let o=0;d.a=class{constructor(m,T){this.vertexShaderSrc=m,this.fragmentShaderSrc=T,this.attribLocation={},this.uniformLocation={},this.textureLocation={},this.textureIndex={},this.textureNum=0,this.id=o++}isInitialized(){return!!this.pointer}init(m){this.vertexShader=this._createShader(m,35633,this.vertexShaderSrc),this.fragmentShader=this._createShader(m,35632,this.fragmentShaderSrc);const T=m.createProgram();return(m.attachShader(T,this.vertexShader),m.attachShader(T,this.fragmentShader),m.linkProgram(T),!m.getProgramParameter(T,m.LINK_STATUS))?(console.error('Shader initialization error'),!1):(m.useProgram(T),this.pointer=T,!0)}getAttribLocation(m,T){const E=T.label;if(!this.attribLocation.hasOwnProperty(E)){const _=m.getAttribLocation(this.pointer,E);return m.enableVertexAttribArray(_),this.attribLocation[E]=_,_}return this.attribLocation[E]}getUniformLocation(m,T){const E=T.label;if(!this.uniformLocation.hasOwnProperty(E)){const _=m.getUniformLocation(this.pointer,E);return this.uniformLocation[E]=_,_}return this.uniformLocation[E]}getTextureLocationIndex(m,T){const E=T.label;if(!this.textureLocation.hasOwnProperty(E)||!this.textureIndex.hasOwnProperty(E)){const _=m.getUniformLocation(this.pointer,E);return this.textureLocation[E]=_,this.textureIndex[E]=this.textureNum,[_,this.textureNum++]}return[this.textureLocation[E],this.textureIndex[E]]}bind(m){m.useProgram(this.pointer)}_createShader(m,T,E){const _=m.createShader(T);return m.shaderSource(_,E),m.compileShader(_),m.getShaderParameter(_,m.COMPILE_STATUS)?_:console.error('Une erreur est survenue au cours de la compilation du shader: '+m.getShaderInfoLog(_))}}},function(n,d,u){'use strict';var o=u(5),l=u(10);class m extends o.a{constructor(T,E){super(T,E),this.depthTest=!0;const _=new l.a('uMVMatrix');this.transform=_,this.addUniform(_)}get position(){return this.transform.getTranslation()}get rotation(){return this.transform.getRotation()}draw(T,E=[]){this.transform&&this.transform.update(),super.draw(T,E)}}d.a=m},function(n,d){'use strict';function o(T,E,_,I,R,D,P,F,N,U,L,A,C,M,B,v,O){T[0]=E,T[1]=_,T[2]=I,T[3]=R,T[4]=D,T[5]=P,T[6]=F,T[7]=N,T[8]=U,T[9]=L,T[10]=A,T[11]=C,T[12]=M,T[13]=B,T[14]=v,T[15]=O}const l=1e-6;class m extends Float32Array{constructor(){super(16),this[0]=1,this[5]=1,this[10]=1,this[15]=1}clone(){const T=new m;return T.set(this),T}copy(T){return T.set(this),this}identity(){return o(this,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}add(T){return this[0]+=T[0],this[1]+=T[1],this[2]+=T[2],this[3]+=T[3],this[4]+=T[4],this[5]+=T[5],this[6]+=T[6],this[7]+=T[7],this[8]+=T[8],this[9]+=T[9],this[10]+=T[10],this[11]+=T[11],this[12]+=T[12],this[13]+=T[13],this[14]+=T[14],this[15]+=T[15],this}subtract(T){return this[0]-=T[0],this[1]-=T[1],this[2]-=T[2],this[3]-=T[3],this[4]-=T[4],this[5]-=T[5],this[6]-=T[6],this[7]-=T[7],this[8]-=T[8],this[9]-=T[9],this[10]-=T[10],this[11]-=T[11],this[12]-=T[12],this[13]-=T[13],this[14]-=T[14],this[15]-=T[15],this}multiplyScalar(T){return this[0]*=T,this[1]*=T,this[2]*=T,this[3]*=T,this[4]*=T,this[5]*=T,this[6]*=T,this[7]*=T,this[8]*=T,this[9]*=T,this[10]*=T,this[11]*=T,this[12]*=T,this[13]*=T,this[14]*=T,this[15]*=T,this}multiplyScalarAndAdd(T,E){return this[0]+=T[0]*E,this[1]+=T[1]*E,this[2]+=T[2]*E,this[3]+=T[3]*E,this[4]+=T[4]*E,this[5]+=T[5]*E,this[6]+=T[6]*E,this[7]+=T[7]*E,this[8]+=T[8]*E,this[9]+=T[9]*E,this[10]+=T[10]*E,this[11]+=T[11]*E,this[12]+=T[12]*E,this[13]+=T[13]*E,this[14]+=T[14]*E,this[15]+=T[15]*E,this}exactEquals(T){return this[0]===T[0]&&this[1]===T[1]&&this[2]===T[2]&&this[3]===T[3]&&this[4]===T[4]&&this[5]===T[5]&&this[6]===T[6]&&this[7]===T[7]&&this[8]===T[8]&&this[9]===T[9]&&this[10]===T[10]&&this[11]===T[11]&&this[12]===T[12]&&this[13]===T[13]&&this[14]===T[14]&&this[15]===T[15]}equals(T){const[E,_,I,R,D,P,F,N,U,L,A,C,M,B,v,O]=this,[k,X,H,G,V,W,Y,Z,q,K,$,J,Q,ee,te,ae]=T;return _Mathabs(E-k)<=l*_Mathmax(1,_Mathabs(E),_Mathabs(k))&&_Mathabs(_-X)<=l*_Mathmax(1,_Mathabs(_),_Mathabs(X))&&_Mathabs(I-H)<=l*_Mathmax(1,_Mathabs(I),_Mathabs(H))&&_Mathabs(R-G)<=l*_Mathmax(1,_Mathabs(R),_Mathabs(G))&&_Mathabs(D-V)<=l*_Mathmax(1,_Mathabs(D),_Mathabs(V))&&_Mathabs(P-W)<=l*_Mathmax(1,_Mathabs(P),_Mathabs(W))&&_Mathabs(F-Y)<=l*_Mathmax(1,_Mathabs(F),_Mathabs(Y))&&_Mathabs(N-Z)<=l*_Mathmax(1,_Mathabs(N),_Mathabs(Z))&&_Mathabs(U-q)<=l*_Mathmax(1,_Mathabs(U),_Mathabs(q))&&_Mathabs(L-K)<=l*_Mathmax(1,_Mathabs(L),_Mathabs(K))&&_Mathabs(A-$)<=l*_Mathmax(1,_Mathabs(A),_Mathabs($))&&_Mathabs(C-J)<=l*_Mathmax(1,_Mathabs(C),_Mathabs(J))&&_Mathabs(M-Q)<=l*_Mathmax(1,_Mathabs(M),_Mathabs(Q))&&_Mathabs(B-ee)<=l*_Mathmax(1,_Mathabs(B),_Mathabs(ee))&&_Mathabs(v-te)<=l*_Mathmax(1,_Mathabs(v),_Mathabs(te))&&_Mathabs(O-ae)<=l*_Mathmax(1,_Mathabs(O),_Mathabs(ae))}transpose(T){if(T===this){const E=T[1],_=T[2],I=T[3],R=T[6],D=T[7],P=T[11];this[1]=T[4],this[2]=T[8],this[3]=T[12],this[4]=E,this[6]=T[9],this[7]=T[13],this[8]=_,this[9]=R,this[11]=T[14],this[12]=I,this[13]=D,this[14]=P}else o(this,T[0],T[4],T[8],T[12],T[1],T[5],T[9],T[13],T[2],T[6],T[10],T[14],T[3],T[7],T[11],T[15]);return this}invert(){const[T,E,_,I,R,D,P,F,N,U,L,A,C,M,B,v]=this,O=T*D-E*R,k=T*P-_*R,X=T*F-I*R,H=E*P-_*D,G=E*F-I*D,V=_*F-I*P,W=N*M-U*C,Y=N*B-L*C,Z=N*v-A*C,q=U*B-L*M,K=U*v-A*M,$=L*v-A*B;let J=O*$-k*K+X*q+H*Z-G*Y+V*W;return J?(J=1/J,o(this,(D*$-P*K+F*q)*J,(_*K-E*$-I*q)*J,(M*V-B*G+v*H)*J,(L*G-U*V-A*H)*J,(P*Z-R*$-F*Y)*J,(T*$-_*Z+I*Y)*J,(B*X-C*V-v*k)*J,(N*V-L*X+A*k)*J,(R*K-D*Z+F*W)*J,(E*Z-T*K-I*W)*J,(C*G-M*X+v*O)*J,(U*X-N*G-A*O)*J,(D*Y-R*q-P*W)*J,(T*q-E*Y+_*W)*J,(M*k-C*H-B*O)*J,(N*H-U*k+L*O)*J),this):this}adjoint(){const[T,E,_,I,R,D,P,F,N,U,L,A,C,M,B,v]=this;return o(this,D*(L*v-A*B)-U*(P*v-F*B)+M*(P*A-F*L),-(E*(L*v-A*B)-U*(_*v-I*B)+M*(_*A-I*L)),E*(P*v-F*B)-D*(_*v-I*B)+M*(_*F-I*P),-(E*(P*A-F*L)-D*(_*A-I*L)+U*(_*F-I*P)),-(R*(L*v-A*B)-N*(P*v-F*B)+C*(P*A-F*L)),T*(L*v-A*B)-N*(_*v-I*B)+C*(_*A-I*L),-(T*(P*v-F*B)-R*(_*v-I*B)+C*(_*F-I*P)),T*(P*A-F*L)-R*(_*A-I*L)+N*(_*F-I*P),R*(U*v-A*M)-N*(D*v-F*M)+C*(D*A-F*U),-(T*(U*v-A*M)-N*(E*v-I*M)+C*(E*A-I*U)),T*(D*v-F*M)-R*(E*v-I*M)+C*(E*F-I*D),-(T*(D*A-F*U)-R*(E*A-I*U)+N*(E*F-I*D)),-(R*(U*B-L*M)-N*(D*B-P*M)+C*(D*L-P*U)),T*(U*B-L*M)-N*(E*B-_*M)+C*(E*L-_*U),-(T*(D*B-P*M)-R*(E*B-_*M)+C*(E*P-_*D)),T*(D*L-P*U)-R*(E*L-_*U)+N*(E*P-_*D)),this}determinant(){const[T,E,_,I,R,D,P,F,N,U,L,A,C,M,B,v]=this;return(T*D-E*R)*(L*v-A*B)-(T*P-_*R)*(U*v-A*M)+(T*F-I*R)*(U*B-L*M)+(E*P-_*D)*(N*v-A*C)-(E*F-I*D)*(N*B-L*C)+(_*F-I*P)*(N*M-U*C)}multiply(T){const[E,_,I,R,D,P,F,N,U,L,A,C,M,B,v,O]=this;let[k,X,H,G]=T;return this[0]=k*E+X*D+H*U+G*M,this[1]=k*_+X*P+H*L+G*B,this[2]=k*I+X*F+H*A+G*v,this[3]=k*R+X*N+H*C+G*O,k=T[4],X=T[5],H=T[6],G=T[7],this[4]=k*E+X*D+H*U+G*M,this[5]=k*_+X*P+H*L+G*B,this[6]=k*I+X*F+H*A+G*v,this[7]=k*R+X*N+H*C+G*O,k=T[8],X=T[9],H=T[10],G=T[11],this[8]=k*E+X*D+H*U+G*M,this[9]=k*_+X*P+H*L+G*B,this[10]=k*I+X*F+H*A+G*v,this[11]=k*R+X*N+H*C+G*O,k=T[12],X=T[13],H=T[14],G=T[15],this[12]=k*E+X*D+H*U+G*M,this[13]=k*_+X*P+H*L+G*B,this[14]=k*I+X*F+H*A+G*v,this[15]=k*R+X*N+H*C+G*O,this}translate([T,E,_]){return this[12]=this[0]*T+this[4]*E+this[8]*_+this[12],this[13]=this[1]*T+this[5]*E+this[9]*_+this[13],this[14]=this[2]*T+this[6]*E+this[10]*_+this[14],this[15]=this[3]*T+this[7]*E+this[11]*_+this[15],this}scale([T,E,_]){return this[0]*=T,this[1]*=T,this[2]*=T,this[3]*=T,this[4]*=E,this[5]*=E,this[6]*=E,this[7]*=E,this[8]*=_,this[9]*=_,this[10]*=_,this[11]*=_,this}rotate(T,[E,_,I]){let R=_Mathsqrt(E*E+_*_+I*I);if(_Mathabs(R)>l){R=1/R,E*=R,_*=R,I*=R;const D=_Mathsin(T),P=_Mathcos(T),F=1-P,[N,U,L,A,C,M,B,v,O,k,X,H]=this,G=E*E*F+P,V=_*E*F+I*D,W=I*E*F-_*D,Y=E*_*F-I*D,Z=_*_*F+P,q=I*_*F+E*D,K=E*I*F+_*D,$=_*I*F-E*D,J=I*I*F+P;this[0]=N*G+C*V+O*W,this[1]=U*G+M*V+k*W,this[2]=L*G+B*V+X*W,this[3]=A*G+v*V+H*W,this[4]=N*Y+C*Z+O*q,this[5]=U*Y+M*Z+k*q,this[6]=L*Y+B*Z+X*q,this[7]=A*Y+v*Z+H*q,this[8]=N*K+C*$+O*J,this[9]=U*K+M*$+k*J,this[10]=L*K+B*$+X*J,this[11]=A*K+v*$+H*J}return this}rotateX(T){const E=_Mathsin(T),_=_Mathcos(T),I=this[4],R=this[5],D=this[6],P=this[7],F=this[8],N=this[9],U=this[10],L=this[11];return this[4]=I*_+F*E,this[5]=R*_+N*E,this[6]=D*_+U*E,this[7]=P*_+L*E,this[8]=F*_-I*E,this[9]=N*_-R*E,this[10]=U*_-D*E,this[11]=L*_-P*E,this}rotateY(T){const E=_Mathsin(T),_=_Mathcos(T),[I,R,D,P]=this,F=this[8],N=this[9],U=this[10],L=this[11];return this[0]=I*_-F*E,this[1]=R*_-N*E,this[2]=D*_-U*E,this[3]=P*_-L*E,this[8]=I*E+F*_,this[9]=R*E+N*_,this[10]=D*E+U*_,this[11]=P*E+L*_,this}rotateZ(T){const E=_Mathsin(T),_=_Mathcos(T),[I,R,D,P,F,N,U,L]=this;return this[0]=I*_+F*E,this[1]=R*_+N*E,this[2]=D*_+U*E,this[3]=P*_+L*E,this[4]=F*_-I*E,this[5]=N*_-R*E,this[6]=U*_-D*E,this[7]=L*_-P*E,this}fromTranslation(T){return o(this,1,0,0,0,0,1,0,0,0,0,1,0,T[0],T[1],T[2],1),this}fromScaling(T){return o(this,T[0],0,0,0,0,T[1],0,0,0,0,T[2],0,0,0,0,1),this}fromRotation(T,[E,_,I]){let R=_Mathsqrt(E*E+_*_+I*I);if(_Mathabs(R)>l){R=1/R,E*=R,_*=R,I*=R;const D=_Mathsin(T),P=_Mathcos(T),F=1-P;o(this,E*E*F+P,_*E*F+I*D,I*E*F-_*D,0,E*_*F-I*D,_*_*F+P,I*_*F+E*D,0,E*I*F+_*D,_*I*F-E*D,I*I*F+P,0,0,0,0,1)}return this}fromXRotation(T){const E=_Mathsin(T),_=_Mathcos(T);return o(this,1,0,0,0,0,_,E,0,0,-E,_,0,0,0,0,1),this}fromYRotation(T){const E=_Mathsin(T),_=_Mathcos(T);return o(this,_,0,-E,0,0,1,0,0,E,0,_,0,0,0,0,1),this}fromZRotation(T){const E=_Mathsin(T),_=_Mathcos(T);return o(this,_,E,0,0,-E,_,0,0,0,0,1,0,0,0,0,1),this}fromQuat(T){const[E,_,I,R]=T,D=E+E,P=_+_,F=I+I,N=E*D,U=_*D,L=_*P,A=I*D,C=I*P,M=I*F,B=R*D,v=R*P,O=R*F;return o(this,1-L-M,U+O,A-v,0,U-O,1-N-M,C+B,0,A+v,C-B,1-N-L,0,0,0,0,1),this}fromRotationTranslation(T,E){const[_,I,R,D]=T,P=_+_,F=I+I,N=R+R,U=_*P,L=_*F,A=_*N,C=I*F,M=I*N,B=R*N,v=D*P,O=D*F,k=D*N;return o(this,1-(C+B),L+k,A-O,0,L-k,1-(U+B),M+v,0,A+O,M-v,1-(U+C),0,E[0],E[1],E[2],1),this}fromRotationTranslationScale(T,E,[_,I,R]){const[D,P,F,N]=T,U=D+D,L=P+P,A=F+F,C=D*U,M=D*L,B=D*A,v=P*L,O=P*A,k=F*A,X=N*U,H=N*L,G=N*A;return o(this,(1-(v+k))*_,(M+G)*_,(B-H)*_,0,(M-G)*I,(1-(C+k))*I,(O+X)*I,0,(B+H)*R,(O-X)*R,(1-(C+v))*R,0,E[0],E[1],E[2],1),this}fromRotationTranslationScaleOrigin(T,E,_,I){const[R,D,P,F]=T,N=R+R,U=D+D,L=P+P,A=R*N,C=R*U,M=R*L,B=D*U,v=D*L,O=P*L,k=F*N,X=F*U,H=F*L,[G,V,W]=_,[Y,Z,q]=I;return o(this,(1-(B+O))*G,(C+H)*G,(M-X)*G,0,(C-H)*V,(1-(A+O))*V,(v+k)*V,0,(M+X)*W,(v-k)*W,(1-(A+B))*W,0,E[0]+Y-(this[0]*Y+this[4]*Z+this[8]*q),E[1]+Z-(this[1]*Y+this[5]*Z+this[9]*q),E[2]+q-(this[2]*Y+this[6]*Z+this[10]*q),1),this}getTranslation(T=new Float32Array(3)){return T[0]=this[12],T[1]=this[13],T[2]=this[14],T}getRotation(T=new Float32Array(4)){var E=this[0]+this[5]+this[10];if(0<E){const _=2*_Mathsqrt(E+1);T[0]=(this[6]-this[9])/_,T[1]=(this[8]-this[2])/_,T[2]=(this[1]-this[4])/_,T[3]=0.25*_}else if(this[0]>this[5]&this[0]>this[10]){const _=2*_Mathsqrt(1+this[0]-this[5]-this[10]);T[0]=0.25*_,T[1]=(this[1]+this[4])/_,T[2]=(this[8]+this[2])/_,T[3]=(this[6]-this[9])/_}else if(this[5]>this[10]){const _=_Mathsqrt(1+this[5]-this[0]-this[10]);T[0]=2*((this[1]+this[4])/_),T[1]=0.25*_,T[2]=(this[6]+this[9])/_,T[3]=(this[8]-this[2])/_}else{const _=2*_Mathsqrt(1+this[10]-this[0]-this[5]);T[0]=(this[8]+this[2])/_,T[1]=(this[6]+this[9])/_,T[2]=0.25*_,T[3]=(this[1]-this[4])/_}return T}frustrum(T,E,_,I,R,D){const P=1/(E-T),F=1/(I-_),N=1/(R-D);return o(this,2*R*P,0,0,0,0,2*R*F,0,0,(E+T)*P,(I+_)*F,(D+R)*N,-1,0,0,2*(D*R)*N,0),this}perspective(T,E,_,I){const R=1/_Mathtan(T/2),D=1/(_-I);return o(this,R/E,0,0,0,0,R,0,0,0,0,(I+_)*D,-1,0,0,2*I*_*D,0),this}perspectiveFromFieldOfView(T,E,_){const I=_Mathtan(T.upDegrees*_MathPI/180),R=_Mathtan(T.downDegrees*_MathPI/180),D=_Mathtan(T.leftDegrees*_MathPI/180),P=_Mathtan(T.rightDegrees*_MathPI/180),F=2/(D+P),N=2/(I+R);return o(this,F,0,0,0,0,N,0,0,0.5*(-(D-P)*F),0.5*((I-R)*N),_/(E-_),-1,0,0,_*E/(E-_),0),this}ortho(T,E,_,I,R,D){const P=1/(T-E),F=1/(_-I),N=1/(R-D);return o(this,-2*P,0,0,0,0,-2*F,0,0,0,0,2*N,0,(T+E)*P,(I+_)*F,(D+R)*N,1),this}lookAt(T,E,_){const[I,R,D]=T,[P,F,N]=_,[U,L,A]=E;if(_Mathabs(I-U)<l&&_Mathabs(R-L)<l&&_Mathabs(D-A)<l)return this.identity();let C=I-U,M=R-L,B=D-A,v=1/_Mathsqrt(C*C+M*M+B*B);C*=v,M*=v,B*=v;let O=F*B-N*M,k=N*C-P*B,X=P*M-F*C;v=_Mathsqrt(O*O+k*k+X*X),v?(v=1/v,O*=v,k*=v,X*=v):(O=0,k=0,X=0);let H=M*X-B*k,G=B*O-C*X,V=C*k-M*O;return v=_Mathsqrt(H*H+G*G+V*V),v?(v=1/v,H*=v,G*=v,V*=v):(H=0,G=0,V=0),o(this,O,H,C,0,k,G,M,0,X,V,B,0,-(O*I+k*R+X*D),-(H*I+G*R+V*D),-(C*I+M*R+B*D),1),this}frob(){return _Mathsqrt(_Mathpow(this[0],2)+_Mathpow(this[1],2)+_Mathpow(this[2],2)+_Mathpow(this[3],2)+_Mathpow(this[4],2)+_Mathpow(this[5],2)+_Mathpow(this[6],2)+_Mathpow(this[7],2)+_Mathpow(this[8],2)+_Mathpow(this[9],2)+_Mathpow(this[10],2)+_Mathpow(this[11],2)+_Mathpow(this[12],2)+_Mathpow(this[13],2)+_Mathpow(this[14],2)+_Mathpow(this[15],2))}}d.a=m},function(n,d,u){'use strict';var o=u(1);d.a=class{constructor(m,T){this.geom=m,this.program=T,this.uniforms=[],this.globalUniforms=[],this.textures=[],this.localCalls=[],this.globalCalls=[],this.order=1,this.visible=!0,this.depthTest=!1,this._isInitialized=!1}addUniform(m){this.uniforms.push(m)}rmUniform(m){const T=this.uniforms.indexOf(m);-1<T&&this.uniforms.splice(T,1)}addGlobalUniform(m){this.globalUniforms.push(m)}rmGlobalUniform(m){const T=this.globalUniforms.indexOf(m);-1<T&&this.globalUniforms.splice(T,1)}addTexture(m){this.textures.push(m)}rmTexture(m){const T=this.textures.indexOf(m);-1<T&&this.textures.splice(T,1)}isInitialized(){let m=this._isInitialized;if(m)return m;this.program.isInitialized()||(m=!1);for(const T of this.geom.attributes)T.isInitialized()||(m=!1);for(const T of this.geom.buffers)T.isInitialized()||(m=!1);for(const T of this.textures)T.isInitialized()||(m=!1);return m}_setCalls(m){const T=this.program;for(const E of this.geom.attributes){const _=T.getAttribLocation(m,E);this.localCalls.push(E.bind.bind(E,m,_))}for(const E of this.geom.buffers)this.localCalls.push(E.bind.bind(E,m));for(const E of this.uniforms){const _=T.getUniformLocation(m,E);this.localCalls.push(E.bind.bind(E,m,_))}for(const E of this.textures){const[_,I]=T.getTextureLocationIndex(m,E);this.localCalls.push(E.bind.bind(E,m,_,I))}for(const E of this.globalUniforms){const _=T.getUniformLocation(m,E);this.globalCalls.push(E.bind.bind(E,m,_))}}_initData(m){this.program;let E=!0;for(const _ of this.geom.attributes)_.isInitialized()||_.init(m)||(E=!1);for(const _ of this.geom.buffers)_.isInitialized()||_.init(m)||(E=!1);for(const _ of this.textures)_.isInitialized()||_.init(m)||(E=!1);return E}dispose(){this._isInitialized=!1,this.localCalls.length=0}init(m){this.program;let E=!0;return this.program.isInitialized()?this.program.bind(m):!this.program.init(m)&&(E=!1),this._initData(m)||(E=!1),E&&1>this.localCalls.length&&this._setCalls(m),this._callOptimizer=o.a.getInstance(m),this._isInitialized=E,E}draw(m,T=[]){this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST));const E=this.program;if(!this._callOptimizer.optimizeProgram(E)){this.program.bind(m);for(const _ of this.globalCalls)_()}for(const _ of this.localCalls)_();for(const _ of T)_();this.geom.display(m)}}},function(n,d,u){'use strict';var o=u(7),l=u(9);class m{constructor(){this.attributes=[],this.buffers=[],this.hasIndices=!1,this.numItems=0}addVertices(T,E,_){const I=new l.a(T);I.setArray(new Float32Array(E),34962),I.setItems(5126,_),this.attributes.push(I),1>this.numItems&&(this.numItems=E.length/_)}addIndices(T){this.hasIndices=!0;const E=new o.a;E.setArray(new Uint16Array(T),34963),E.setItems(5125,1),this.buffers.push(E),this.numItems=T.length}display(T){this.hasIndices?T.drawElements(T.TRIANGLES,this.numItems,T.UNSIGNED_SHORT,0):T.drawArrays(T.TRIANGLES,0,this.numItems)}clone(T=new m){return T.attributes=this.attributes.map((E)=>E.clone()),T.buffers=this.buffers.map((E)=>E.clone()),T.hasIndices=this.hasIndices,T.numItems=this.numItems,T}}d.a=m},function(n,d){'use strict';class o{constructor(){this.pointer=null,this.gl=null,this.arrayType=34962,this.data=null,this.arrayUsage=35044}isInitialized(){return!!this.pointer}setArray(l,m=this.arrayType,T=this.arrayUsage){this.arrayType=m,this.data=l,this.arrayUsage=T;const E=this.gl;E&&(E.bindBuffer(m,this.pointer),E.bufferData(m,l,arrayUsage))}setItems(l=5126,m=3,T=null){this.itemType=l,this.itemSize=m}init(l){const m=l.createBuffer();return l.bindBuffer(this.arrayType,m),l.bufferData(this.arrayType,this.data,this.arrayUsage),this.pointer=m,this.gl=l,!0}bind(l){l.bindBuffer(this.arrayType,this.pointer)}clone(l=new o){return l.setArray(this.data,this.arrayType,this.arrayUsage),l.setItems(this.itemType,this.itemSize),l}}d.a=o},function(n,d,u){'use strict';var o=u(1);class l{constructor(m,T={antialias:!0,stencil:!0}){this.canvas=m,this.init(m,T),this.meshs=[],this.depthTest=!0,this.sortCompare=(E,_)=>{if(E.order!==_.order)return E.order-_.order;return E.program&&_.program&&E.program!==_.program?E.program.id-_.program.id:E.textures&&_.textures&&0<E.textures.length&&0<E.textures.length?E.textures[0].id-_.textures[1].id:0},this.resize(m.width,m.height)}addMesh(m){this.meshs.push(m),m.isInitialized()||m.init(this.gl,this.uniforms)}rmMesh(m){const T=this.meshs.indexOf(m);-1<T&&this.meshs.splice(T,1)}sort(){this.meshs.sort(this.sortCompare)}resize(m,T){this.width=m,this.height=T}init(m,T){let E;try{E=m.getContext('webgl',T)||m.getContext('experimental-webgl',T)}catch(_){console.error('Could not initialise WebGL:',_.message)}E||console.error('Could not initialise WebGL'),this._callOptimizer=o.a.getInstance(E),this.gl=E}set bgColor([m,T,E,_=1]){this.gl.clearColor(m,T,E,_),this._bgColor=[m,T,E,_]}get bgColor(){return this._bgColor}draw(){const m=this.gl;this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST)),m.viewport(0,0,this.width,this.height),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT|m.STENCIL_BUFFER_BIT);for(const T of this.meshs)T.visible&&(T.isInitialized()?T.draw(m):T.init(m,this.uniforms))}}d.a=l},function(n,d,u){'use strict';var o=u(7);class l extends o.a{constructor(m){super(),this.label=m}bind(m,T){super.bind(m),m.vertexAttribPointer(T,this.itemSize,this.itemType,!1,0,0)}clone(m=new l(this.label)){return m.label=this.label,super.clone(m),m}}d.a=l},function(n,d,u){'use strict';var o=u(4),l=u(0);class m extends l.a{constructor(T){super(T,35676,new o.a),this.updateNum=0,this.updated=!0,this.local=new o.a,this.parent=null}get global(){return this.update(),this._data}update(){const T=this.parent,E=null!==this.parent;if(this.updated||E&&this._parentUpdateNum!==T.updateNum){const _=this._data;E?(T.global.copy(_),_.multiply(this.local),this._parentUpdateNum=T.updateNum):this.local.copy(_),this.updateNum++,this.updated=!0}}clear(){this.local.identity(),this.updateNum++,this.updated=!0}scale(T){this.local.scale(T),this.updateNum++,this.updated=!0}translate(T){this.local.translate(T),this.updateNum++,this.updated=!0}rotate(T,E){this.local.rotate(T,E),this.updateNum++,this.updated=!0}rotateX(T){this.local.rotateX(T),this.updateNum++,this.updated=!0}rotateY(T){this.local.rotateY(T),this.updateNum++,this.updated=!0}rotateZ(T){this.local.rotateZ(T),this.updateNum++,this.updated=!0}attach(T){this.parent=T,this._parentUpdateNum=T.updateNum,this.updateNum++,this.updated=!0}detach(){this.parent=null,this.updateNum++,this.updated=!0}}d.a=m},function(n,d,u){'use strict';var o=u(4),l=u(0);class m extends l.a{constructor(){super('uPMatrix',35676,new o.a),this.fovy=45,this.near=0.1,this.far=100;const T=new o.a;this._matrix=T,this.updated=!0,this.updateNum=0,this._ratio=0,this.clear=()=>{T.identity(),this.updated=!0},this.translate=(E)=>{T.translate(E),this.updated=!0},this.scale=(E)=>{T.scale(E),this.updated=!0},this.rotate=(E,_)=>{T.rotate(E,_),this.updated=!0},this.rotateX=(E)=>{T.rotateX(E),this.updated=!0},this.rotateY=(E)=>{T.rotateY(E),this.updated=!0},this.rotateZ=(E)=>{T.rotateZ(E),this.updated=!0},this.lookAt=(E,_,I)=>{T.lookAt(E,_,I),this.updated=!0}}get data(){return this.updated&&this.update(),this._data}get ratio(){return this._ratio}set ratio(T){this._ratio=T,this.updated=!0}resize(T,E){this._ratio=T/E,this.updated=!0}update(){this._data.perspective(this.fovy*_MathPI/180,this._ratio,this.near,this.far),this._data.multiply(this._matrix),this.updated=!1,this.updateNum++}}d.a=m},function(n,d,u){'use strict';var l=u(13);class m extends l.a{constructor(T){super(T),this.srcs=[],this.setTempColor([255,255,255,255])}setTempColor(T){this.setImg(new Uint8Array(T),1,1)}addURL(T,E=0){const _={size:E,src:T,img:null,priority:0,isImage:!0,isValid:()=>!0,init:null};_.init=(I)=>{I.bindTexture(I.TEXTURE_2D,this.pointer),I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0),I.texImage2D(I.TEXTURE_2D,0,6408,this.format,I.UNSIGNED_BYTE,_.img),this.img=_.img,this.initParams(I)},this.srcs.push(_)}static START_LOAD(T,E){if(0<E.length){E.sort((I,R)=>I.size===R.size?I.size-R.size:I.priority-R.priority);E.filter((I)=>I.size>=l.a.MAX_SIZE&&I.isValid(T));if(1<E.length){const I=E[0],R=E[E.length-1];m.LOAD(I,()=>{I.init(T),m.LOAD(R,()=>{R.init(T)})})}else if(0<E.length){const I=E[0];m.LOAD(I,()=>{I.init(T)})}else console.warn('The GPU can\'nt load a texture with size > ',l.a.MAX_SIZE)}else console.warn('URL of your smart texture not found')}static LOAD(T,E){if(T.isImage){const _=new Image;_.onload=()=>{E(T)},T.img=_,_.src=T.src}else{const _=new XMLHttpRequest;_.responseType='arraybuffer',_.open('GET',T.src,!0),_.onreadystatechange=()=>{_.readyState===XMLHttpRequest.DONE&&(200===_.status?(T.img=_.response,E(T)):console.error('fail to load image ',T.src,'status:',_.status,'statuc text:',_.statusText))},_.send()}}init(T,E){const _=super.init(T,E),I=this.pointer;return m.START_LOAD(T,this.srcs),_}}d.a=m},function(n,d,u){'use strict';var o=u(1);let l=0;class m{constructor(T){this.id=l++,this.label=T,this.mipmap=!0,this.img=null,this.width=null,this.height=null,this.pointer=null,this.parameters=[],this.setType(),this.setInternalFormat(),this.setFormat(),this.setTarget()}resize(T,E,_=null){this.width=T,this.height=E,_?(_.bindTexture(this.target,this.pointer),_.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img)):this.updated=!0}setTempColor(T){this.setImg(new Uint8Array(T),1,1)}setImg(T=new Uint8Array([255,255,255,255]),E=1,_=1){this.img=T,this.width=E,this.height=_}setType(T=5121){this.type=T}setInternalFormat(T=6408){this.internalFormat=T}setFormat(T=6408){this.format=T}setTarget(T=3553){this.target=T}setParam(T,E){const _=this.parameters.find((I)=>I[0]===T);-1<_?this.parameters[_][1]=E:this.parameters.push([T,E])}isInitialized(){return!!this.pointer}static IS_POWER_OF_2(T){return 0==(T&T-1)}static SET_DATA(T){m.MAX_SIZE=T.getParameter(T.MAX_TEXTURE_SIZE),m.FORMAT={};const E=T.getParameter(T.COMPRESSED_TEXTURE_FORMATS);for(let _=0;_<E.length;_++)m.FORMAT[E[_]]=!0;m._DATA_INITIALIZED=!0}setDefaultParams(T){this.mipmap?this.setParam(T.TEXTURE_MIN_FILTER,T.LINEAR_MIPMAP_LINEAR):(this.setParam(T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),this.setParam(T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),this.setParam(T.TEXTURE_MIN_FILTER,T.LINEAR))}initParams(T){if(this.mipmap){const E=this.img;null===E?console.warn('You need an image to set the parameters of texture'):m.IS_POWER_OF_2(E.width)&&m.IS_POWER_OF_2(E.height)?T.generateMipmap(this.target):(this.mipmap=!1,console.warn('You need a power of 2 for the size of the mipmaped texture'))}1>this.parameters.length&&this.setDefaultParams(T);for(const[E,_]of this.parameters)T.texParameteri(this.target,E,_)}init(T){const E=T.createTexture();return m._DATA_INITIALIZED||m.SET_DATA(T),T.bindTexture(this.target,E),T.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.initParams(T),this._callOptimizer=o.a.getInstance(T),this.pointer=E,!0}bind(T,E,_){this._callOptimizer.optimizeTexture(this)||(T.uniform1i(E,_),T.activeTexture(T.TEXTURE0+_),T.bindTexture(this.target,this.pointer),this.updated&&(T.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.updated=!1))}free(T){T.bindTexture(T.TEXTURE_2D,null)}}d.a=m},function(n,d,u){'use strict';var o=u(5),l=u(6),m=u(0),T=u(30);class E extends o.a{constructor(_,I='aVertexPosition',R='uSample'){const D=new l.a;D.addVertices(I,[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1],2),super(D,_)}resize(_,I){this.uWidth&&(this.uWidth.data=_),this.uHeight&&(this.uHeight.data=I)}useUWidth(_,I){const R=new m.a(_,5124,I);this.uWidth=R,this.addUniform(R)}useUHeight(_,I){const R=new m.a(_,5124,I);this.uHeight=R,this.addUniform(R)}useColorTexture(_){const I=new T.a(_);this.inColorTexture=I,this.addTexture(I)}useDepthTexture(_,I){const R=new T.a(_);this.inDepthTexture=R,this.addTexture(R);const D=new m.a(I,5124,1);this._inDetpthEnableUniform=D,this.addUniform(D)}setDepthTexture(_,I){this.rmTexture(this.inDepthTexture),_&&this.addTexture(this.inDepthTexture),this._inDetpthEnableUniform.data=_?1:0;const R=this.globalUniforms;this.dispose(),this.init(I,R)}}d.a=E},function(n,d){'use strict';function o(T,E,_,I,R,D,P,F,N,U){T[0]=E,T[1]=_,T[2]=I,T[3]=R,T[4]=D,T[5]=P,T[6]=F,T[7]=N,T[8]=U}const l=1e-6;class m extends Float32Array{constructor(){super(9),this[0]=1,this[4]=1,this[8]=1}fromMarix4(T){this.setMat(this,T[0],T[1],T[2],T[3],T[4],T[5],T[6],T[7],T[8])}clone(){const T=new m;return T.set(this),T}copy(T){return T.set(this),this}identity(){return o(this,1,0,0,0,1,0,0,0,1),this}add(T){return this[0]+=T[0],this[1]+=T[1],this[2]+=T[2],this[3]+=T[3],this[4]+=T[4],this[5]+=T[5],this[6]+=T[6],this[7]+=T[7],this[8]+=T[8],this}subtract(T){return this[0]-=T[0],this[1]-=T[1],this[2]-=T[2],this[3]-=T[3],this[4]-=T[4],this[5]-=T[5],this[6]-=T[6],this[7]-=T[7],this[8]-=T[8],this}multiplyScalar(T){return this[0]*=T,this[1]*=T,this[2]*=T,this[3]*=T,this[4]*=T,this[5]*=T,this[6]*=T,this[7]*=T,this[8]*=T,this}multiplyScalarAndAdd(T,E){return this[0]+=T[0]*E,this[1]+=T[1]*E,this[2]+=T[2]*E,this[3]+=T[3]*E,this[4]+=T[4]*E,this[5]+=T[5]*E,this[6]+=T[6]*E,this[7]+=T[7]*E,this[8]+=T[8]*E,this}exactEquals(T){return this[0]===T[0]&&this[1]===T[1]&&this[2]===T[2]&&this[3]===T[3]&&this[4]===T[4]&&this[5]===T[5]&&this[6]===T[6]&&this[7]===T[7]&&this[8]===T[8]}equals(T){const[E,_,I,R,D,P,F,N,U]=this,[L,A,C,M,B,v,O,k,X]=T;return _Mathabs(E-L)<=l*_Mathmax(1,_Mathabs(E),_Mathabs(L))&&_Mathabs(_-A)<=l*_Mathmax(1,_Mathabs(_),_Mathabs(A))&&_Mathabs(I-C)<=l*_Mathmax(1,_Mathabs(I),_Mathabs(C))&&_Mathabs(R-M)<=l*_Mathmax(1,_Mathabs(R),_Mathabs(M))&&_Mathabs(D-B)<=l*_Mathmax(1,_Mathabs(D),_Mathabs(B))&&_Mathabs(P-v)<=l*_Mathmax(1,_Mathabs(P),_Mathabs(v))&&_Mathabs(F-O)<=l*_Mathmax(1,_Mathabs(F),_Mathabs(O))&&_Mathabs(N-k)<=l*_Mathmax(1,_Mathabs(N),_Mathabs(k))&&_Mathabs(U-X)<=l*_Mathmax(1,_Mathabs(U),_Mathabs(X))}transpose(T){if(T===this){const E=T[1],_=T[2],I=T[5];this[1]=T[3],this[2]=T[6],this[3]=E,this[5]=T[7],this[6]=_,this[7]=I}else o(this,T[0],T[4],T[6],T[1],T[4],T[5],T[2],T[7],T[8]);return this}invert(){const[T,E,_,I,R,D,P,F,N]=this,L=D*P-N*I,A=P*R-F*I;let C=T*b01+E*L+_*A;return C?(C=1/C,o(this,b01*C,(-N*E+_*F)*C,(D*E-_*R)*C,L*C,(N*T-_*P)*C,(-D*T+_*I)*C,A*C,(-F*T+E*P)*C,(R*T-E*I)*C),this):this}adjoint(){const[T,E,_,I,R,D,P,F,N]=this;return o(this,R*N-D*F,_*F-E*N,E*D-_*R,D*P-I*N,T*N-_*P,_*I-T*D,I*F-R*P,E*P-T*F,T*R-E*I),this}determinant(){const[T,E,_,I,R,D,P,F,N]=this;return T*(N*R-D*F)+E*(-N*I+D*P)+_*(F*I-R*P)}multiply(T){const[E,_,I,R,D,P,F,N,U]=this;let[L,A,C,M,B,v,O,k,X]=T;return o(this,L*E+A*R+C*F,L*_+A*D+C*N,L*I+A*P+C*U,M*E+B*R+v*F,M*_+B*D+v*N,M*I+B*P+v*U,O*E+k*R+X*F,O*_+k*D+X*N,O*I+k*P+X*U),this}translate([T,E]){const[_,I,R,D,P,F,N,U,L]=this;return this[6]=T*_+E*D+N,this[7]=T*I+E*P+U,this[8]=T*R+E*F+L,this}rotate(T){const[E,_,I,R,D,P,F,N,U]=this,L=_Mathsin(T),A=_Mathcos(T);return this[0]=A*E+80*R,this[1]=A*a080801+L*D,this[2]=A*I+L*P,this[3]=A*R-L*E,this[4]=A*D-L*_,this[5]=A*P-L*I,this}scale([T,E]){return this[0]*=T,this[1]*=T,this[2]*=T,this[3]*=E,this[4]*=E,this[5]*=E,this}fromTranslation(T){return o(this,1,0,0,0,1,0,T[0],T[1],1),this}fromScaling(T){return o(this,T[0],0,0,0,T[1],0,0,0,1),this}fromMatrix2(T){return o(this,T[0],T[1],0,T[2],T[3],0,T[4],T[5],1),out}fromQuat(T){const[E,_,I,R]=T,D=E+E,P=_+_,F=I+I,N=E*D,U=_*D,L=_*P,A=I*D,C=I*P,M=I*F,B=R*D,v=R*P,O=R*F;return o(this,1-L-M,U-O,A+v,U+O,1-N-M,C-B,A-v,C+B,1-N-L),this}normalFromMatrix4(){const[E,_,I,R,D,P,F,N,U,L,A,C,M,B,v,O]=this,k=E*P-_*D,X=E*F-I*D,H=E*N-R*D,G=_*F-I*P,V=_*N-R*P,W=I*N-R*F,Y=U*B-L*M,Z=U*v-A*M,q=U*O-C*M,K=L*v-A*B,$=L*O-C*B,J=A*O-C*v;let Q=k*J-X*$+H*K+G*q-V*Z+W*Y;return Q?(Q=1/Q,o(this,(P*J-F*$+N*K)*Q,(F*q-D*J-N*Z)*Q,(D*$-P*q+N*Y)*Q,(I*$-_*J-R*K)*Q,(E*J-I*q+R*Z)*Q,(_*q-E*$-R*Y)*Q,(B*W-v*V+O*G)*Q,(v*H-M*W-O*X)*Q,(M*V-B*H+O*k)*Q),this):null}frob(){return _Mathsqrt(_Mathpow(this[0],2)+_Mathpow(this[1],2)+_Mathpow(this[2],2)+_Mathpow(this[3],2)+_Mathpow(this[4],2)+_Mathpow(this[5],2)+_Mathpow(this[6],2)+_Mathpow(this[7],2)+_Mathpow(this[8],2))}}d.a=m},,function(n,d,u){'use strict';var o=u(3);class l extends o.a{constructor(m,T){super(m,T),this.depthTest=!1,this.order=-1}}d.a=l},function(n,d,u){'use strict';var o=u(1);d.a=class{constructor(){this.meshs=[],this.order=0,this.visible=!0,this.mask=null,this._isInitialized=!1,this.sortCompare=(m,T)=>{if(m.order!==T.order)return m.order-T.order;return m.program&&T.program&&m.program!==T.program?m.program.id-T.program.id:m.textures&&T.textures&&0<m.textures.length&&0<m.textures.length?m.textures[0].id-T.textures[1].id:0}}setMask(m){this.mask=m}addMesh(m){this.meshs.push(m)}rmMesh(){const m=this.meshs.indexOf(mesh);-1<m&&this.meshs.splice(m,1)}sort(){this.meshs.sort(this.sortCompare)}isInitialized(){if(null!==this.mask&&!this.mask.isInitialized())return!1;for(const m of this.meshs)if(!m.isInitialized())return!1;return!0}dispose(){for(const m of this.meshs)m.dispose();return!0}init(m){let T=!0;null!==this.mask&&this.mask.init(m);for(const E of this.meshs)E.init(m)||(T=!1);return this._callOptimizer=o.a.getInstance(m),T}draw(m,T=[]){this.mask&&this.mask.before(m);for(const E of this.meshs)E.draw(m,T);this.mask&&this.mask.after(m)}}},function(n,d,u){'use strict';var o=u(1);d.a=class{constructor(m){this.mesh=m,this.setMaskFunc(519,1,255),this.setDisplayFunc(517,0,255)}setMaskFunc(m,T,E){this.maskFunc=m,this.maskRef=T,this.maskMask=E}setDisplayFunc(m,T,E){this.displayFunc=m,this.displayRef=T,this.displayMask=E}isInitialized(){return this.mesh.isInitialized()}init(m){this.mesh.init(m),this._callOptimizer=o.a.getInstance(m)}before(m,T=[]){m.enable(m.STENCIL_TEST),m.depthMask(!1),m.clear(m.STENCIL_BUFFER_BIT),m.colorMask(!1,!1,!1,!1),m.stencilOp(m.KEEP,m.KEEP,m.INCR),m.stencilFunc(this.maskFunc,this.maskRef,this.maskMask),this.mesh.draw(m,T),this._callOptimizer.optimizeProgram(null),m.stencilFunc(this.displayFunc,this.displayRef,this.displayMask),m.depthMask(!0),m.colorMask(!0,!0,!0,!0),m.stencilOp(m.KEEP,m.KEEP,m.KEEP)}after(m){m.disable(m.STENCIL_TEST)}}},function(n,d,u){'use strict';var o=u(5),l=u(31);class m extends o.a{constructor(T,E){super(T,E),this.depthTest=!1;const _=new l.a('uMVMatrix');this.transform=_,this.addUniform(_)}get position(){return this.transform.getTranslation()}get rotation(){return this.transform.getRotation()}draw(T,E=[]){this.transform&&this.transform.update(),super.draw(T,E)}}d.a=m},function(n,d,u){'use strict';var o=u(4),l=u(0);const m=new Float32Array(3);class T extends l.a{constructor(E,_,I=1){super(E,35676,new o.a),this.camera3D=_,this.updateNum=-1,this.distance=I}get data(){return this.updateNum!==this.camera3D.updateNum&&this.update(),this._data}update(){const E=this.camera3D,_=E._matrix;_.getTranslation(m),m[0]=-m[0]*this.distance,m[1]=-m[1]*this.distance,m[2]=-m[2]*this.distance,this._data.perspective(E.fovy*_MathPI/180,E.ratio,E.near,E.far),this._data.translate(m),this._data.multiply(_),this.updateNum=this.camera3D.updateNum}}d.a=T},function(n,d,u){'use strict';var o=u(15),l=u(0);class m extends l.a{constructor(){super('uPMatrix',35675,new o.a),this._matrix=new o.a,this.updated=!0,this.updateNum=0,this._minX=-1,this._maxX=1,this._minY=-1,this._maxY=1,this.clear=()=>{matrix.identity(),this.updated=!0},this.translate=(T)=>{matrix.translate(T),this.updated=!0},this.scale=(T)=>{matrix.scale(T),this.updated=!0},this.rotate=(T)=>{matrix.rotate(T),this.updated=!0}}get data(){return this.updated&&this.update(),this._data}setArea(T,E,_,I){this._minX=T,this._minY=E,this._maxX=_,this._maxY=I,this.updated=!0}update(){this._data.identity();const T=this._maxX-this._minX,E=this._maxY-this._minY;this._data.scale([1/T,1/E]),this._data.multiply(this._matrix),this.updated=!1,this.updateNum++}}d.a=m},function(n,d,u){'use strict';var o=u(34);d.a=class{constructor(m){this.screenRecorder=new o.a(m.width,m.height,!0,!0),this.scene=m,this.passList=[],this.isEnable=!1,this.init(m.gl)}isInitialized(){return this.screenRecorder.isInitialized()}resize(m,T){this.scene.resize(m,T),this.screenRecorder.resize(m,T,this.scene.gl);for(const E of this.passList)E.resize(m,T)}_disableDepthInTexture(m,T){m.inDepthTexture&&m.setDepthTexture(!1,T)}init(m){if(this.screenRecorder.init(m),!this.screenRecorder.depthTexture)for(const T of this.passList)this._disableDepthInTexture(T,m);return!0}addPass(m){m.init(this.scene.gl,[]),this.screenRecorder.isInitialized()&&!this.screenRecorder.depthTexture&&this._disableDepthInTexture(m,this.scene.gl),m.uWidth&&(m.uWidth.data=this.scene.width),m.uHeight&&(m.uHeight.data=this.scene.height),this.passList.push(m),this.isEnable=!0}removePass(m){const T=this.passList.indexOf(m);-1<T&&this.passList.splice(T,1),this.isEnable=0<this.passList.length}draw(){const m=this.scene.gl,T=this.passList.length;if(0<T){this.screenRecorder.start(m,!0),this.scene.draw(),this.screenRecorder.stop(m),this.screenRecorder.pingpong();for(let E=0;E<T;E++){const _=this.passList[E],I=E>T-2;I||this.screenRecorder.start(m,!1),this.screenRecorder.pingpong(),_.inColorTexture&&_.inColorTexture.setTexture(this.screenRecorder.colorTexture),_.inDepthTexture&&this.screenRecorder.depthTexture&&_.inDepthTexture.setTexture(this.screenRecorder.depthTexture),_.draw(m),this.screenRecorder.stop(m)}}else this.scene.draw()}}},function(n,d,u){'use strict';function o(R){return _NumberisInteger(R)?R.toFixed(1):R}var l=u(14),m=u(2),T=u(0);const E=`
    attribute vec3 aVertexPosition;
    varying vec2 vTextureCoord;

    void main(void)
    {
        vTextureCoord = vec2(aVertexPosition.x * 0.5 + 0.5, aVertexPosition.y * 0.5 + 0.5);
        gl_Position = vec4(aVertexPosition, 1.0);
    }`,_=`
    precision mediump float;
    varying vec2 vTextureCoord;
    uniform sampler2D uColor;
    uniform sampler2D uDepth;

    uniform vec3 uColorFog;
    
    uniform int uDepthEnable;

    void main(void)
    {
        $chunkcall
        gl_FragColor = color;
    }`;class I extends l.a{constructor({minDepth:R=0.1,maxDepth:D=0.2,minPower:P=0.2,maxPower:F=1,depthCurve:N=100,color:U=[1,1,1]}){super(null,'aVertexPosition','uColor'),this.useColorTexture('uColor'),this.useDepthTexture('uDepth','uDepthEnable');const L=new T.a('uColorFog',35665,U);this.addUniform(L);const A=this._initFragmentShader(R,D,P,F,N);this.program=new m.a(E,A)}_initFragmentShader(R,D,P,F,N){let U=`
            float depthValue = 0.0;
            if (uDepthEnable >= 0) {
                vec4 depth = texture2D(uDepth, vTextureCoord.xy);
                depthValue = pow(depth.x, ${o(N)});
                depthValue = (depthValue - ${o(R)}) / ${o(D-R)};
                depthValue = clamp(depthValue, ${o(P)}, ${o(F)});
            }
            vec4 originalColor = texture2D(uColor, vTextureCoord.xy); 
            vec4 color = vec4(mix(originalColor.xyz, uColorFog, depthValue), originalColor.w);
        `;const L=_.replace('$chunkcall',U);return L}}d.a=I},function(n,d,u){'use strict';function o(R){return _NumberisInteger(R)?R.toFixed(1):R}var l=u(14),m=u(2),T=u(0);const E=`
    attribute vec3 aVertexPosition;
    varying vec2 vTextureCoord;

    void main(void)
    {
        vTextureCoord = vec2(aVertexPosition.x * 0.5 + 0.5, aVertexPosition.y * 0.5 + 0.5);
        gl_Position = vec4(aVertexPosition, 1.0);
    }`,_=`
    precision mediump float;
    varying vec2 vTextureCoord;
    uniform sampler2D uColor;
    uniform sampler2D uDepth;
    uniform int uSize;
    uniform int uDepthEnable;

    $chunkfct

    void main(void)
    {
        $chunkcall
        gl_FragColor = color;
    }`;class I extends l.a{constructor({minDepth:R=0.1,maxDepth:D=0.2,samples:P=5,xBlur:F=!0,power:N=1,depthCurve:U=100}){super(null,'aVertexPosition','uColor'),this.power=N,this.xBlur=F,this.depthCurve=U,this.useColorTexture('uColor'),this.useDepthTexture('uDepth','uDepthEnable');const L=this._initFragmentShader(R,D,P);this.program=new m.a(E,L),F?this.useUWidth('uSize',1):this.useUHeight('uSize',1)}_initFragmentShader(R=0.1,D=0.3,P=5){const F=this.xBlur,N=o(this.power),U=[];for(let M=0;M<P;M++){const B=this._getKernels(M+1);U.push(B)}let L='';for(let M=0;M<U.length;M++){const B=U[M];L+=`
            vec4 blur${M+1}(sampler2D i, vec2 uv) {
                vec2 m;
                vec4 color = texture2D(i, uv) * ${o(B[0])};`;for(let v=1;v<B.length;v++)L+=`
                m = ${F?'vec2('+v+'.0 * '+N+' / float(uSize), 0.0)':'vec2(0.0, '+v+'.0 * '+N+' / float(uSize))'};
                color += texture2D(i, uv + m) * ${o(B[v])};
                color += texture2D(i, uv - m) * ${o(B[v])};`;L+='return color; }'}let A=`
            float depthValue = 0.0;
            vec4 color;
            if (uDepthEnable >= 0) {
                vec4 depth = texture2D(uDepth, vTextureCoord.xy);
                depthValue = pow(depth.x, ${o(this.depthCurve)});
                
                int blurPower = int(floor(0.5 + (depthValue - ${o(R)}) * ${o(P)} / ${o(D-R)}));   
        `;for(let M=0;M<P;M++){const B='blurPower'+(M>P-2?' >= '+M:1>M?' < 1':' == '+M);A+=`${0<M?' else if':'if'} ( ${B}) {
                color = blur${M+1}(uColor, vTextureCoord.xy);
            }`}A+=`
        } else {
            color = texture2D(uColor, vTextureCoord.xy);
        }
        `;const C=_.replace('$chunkfct',L).replace('$chunkcall',A);return C}_getKernels(R){const D=[];let P=0;for(let F=1;F<R+2;F++){const N=3*(F-1)/R,U=Math.exp(-N*N);P+=2>F?U:U+U,D.push(U)}for(let F=0;F<D.length;F++)D[F]/=P;return D}}d.a=I},,function(n,d,u){'use strict';function o(He=null){let Ge=0;He&&(He.wheelDelta?Ge=He.wheelDelta:He.detail?Ge=-40*He.detail:He.deltaY&&(Ge=-40*He.deltaY)),Oe-=Ge/1e3,Oe=_Mathmin(_Mathmax(Oe,0.37),3),Z.fovy=45*Oe}function m(He){const Ge=He.clientX,Ve=He.clientY,We=(Ge-Xe[0])/ke[0],Ye=(Ve-Xe[1])/ke[1];Xe[0]=Ge,Xe[1]=Ve,Be+=2*(We*_MathPI),ve+=Ye*_MathPI,ve=_Mathmax(_Mathmin(ve,0.3*_MathPI),0.3*-_MathPI)}function T(){const Ge=document.body;Ge.removeEventListener('mousemove',m),Ge.removeEventListener('mouseup',T),Ge.removeEventListener('mouseleave',T),Ge.classList.remove('is-grabbing')}function E(){const He=1;ke[0]=window.innerWidth,ke[1]=window.innerHeight,ze.resize(ke[0]*He,ke[1]*He),Y.width=ke[0]*He,Y.height=ke[1]*He,Z.resize(...ke),q.setArea(0,0,...ke)}function _(){Z.clear(),Z.translate([0,0,-Oe]),Z.rotate(ve,[1,0,0]),Z.rotate(Be,[0,1,0]),se.transform.rotateY(5e-3),Ee.transform.rotate(-5e-3,[0,1,0]),xe.transform.rotate(0.01,[0,1,0]),Ne.transform.rotate(-0.01,[0,1,0]),Ue.transform.rotate(0.025,[0.72,-0.33,0.5]),ze.draw(),requestAnimationFrame(_)}Object.defineProperty(d,'__esModule',{value:!0});var I=u(0),R=u(10),D=u(21),P=u(9),F=u(2),N=u(6),U=u(12),L=u(5),A=u(20),C=u(3),M=u(18),B=u(19),v=u(17),O=u(22),k=u(11),X=u(8),H=u(14),G=u(23),V=u(25),W=u(24);const Y=document.body.querySelector('canvas'),Z=new k.a,q=new O.a,K=new X.a(Y);K.bgColor=[0,0,0.1,1],K.depthTest=!0;const $=`      
    attribute vec3 aVertexPosition;
    attribute vec4 aVertexColor;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec4 vColor;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vColor = aVertexColor;
    }
`,J=`
    precision mediump float;

    varying vec4 vColor;

    void main(void) {
        gl_FragColor = vColor;
    }
`,Q=new F.a($,J),ee=`
    attribute vec3 aVertexPosition;
    attribute vec4 aVertexColor;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec4 vColor;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        float zDepth = 0.2 * (8.0 - gl_Position.z);
        vec4 modifyColor = vec4(aVertexColor.rgb * zDepth, aVertexColor.a);
        vColor = modifyColor;
    }
`,te=new F.a(ee,J),ie=new N.a;ie.addVertices('aVertexPosition',[0,1,0,-1,-1,1,1,-1,1,0,1,0,1,-1,1,1,-1,-1,0,1,0,1,-1,-1,-1,-1,-1,0,1,0,-1,-1,-1,-1,-1,1],3),ie.addVertices('aVertexColor',[1,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,1,1,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,1],4);const se=new C.a(ie,Q);se.transform.translate([-1.5,-1.5,0]),se.addGlobalUniform(Z);const ne=`      
    attribute vec2 aVertexPosition;

    uniform mat3 uMVMatrix;
    uniform mat3 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {
        vec3 pos = uPMatrix * uMVMatrix * vec3(aVertexPosition, 0.0);
        gl_Position = vec4(pos.xy, 0.0, 1.0);
    }
`,de=`
    precision mediump float;

    uniform sampler2D uDiffuse1;

    void main(void) {
        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);
    }
`,ue=new F.a(ne,de),pe=new N.a;pe.addVertices('aVertexPosition',[-1,-1,-1,1,1,-1,-1,1,1,1,1,-1],2);const me=new A.a(pe,ue);me.order=1,me.transform.scale([320,320]),me.addGlobalUniform(q);const fe=new M.a;fe.addMesh(se),K.addMesh(fe),fe.setMask(new B.a(me));const he=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],ce=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],ge=[[1,0,0,1],[1,1,0,1],[0,1,0,1],[1,0.5,0.5,1],[1,0,1,1],[0,0,1,1]];let be=[];for(let He in ge)for(let Ge=0;4>Ge;Ge++)be=be.concat(ge[He]);const Te=new N.a;Te.addVertices('aVertexPosition',he,3),Te.addVertices('aVertexColor',be,4),Te.addIndices(ce);const xe=new C.a(Te,te);xe.transform.translate([1.5,-1.5,0]),xe.addGlobalUniform(Z),K.addMesh(xe);const Ee=new C.a(ie,Q);Ee.transform.translate([-1.5,1.5,0]),Ee.transform.scale([1,-1,1]),Ee.addGlobalUniform(Z),K.addMesh(Ee);const _e=`   
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vTextureCoord = aTextureCoord;
    }`,Ie=`
    precision mediump float;

    varying vec2 vTextureCoord;

    uniform sampler2D uDiffuse1;
    uniform sampler2D uDiffuse2;

    void main(void) {
        vec4 color1 = texture2D(uDiffuse1, vec2(vTextureCoord.s, vTextureCoord.t));
        vec4 color2 = texture2D(uDiffuse2, vec2(vTextureCoord.s, vTextureCoord.t));
        float power = ((sin(vTextureCoord.s * 3.1415)) * (sin(vTextureCoord.t * 3.1415)));
        gl_FragColor = mix(color1, color2, power);
    }`,Re=new F.a(_e,Ie);const Pe=new U.a('uDiffuse1');Pe.addURL('assets/cube-diffuse.jpg');const we=new U.a('uDiffuse2');we.setParam(10240,9728),we.setParam(10241,9728),we.addURL('assets/cube-diffuse-2.png');const Fe=new N.a;Fe.addVertices('aVertexPosition',he,3),Fe.addVertices('aTextureCoord',[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1],2),Fe.addIndices(ce);const Ne=new C.a(Fe,Re);Ne.addTexture(Pe),Ne.addTexture(we),Ne.transform.translate([1.5,1.5,0]),Ne.addGlobalUniform(Z),K.addMesh(Ne);const Ue=new C.a(Fe,Re);Ue.addTexture(Pe),Ue.addTexture(we),Ue.transform.translate([0,0,-8]),Ue.addGlobalUniform(Z),K.addMesh(Ue);const ye=`   
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {

        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vTextureCoord = aTextureCoord;
    }`,Le=`
    precision mediump float;

    varying vec2 vTextureCoord;

    uniform sampler2D uDiffuse1;

    void main(void) {
        vec4 color1 = texture2D(uDiffuse1, vec2(vTextureCoord.s, vTextureCoord.t));
        gl_FragColor = color1;
    }`,Ae=new D.a('uPMatrix',Z,1),Se=new F.a(ye,Le),Ce=new v.a(Fe,Se);Ce.addTexture(Pe),Ce.addUniform(Ae),K.addMesh(Ce),K.sort();const Me=!0;let ze;{ze=new G.a(K);const He=new W.a({minDepth:0.5,maxDepth:0.6,minPower:0,maxPower:0.5,depthCurve:100,color:[0.9,0.95,1]});ze.addPass(He);const Ge={minDepth:0.95,maxDepth:1,samples:20,xBlur:!0,power:1,depthCurve:1},Ve=new V.a(Ge);ze.addPass(Ve),Ge.xBlur=!1;const We=new V.a(Ge);ze.addPass(We)}let Be=0,ve=0,Oe=2.5;const ke=[0,0],Xe=[0,0];document.body.addEventListener('mousedown',function(He){const Ge=document.body;Xe[0]=He.clientX,Xe[1]=He.clientY,Ge.removeEventListener('mousemove',m),Ge.removeEventListener('mouseup',T),Ge.removeEventListener('mouseleave',T),Ge.addEventListener('mousemove',m),Ge.addEventListener('mouseup',T),Ge.addEventListener('mouseleave',T),Ge.classList.add('is-grabbing')}),window.addEventListener('wheel',o),window.onresize=E,E(),o(),window.scene=K,window.passManager=ze,_()},,,function(n,d){'use strict';d.a=class{constructor(l){this.label=l}isInitialized(){return!0}init(){return!0}setTexture(l){this.pointer=l.pointer,this.target=l.target}bind(l,m,T){l.uniform1i(m,T),l.activeTexture(l.TEXTURE0+T),l.bindTexture(this.target,this.pointer)}}},function(n,d,u){'use strict';var o=u(15),l=u(0);class m extends l.a{constructor(T){super(T,35675,new o.a),this.updateNum=0,this.updated=!0,this.local=new o.a,this.parent=null}get global(){return this.update(),this._data}update(){const T=this.parent,E=null!==this.parent;if(this.updated||E&&this._parentUpdateNum!==T.updateNum){const _=this._data;E?(T.global.copy(_),_.multiply(this.local),this._parentUpdateNum=T.updateNum):this.local.copy(this._data),this.updateNum++,this.updated=!0}}clear(){this.local.identity(),this.updateNum++,this.updated=!0}scale(T){this.local.scale(T),this.updateNum++,this.updated=!0}translate(T){this.local.translate(T),this.updateNum++,this.updated=!0}rotate(T){this.local.rotate(T),this.updateNum++,this.updated=!0}attach(T){this.parent=T,this._parentUpdateNum=T.updateNum,this.updateNum++,this.updated=!0}detach(){this.parent=null,this.updateNum++,this.updated=!0}}d.a=m},function(n,d){'use strict';d.a=class{constructor(){this.pointer=null}isInitialized(){return!!this.pointer}init(l){const m=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,m),this.pointer=m,!0}bind(l){l.bindFramebuffer(l.FRAMEBUFFER,this.pointer)}free(l){l.bindFramebuffer(l.FRAMEBUFFER,null)}}},function(n,d){'use strict';d.a=class{constructor(l,m){this.pointer=null,this.width=l,this.height=m}resize(l,m,T=null){this.width=l,this.height=m,T?(T.bindRenderbuffer(T.RENDERBUFFER,this.pointer),T.renderbufferStorage(T.RENDERBUFFER,T.DEPTH_COMPONENT16,l,m)):this.updated=!0}isInitialized(){return!!this.pointer}init(l){const m=l.createRenderbuffer();l.bindRenderbuffer(l.RENDERBUFFER,m),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,this.width,this.height),this.pointer=m}bind(l){l.bindRenderbuffer(l.RENDERBUFFER,renderBuffer),this.updated&&(l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,this.width,this.height),this.updated=!1)}}},function(n,d,u){'use strict';var o=u(13),l=u(33),m=u(32);class T{constructor(E,_,I=!0,R=!1){this.captureDepth=I,this.recordDepth=R,this.width=E,this.height=_,this.updated=!1,this._pingpong=!1,this._colorTextures=[this._genColorTexture('frameBufferColor0',E,_),this._genColorTexture('frameBufferColor1',E,_)],this.frameBuffer=new m.a}_genDepthTexture(E,_,I){const R=new o.a;return R.mipmap=!1,R.setInternalFormat(6402),R.setFormat(6402),R.setType(5123),R.setParam(10242,33071),R.setParam(10243,33071),R.setParam(10241,9728),R.setParam(10240,9728),R.setImg(null,_,I),R}_genColorTexture(E,_,I){const R=new o.a(E);return R.mipmap=!1,!1,R.setImg(null,_,I),R}pingpong(){this._pingpong=!this._pingpong}get colorTexture(){return this._colorTextures[this._pingpong?1:0]}resize(E,_,I){this.width=E,this.height=_,this.pingpong(),this.colorTexture.resize(E,_,I),this.pingpong(),this.colorTexture.resize(E,_,I),this.depthTexture&&this.depthTexture.resize(E,_,I),this.renderBuffer&&this.renderBuffer.resize(E,_,I)}isInitialized(){return!!this.frameBuffer.pointer}static SET_DATA(E){T.WEBGL_depth_texture=E.getExtension('WEBGL_depth_texture')||E.getExtension('WEBKIT_WEBGL_depth_texture')||E.getExtension('MOZ_WEBGL_depth_texture'),T._DATA_INITIALIZED=!0}init(E){return T._DATA_INITIALIZED||T.SET_DATA(E),this.recordDepth&&(T.WEBGL_depth_texture?(this.depthTexture=this._genDepthTexture('frameBufferDepth',this.width,this.height),this.depthTexture.init(E)):(console.warn('WEBGL_depth_texture Extension not available!'),this.recordDepth=!1)),this.captureDepth&&(this.renderBuffer=new l.a(this.width,this.height),this.renderBuffer.init(E)),this.frameBuffer.init(E),this.pingpong(),this.colorTexture.init(E),this.pingpong(),this.colorTexture.init(E),this.depthTexture?E.framebufferTexture2D(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,E.TEXTURE_2D,this.depthTexture.pointer,0):this.renderBuffer&&E.framebufferRenderbuffer(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,E.RENDERBUFFER,this.renderBuffer.pointer),E.bindTexture(E.TEXTURE_2D,null),E.bindFramebuffer(E.FRAMEBUFFER,null),E.bindRenderbuffer(E.RENDERBUFFER,null),!0}start(E,_=!0){this.frameBuffer.bind(E),E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,this.colorTexture.pointer,0),this.depthTexture?E.framebufferTexture2D(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,E.TEXTURE_2D,_?this.depthTexture.pointer:null,0):this.renderBuffer&&E.framebufferRenderbuffer(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,E.RENDERBUFFER,_?this.renderBuffer.pointer:null)}stop(E){this.frameBuffer.free(E)}}d.a=T}]);