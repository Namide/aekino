var _Mathmin=Math.min,_NumberisInteger=Number.isInteger,_Mathpow=Math.pow,_MathPI=Math.PI,_Mathtan=Math.tan,_Mathcos=Math.cos,_Mathsin=Math.sin,_Mathsqrt=Math.sqrt,_Mathmax=Math.max,_Mathabs=Math.abs;(function(d){function n(o){if(u[o])return u[o].exports;var l=u[o]={i:o,l:!1,exports:{}};return d[o].call(l.exports,l,l.exports,n),l.l=!0,l.exports}var u={};return n.m=d,n.c=u,n.i=function(o){return o},n.d=function(o,l,m){n.o(o,l)||Object.defineProperty(o,l,{configurable:!1,enumerable:!0,get:m})},n.n=function(o){var l=o&&o.__esModule?function(){return o['default']}:function(){return o};return n.d(l,'a',l),l},n.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},n.p='',n(n.s=31)})([function(d,n){'use strict';class o{constructor(l,m,h,T=!1){this.label=l,this.type=m,this._data=h,this._init(m,T),this.updated=!0}get data(){return this._data}set data(l){this._data=l,this.updated=!0}_init(l){switch(this.type){case 35675:{this.bind=(h,T)=>{h.uniformMatrix3fv(T,!1,this.data)};break}case 35676:{this.bind=(h,T)=>{h.uniformMatrix4fv(T,!1,this.data)};break}case 35664:{this.bind=(h,T)=>{h.uniform2f(T,...this.data)};break}case 35665:{this.bind=(h,T)=>{h.uniform3f(T,...this.data)};break}case 5124:this.bind=(h,T)=>{h.uniform1i(T,this.data)};break;case-1:this.bind=(h,T)=>{h.uniform1fv(T,this.data)};break;default:console.error('Uniform type unknow: {label:',this.label,', type:',l,'}');}}}n.a=o},function(d,n){'use strict';class o{constructor(){this.lastTexture=null,this.lastProgram=null,this.lastDepthTest=!1}optimizeTexture(l){const m=this.lastTexture;return this.lastTexture=l,l===m}optimizeProgram(l){const m=this.lastProgram;return this.lastProgram=l,l===m}optimizeDepthTest(l){const m=this.lastDepthTest;return this.lastDepthTest=l,m===l}static getInstance(l){const m=o.glList.indexOf(l);if(0>m){const h=new o;return o.glList.push(l),o.list.push(h),h}return o.list[m]}}o.glList=[],o.list=[],n.a=o},function(d,n){'use strict';let o=0;n.a=class{constructor(m,h){this.vertexShaderSrc=m,this.fragmentShaderSrc=h,this.attribLocation={},this.uniformLocation={},this.textureLocation={},this.textureIndex={},this.textureNum=0,this.id=o++}isInitialized(){return!!this.pointer}init(m){this.vertexShader=this._createShader(m,35633,this.vertexShaderSrc),this.fragmentShader=this._createShader(m,35632,this.fragmentShaderSrc);const h=m.createProgram();return(m.attachShader(h,this.vertexShader),m.attachShader(h,this.fragmentShader),m.linkProgram(h),!m.getProgramParameter(h,m.LINK_STATUS))?(console.error('Shader initialization error'),!1):(m.useProgram(h),this.pointer=h,!0)}getAttribLocation(m,h){const T=h.label;if(!this.attribLocation.hasOwnProperty(T)){const _=m.getAttribLocation(this.pointer,T);return m.enableVertexAttribArray(_),this.attribLocation[T]=_,_}return this.attribLocation[T]}getUniformLocation(m,h){const T=h.label;if(!this.uniformLocation.hasOwnProperty(T)){const _=m.getUniformLocation(this.pointer,T);return this.uniformLocation[T]=_,_}return this.uniformLocation[T]}getTextureLocationIndex(m,h){const T=h.label;if(!this.textureLocation.hasOwnProperty(T)||!this.textureIndex.hasOwnProperty(T)){const _=m.getUniformLocation(this.pointer,T);return this.textureLocation[T]=_,this.textureIndex[T]=this.textureNum,[_,this.textureNum++]}return[this.textureLocation[T],this.textureIndex[T]]}bind(m){m.useProgram(this.pointer)}_createShader(m,h,T){const _=m.createShader(h);return m.shaderSource(_,T),m.compileShader(_),m.getShaderParameter(_,m.COMPILE_STATUS)?_:console.error('Une erreur est survenue au cours de la compilation du shader: '+m.getShaderInfoLog(_))}}},function(d,n,u){'use strict';var o=u(7),l=u(11);class m{constructor(){this.attributes=[],this.buffers=[],this.hasIndices=!1,this.numItems=0}addVertices(h,T,_){const E=new l.a(h);E.setArray(new Float32Array(T),34962),E.setItems(5126,_),this.attributes.push(E),1>this.numItems&&(this.numItems=T.length/_)}addIndices(h){const T=new o.a;T.setArray(new Uint16Array(h),34963),T.setItems(5125,1),this.hasIndices=!0,this.buffers.push(T),this.numItems=h.length}display(h){this.hasIndices?h.drawElements(h.TRIANGLES,this.numItems,h.UNSIGNED_SHORT,0):h.drawArrays(h.TRIANGLES,0,this.numItems)}clone(h=new m){return h.attributes=this.attributes.map((T)=>T.clone()),h.buffers=this.buffers.map((T)=>T.clone()),h.hasIndices=this.hasIndices,h.numItems=this.numItems,h}}n.a=m},function(d,n,u){'use strict';var o=u(6),l=u(12);class m extends o.a{constructor(h,T){super(h,T),this.depthTest=!0;const _=new l.a('uMVMatrix');this.transform=_,this.addUniform(_)}get position(){return this.transform.getTranslation()}get rotation(){return this.transform.getRotation()}draw(h,T=[]){this.transform&&this.transform.update(),super.draw(h,T)}}n.a=m},function(d,n){'use strict';function o(h,T,_,E,I,R,D,P,F,U,L,N,A,C,M,v,B){return h[0]=T,h[1]=_,h[2]=E,h[3]=I,h[4]=R,h[5]=D,h[6]=P,h[7]=F,h[8]=U,h[9]=L,h[10]=N,h[11]=A,h[12]=C,h[13]=M,h[14]=v,h[15]=B,h}const l=1e-6;class m{constructor(){console.warn('Matrix4 is a static class')}static create(){const h=new Float32Array(16);return h[0]=1,h[5]=1,h[10]=1,h[15]=1,h}static clone(h){return m.copy(h)}static copy(h,T=new Float32Array(16)){return T.set(h),T}static identity(h){return o(h,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}static add(h,T){return h[0]+=T[0],h[1]+=T[1],h[2]+=T[2],h[3]+=T[3],h[4]+=T[4],h[5]+=T[5],h[6]+=T[6],h[7]+=T[7],h[8]+=T[8],h[9]+=T[9],h[10]+=T[10],h[11]+=T[11],h[12]+=T[12],h[13]+=T[13],h[14]+=T[14],h[15]+=T[15],h}static subtract(h,T){return h[0]-=T[0],h[1]-=T[1],h[2]-=T[2],h[3]-=T[3],h[4]-=T[4],h[5]-=T[5],h[6]-=T[6],h[7]-=T[7],h[8]-=T[8],h[9]-=T[9],h[10]-=T[10],h[11]-=T[11],h[12]-=T[12],h[13]-=T[13],h[14]-=T[14],h[15]-=T[15],h}static multiplyScalar(h){return m1[0]*=h,m1[1]*=h,m1[2]*=h,m1[3]*=h,m1[4]*=h,m1[5]*=h,m1[6]*=h,m1[7]*=h,m1[8]*=h,m1[9]*=h,m1[10]*=h,m1[11]*=h,m1[12]*=h,m1[13]*=h,m1[14]*=h,m1[15]*=h,m1}static multiplyScalarAndAdd(h,T,_){return h[0]+=T[0]*_,h[1]+=T[1]*_,h[2]+=T[2]*_,h[3]+=T[3]*_,h[4]+=T[4]*_,h[5]+=T[5]*_,h[6]+=T[6]*_,h[7]+=T[7]*_,h[8]+=T[8]*_,h[9]+=T[9]*_,h[10]+=T[10]*_,h[11]+=T[11]*_,h[12]+=T[12]*_,h[13]+=T[13]*_,h[14]+=T[14]*_,h[15]+=T[15]*_,h}static exactEquals(h,T){return h[0]===T[0]&&h[1]===T[1]&&h[2]===T[2]&&h[3]===T[3]&&h[4]===T[4]&&h[5]===T[5]&&h[6]===T[6]&&h[7]===T[7]&&h[8]===T[8]&&h[9]===T[9]&&h[10]===T[10]&&h[11]===T[11]&&h[12]===T[12]&&h[13]===T[13]&&h[14]===T[14]&&h[15]===T[15]}static equals(h,T){const[_,E,I,R,D,P,F,U,L,N,A,C,M,v,B,O]=h,[k,X,H,G,V,W,Y,q,Z,K,$,J,Q,ee,ae,te]=T;return _Mathabs(_-k)<=l*_Mathmax(1,_Mathabs(_),_Mathabs(k))&&_Mathabs(E-X)<=l*_Mathmax(1,_Mathabs(E),_Mathabs(X))&&_Mathabs(I-H)<=l*_Mathmax(1,_Mathabs(I),_Mathabs(H))&&_Mathabs(R-G)<=l*_Mathmax(1,_Mathabs(R),_Mathabs(G))&&_Mathabs(D-V)<=l*_Mathmax(1,_Mathabs(D),_Mathabs(V))&&_Mathabs(P-W)<=l*_Mathmax(1,_Mathabs(P),_Mathabs(W))&&_Mathabs(F-Y)<=l*_Mathmax(1,_Mathabs(F),_Mathabs(Y))&&_Mathabs(U-q)<=l*_Mathmax(1,_Mathabs(U),_Mathabs(q))&&_Mathabs(L-Z)<=l*_Mathmax(1,_Mathabs(L),_Mathabs(Z))&&_Mathabs(N-K)<=l*_Mathmax(1,_Mathabs(N),_Mathabs(K))&&_Mathabs(A-$)<=l*_Mathmax(1,_Mathabs(A),_Mathabs($))&&_Mathabs(C-J)<=l*_Mathmax(1,_Mathabs(C),_Mathabs(J))&&_Mathabs(M-Q)<=l*_Mathmax(1,_Mathabs(M),_Mathabs(Q))&&_Mathabs(v-ee)<=l*_Mathmax(1,_Mathabs(v),_Mathabs(ee))&&_Mathabs(B-ae)<=l*_Mathmax(1,_Mathabs(B),_Mathabs(ae))&&_Mathabs(O-te)<=l*_Mathmax(1,_Mathabs(O),_Mathabs(te))}static transpose(h,T){if(T===h){const _=T[1],E=T[2],I=T[3],R=T[6],D=T[7],P=T[11];h[1]=T[4],h[2]=T[8],h[3]=T[12],h[4]=_,h[6]=T[9],h[7]=T[13],h[8]=E,h[9]=R,h[11]=T[14],h[12]=I,h[13]=D,h[14]=P}else o(h,T[0],T[4],T[8],T[12],T[1],T[5],T[9],T[13],T[2],T[6],T[10],T[14],T[3],T[7],T[11],T[15]);return h}static invert(h){const[T,_,E,I,R,D,P,F,U,L,N,A,C,M,v,B]=h,O=T*D-_*R,k=T*P-E*R,X=T*F-I*R,H=_*P-E*D,G=_*F-I*D,V=E*F-I*P,W=U*M-L*C,Y=U*v-N*C,q=U*B-A*C,Z=L*v-N*M,K=L*B-A*M,$=N*B-A*v;let J=O*$-k*K+X*Z+H*q-G*Y+V*W;return J?(J=1/J,o(h,(D*$-P*K+F*Z)*J,(E*K-_*$-I*Z)*J,(M*V-v*G+B*H)*J,(N*G-L*V-A*H)*J,(P*q-R*$-F*Y)*J,(T*$-E*q+I*Y)*J,(v*X-C*V-B*k)*J,(U*V-N*X+A*k)*J,(R*K-D*q+F*W)*J,(_*q-T*K-I*W)*J,(C*G-M*X+B*O)*J,(L*X-U*G-A*O)*J,(D*Y-R*Z-P*W)*J,(T*Z-_*Y+E*W)*J,(M*k-C*H-v*O)*J,(U*H-L*k+N*O)*J)):h}static adjoint(h){const[T,_,E,I,R,D,P,F,U,L,N,A,C,M,v,B]=h;return o(h,D*(N*B-A*v)-L*(P*B-F*v)+M*(P*A-F*N),-(_*(N*B-A*v)-L*(E*B-I*v)+M*(E*A-I*N)),_*(P*B-F*v)-D*(E*B-I*v)+M*(E*F-I*P),-(_*(P*A-F*N)-D*(E*A-I*N)+L*(E*F-I*P)),-(R*(N*B-A*v)-U*(P*B-F*v)+C*(P*A-F*N)),T*(N*B-A*v)-U*(E*B-I*v)+C*(E*A-I*N),-(T*(P*B-F*v)-R*(E*B-I*v)+C*(E*F-I*P)),T*(P*A-F*N)-R*(E*A-I*N)+U*(E*F-I*P),R*(L*B-A*M)-U*(D*B-F*M)+C*(D*A-F*L),-(T*(L*B-A*M)-U*(_*B-I*M)+C*(_*A-I*L)),T*(D*B-F*M)-R*(_*B-I*M)+C*(_*F-I*D),-(T*(D*A-F*L)-R*(_*A-I*L)+U*(_*F-I*D)),-(R*(L*v-N*M)-U*(D*v-P*M)+C*(D*N-P*L)),T*(L*v-N*M)-U*(_*v-E*M)+C*(_*N-E*L),-(T*(D*v-P*M)-R*(_*v-E*M)+C*(_*P-E*D)),T*(D*N-P*L)-R*(_*N-E*L)+U*(_*P-E*D))}static determinant(h){const[T,_,E,I,R,D,P,F,U,L,N,A,C,M,v,B]=h;return(T*D-_*R)*(N*B-A*v)-(T*P-E*R)*(L*B-A*M)+(T*F-I*R)*(L*v-N*M)+(_*P-E*D)*(U*B-A*C)-(_*F-I*D)*(U*v-N*C)+(E*F-I*P)*(U*M-L*C)}static multiply(h,T){const[_,E,I,R,D,P,F,U,L,N,A,C,M,v,B,O]=h;let[k,X,H,G]=T;return h[0]=k*_+X*D+H*L+G*M,h[1]=k*E+X*P+H*N+G*v,h[2]=k*I+X*F+H*A+G*B,h[3]=k*R+X*U+H*C+G*O,k=T[4],X=T[5],H=T[6],G=T[7],h[4]=k*_+X*D+H*L+G*M,h[5]=k*E+X*P+H*N+G*v,h[6]=k*I+X*F+H*A+G*B,h[7]=k*R+X*U+H*C+G*O,k=T[8],X=T[9],H=T[10],G=T[11],h[8]=k*_+X*D+H*L+G*M,h[9]=k*E+X*P+H*N+G*v,h[10]=k*I+X*F+H*A+G*B,h[11]=k*R+X*U+H*C+G*O,k=T[12],X=T[13],H=T[14],G=T[15],h[12]=k*_+X*D+H*L+G*M,h[13]=k*E+X*P+H*N+G*v,h[14]=k*I+X*F+H*A+G*B,h[15]=k*R+X*U+H*C+G*O,h}static translate(h,[T,_,E]){return h[12]=h[0]*T+h[4]*_+h[8]*E+h[12],h[13]=h[1]*T+h[5]*_+h[9]*E+h[13],h[14]=h[2]*T+h[6]*_+h[10]*E+h[14],h[15]=h[3]*T+h[7]*_+h[11]*E+h[15],h}static scale(h,[T,_,E]){return h[0]*=T,h[1]*=T,h[2]*=T,h[3]*=T,h[4]*=_,h[5]*=_,h[6]*=_,h[7]*=_,h[8]*=E,h[9]*=E,h[10]*=E,h[11]*=E,h}static rotate(h,T,[_,E,I]){let R=_Mathsqrt(_*_+E*E+I*I);if(_Mathabs(R)>l){R=1/R,_*=R,E*=R,I*=R;const D=_Mathsin(T),P=_Mathcos(T),F=1-P,[U,L,N,A,C,M,v,B,O,k,X,H]=h,G=_*_*F+P,V=E*_*F+I*D,W=I*_*F-E*D,Y=_*E*F-I*D,q=E*E*F+P,Z=I*E*F+_*D,K=_*I*F+E*D,$=E*I*F-_*D,J=I*I*F+P;h[0]=U*G+C*V+O*W,h[1]=L*G+M*V+k*W,h[2]=N*G+v*V+X*W,h[3]=A*G+B*V+H*W,h[4]=U*Y+C*q+O*Z,h[5]=L*Y+M*q+k*Z,h[6]=N*Y+v*q+X*Z,h[7]=A*Y+B*q+H*Z,h[8]=U*K+C*$+O*J,h[9]=L*K+M*$+k*J,h[10]=N*K+v*$+X*J,h[11]=A*K+B*$+H*J}return h}static rotateX(h,T){const _=_Mathsin(T),E=_Mathcos(T),I=h[4],R=h[5],D=h[6],P=h[7],F=h[8],U=h[9],L=h[10],N=h[11];return h[4]=I*E+F*_,h[5]=R*E+U*_,h[6]=D*E+L*_,h[7]=P*E+N*_,h[8]=F*E-I*_,h[9]=U*E-R*_,h[10]=L*E-D*_,h[11]=N*E-P*_,h}static rotateY(h,T){const _=_Mathsin(T),E=_Mathcos(T),[I,R,D,P]=h,F=h[8],U=h[9],L=h[10],N=h[11];return h[0]=I*E-F*_,h[1]=R*E-U*_,h[2]=D*E-L*_,h[3]=P*E-N*_,h[8]=I*_+F*E,h[9]=R*_+U*E,h[10]=D*_+L*E,h[11]=P*_+N*E,h}static rotateZ(h,T){const _=_Mathsin(T),E=_Mathcos(T),[I,R,D,P,F,U,L,N]=h;return h[0]=I*E+F*_,h[1]=R*E+U*_,h[2]=D*E+L*_,h[3]=P*E+N*_,h[4]=F*E-I*_,h[5]=U*E-R*_,h[6]=L*E-D*_,h[7]=N*E-P*_,h}static fromTranslation([h,T,_],E=new Float32Array(16)){return o(E,1,0,0,0,0,1,0,0,0,0,1,0,h,T,_,1)}static fromScaling([h,T,_],E=new Float32Array(16)){return o(E,h,0,0,0,0,T,0,0,0,0,_,0,0,0,0,1)}static fromRotation(h,[T,_,E],I=new Float32Array(16)){let R=_Mathsqrt(T*T+_*_+E*E);if(_Mathabs(R)>l){R=1/R,T*=R,_*=R,E*=R;const D=_Mathsin(h),P=_Mathcos(h),F=1-P;o(I,T*T*F+P,_*T*F+E*D,E*T*F-_*D,0,T*_*F-E*D,_*_*F+P,E*_*F+T*D,0,T*E*F+_*D,_*E*F-T*D,E*E*F+P,0,0,0,0,1)}return I}static fromXRotation(h,T=new Float32Array(16)){const _=_Mathsin(h),E=_Mathcos(h);return o(T,1,0,0,0,0,E,_,0,0,-_,E,0,0,0,0,1)}static fromYRotation(h,T=new Float32Array(16)){const _=_Mathsin(h),E=_Mathcos(h);return o(T,E,0,-_,0,0,1,0,0,_,0,E,0,0,0,0,1)}static fromZRotation(h,T=new Float32Array(16)){const _=_Mathsin(h),E=_Mathcos(h);return o(T,E,_,0,0,-_,E,0,0,0,0,1,0,0,0,0,1)}static fromQuat([h,T,_,E],I=new Float32Array(16)){const R=h+h,D=T+T,P=_+_,F=h*R,U=T*R,L=T*D,N=_*R,A=_*D,C=_*P,M=E*R,v=E*D,B=E*P;return o(I,1-L-C,U+B,N-v,0,U-B,1-F-C,A+M,0,N+v,A-M,1-F-L,0,0,0,0,1)}static fromQuatTranslation([h,T,_,E],[I,R,D],P=new Float32Array(16)){const F=h+h,U=T+T,L=_+_,N=h*F,A=h*U,C=h*L,M=T*U,v=T*L,B=_*L,O=E*F,k=E*U,X=E*L;return o(P,1-(M+B),A+X,C-k,0,A-X,1-(N+B),v+O,0,C+k,v-O,1-(N+M),0,I,R,D,1)}static fromQuatTranslationScale([h,T,_,E],[I,R,D],[P,F,U],L=new Float32Array(16)){const N=h+h,A=T+T,C=_+_,M=h*N,v=h*A,B=h*C,O=T*A,k=T*C,X=_*C,H=E*N,G=E*A,V=E*C;return o(L,(1-(O+X))*P,(v+V)*P,(B-G)*P,0,(v-V)*F,(1-(M+X))*F,(k+H)*F,0,(B+G)*U,(k-H)*U,(1-(M+O))*U,0,I,R,D,1)}static fromQuatTranslationScaleOrigin([h,T,_,E],[I,R,D],[P,F,U],[L,N,A],C=new Float32Array(16)){const M=h+h,v=T+T,B=_+_,O=h*M,k=h*v,X=h*B,H=T*v,G=T*B,V=_*B,W=E*M,Y=E*v,q=E*B;return o(C,(1-(H+V))*P,(k+q)*P,(X-Y)*P,0,(k-q)*F,(1-(O+V))*F,(G+W)*F,0,(X+Y)*U,(G-W)*U,(1-(O+H))*U,0,I+L-(C[0]*L+C[4]*N+C[8]*A),R+N-(C[1]*L+C[5]*N+C[9]*A),D+A-(C[2]*L+C[6]*N+C[10]*A),1),C}static getTranslation(h,T=new Float32Array(3)){return T[0]=h[12],T[1]=h[13],T[2]=h[14],T}static getQuat(h,T=new Float32Array(4)){var _=h[0]+h[5]+h[10];if(0<_){const E=2*_Mathsqrt(_+1);T[0]=(h[6]-h[9])/E,T[1]=(h[8]-h[2])/E,T[2]=(h[1]-h[4])/E,T[3]=0.25*E}else if(h[0]>h[5]&h[0]>h[10]){const E=2*_Mathsqrt(1+h[0]-h[5]-h[10]);T[0]=0.25*E,T[1]=(h[1]+h[4])/E,T[2]=(h[8]+h[2])/E,T[3]=(h[6]-h[9])/E}else if(h[5]>h[10]){const E=_Mathsqrt(1+h[5]-h[0]-h[10]);T[0]=2*((h[1]+h[4])/E),T[1]=0.25*E,T[2]=(h[6]+h[9])/E,T[3]=(h[8]-h[2])/E}else{const E=2*_Mathsqrt(1+h[10]-h[0]-h[5]);T[0]=(h[8]+h[2])/E,T[1]=(h[6]+h[9])/E,T[2]=0.25*E,T[3]=(h[1]-h[4])/E}return T}static frustrum(h,T,_,E,I,R,D){const P=1/(_-T),F=1/(I-E),U=1/(R-D);return o(h,2*R*P,0,0,0,0,2*R*F,0,0,(_+T)*P,(I+E)*F,(D+R)*U,-1,0,0,2*(D*R)*U,0)}static perspective(h,T,_,E,I){const R=1/_Mathtan(T/2),D=1/(E-I);return o(h,R/_,0,0,0,0,R,0,0,0,0,(I+E)*D,-1,0,0,2*I*E*D,0)}static perspectiveFromFieldOfView(h,T,_,E){const I=_Mathtan(T.upDegrees*_MathPI/180),R=_Mathtan(T.downDegrees*_MathPI/180),D=_Mathtan(T.leftDegrees*_MathPI/180),P=_Mathtan(T.rightDegrees*_MathPI/180),F=2/(D+P),U=2/(I+R);return o(h,F,0,0,0,0,U,0,0,0.5*(-(D-P)*F),0.5*((I-R)*U),E/(_-E),-1,0,0,E*_/(_-E),0)}static ortho(h,T,_,E,I,R,D){const P=1/(T-_),F=1/(E-I),U=1/(R-D);return o(h,-2*P,0,0,0,0,-2*F,0,0,0,0,2*U,0,(T+_)*P,(I+E)*F,(D+R)*U,1)}static lookAt(h,T,_,E){const[I,R,D]=T,[P,F,U]=E,[L,N,A]=_;if(_Mathabs(I-L)<l&&_Mathabs(R-N)<l&&_Mathabs(D-A)<l)return m.identity(h);let C=I-L,M=R-N,v=D-A,B=1/_Mathsqrt(C*C+M*M+v*v);C*=B,M*=B,v*=B;let O=F*v-U*M,k=U*C-P*v,X=P*M-F*C;B=_Mathsqrt(O*O+k*k+X*X),B?(B=1/B,O*=B,k*=B,X*=B):(O=0,k=0,X=0);let H=M*X-v*k,G=v*O-C*X,V=C*k-M*O;return B=_Mathsqrt(H*H+G*G+V*V),B?(B=1/B,H*=B,G*=B,V*=B):(H=0,G=0,V=0),o(h,O,H,C,0,k,G,M,0,X,V,v,0,-(O*I+k*R+X*D),-(H*I+G*R+V*D),-(C*I+M*R+v*D),1)}static frob(h){return _Mathsqrt(_Mathpow(h[0],2)+_Mathpow(h[1],2)+_Mathpow(h[2],2)+_Mathpow(h[3],2)+_Mathpow(h[4],2)+_Mathpow(h[5],2)+_Mathpow(h[6],2)+_Mathpow(h[7],2)+_Mathpow(h[8],2)+_Mathpow(h[9],2)+_Mathpow(h[10],2)+_Mathpow(h[11],2)+_Mathpow(h[12],2)+_Mathpow(h[13],2)+_Mathpow(h[14],2)+_Mathpow(h[15],2))}}n.a=m},function(d,n,u){'use strict';var o=u(1);n.a=class{constructor(m,h){this.geom=m,this.program=h,this.uniforms=[],this.globalUniforms=[],this.textures=[],this.localCalls=[],this.globalCalls=[],this.order=1,this.visible=!0,this.depthTest=!1,this.blending={},this._isInitialized=!1}addBlending(m,h){this.blending[m]=h}addUniform(m){this.uniforms.push(m)}removeUniform(m){const h=this.uniforms.indexOf(m);-1<h&&this.uniforms.splice(h,1)}addGlobalUniform(m){this.globalUniforms.push(m)}removeGlobalUniform(m){const h=this.globalUniforms.indexOf(m);-1<h&&this.globalUniforms.splice(h,1)}addTexture(m){this.textures.push(m)}removeTexture(m){const h=this.textures.indexOf(m);-1<h&&this.textures.splice(h,1)}isInitialized(){let m=this._isInitialized;if(m)return m;this.program.isInitialized()||(m=!1);for(const h of this.geom.attributes)h.isInitialized()||(m=!1);for(const h of this.geom.buffers)h.isInitialized()||(m=!1);for(const h of this.textures)h.isInitialized()||(m=!1);return m}_setCalls(m){const h=this.program;for(const T of this.geom.attributes){const _=h.getAttribLocation(m,T);this.localCalls.push(T.bind.bind(T,m,_))}for(const T of this.geom.buffers)this.localCalls.push(T.bind.bind(T,m));for(const T of this.uniforms){const _=h.getUniformLocation(m,T);this.localCalls.push(T.bind.bind(T,m,_))}for(const T of this.textures){const[_,E]=h.getTextureLocationIndex(m,T);this.localCalls.push(T.bind.bind(T,m,_,E))}for(const T of this.globalUniforms){const _=h.getUniformLocation(m,T);this.globalCalls.push((E=!0)=>{(E||T.updated)&&(T.bind.call(T,m,_),T.updated=!1)})}}_initData(m){this.program;let T=!0;for(const _ of this.geom.attributes)_.isInitialized()||_.init(m)||(T=!1);for(const _ of this.geom.buffers)_.isInitialized()||_.init(m)||(T=!1);for(const _ of this.textures)_.isInitialized()||_.init(m)||(T=!1);return T}dispose(){this._isInitialized=!1,this.localCalls.length=0}init(m){this.program;let T=!0;return this.program.isInitialized()?this.program.bind(m):!this.program.init(m)&&(T=!1),this._initData(m)||(T=!1),T&&1>this.localCalls.length&&this._setCalls(m),this._callOptimizer=o.a.getInstance(m),this._isInitialized=T,T}draw(m,h=[]){this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST));const T=this.program;if(!this._callOptimizer.optimizeProgram(T)){this.program.bind(m);for(const E of this.globalCalls)E(!0)}else for(const E of this.globalCalls)E(!1);const _=Object.keys(this.blending);for(const E of _)m.blendFunc(E,this.blending[E]);0<_.length&&m.enable(3042);for(const E of this.localCalls)E();for(const E of h)E();this.geom.display(m)}}},function(d,n){'use strict';class o{constructor(){this.pointer=null,this.gl=null,this.arrayType=34962,this.data=null,this.arrayUsage=35044}isInitialized(){return!!this.pointer}setArray(l,m=this.arrayType,h=this.arrayUsage){this.arrayType=m,this.data=l,this.arrayUsage=h;const T=this.gl;T&&(T.bindBuffer(m,this.pointer),T.bufferData(m,l,arrayUsage))}setItems(l=5126,m=3){this.itemType=l,this.itemSize=m}init(l){const m=l.createBuffer();return l.bindBuffer(this.arrayType,m),l.bufferData(this.arrayType,this.data,this.arrayUsage),this.pointer=m,this.gl=l,!0}bind(l){l.bindBuffer(this.arrayType,this.pointer)}clone(l=new o){return l.setArray(this.data,this.arrayType,this.arrayUsage),l.setItems(this.itemType,this.itemSize),l}}n.a=o},function(d,n,u){'use strict';var o=u(1);class l{constructor(){this.meshes=[],this.depthTest=!0,this.sortCompare=(m,h)=>{if(m.order!==h.order)return m.order-h.order;return m.program&&h.program&&m.program!==h.program?m.program.id-h.program.id:m.textures&&h.textures&&0<m.textures.length&&0<m.textures.length?m.textures[0].id-h.textures[1].id:0},this._updateList=[]}addMesh(m){this.meshes.push(m)}removeMesh(m){const h=this.meshes.indexOf(m);-1<h&&this.meshes.splice(h,1)}sort(){this.meshes.sort(this.sortCompare)}set bgColor([m,h,T,_=1]){this._updateList.push((E)=>E.clearColor(m,h,T,_)),this._bgColor=[m,h,T,_]}get bgColor(){return this._bgColor}init(m){console.log(m),this._callOptimizer=o.a.getInstance(m)}draw(m){for(;0<this._updateList.length;)this._updateList.pop()(m);this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST)),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT|m.STENCIL_BUFFER_BIT);for(const h of this.meshes)h.visible&&(h.isInitialized()?h.draw(m):(h.init(m),h.draw(m)))}}n.a=l},function(d,n,u){'use strict';var o=u(16);n.a=class{constructor(m,h={antialias:!0,stencil:!0,alpha:!0,width:640,height:360}){this.width=h.width,this.height=h.height,this.screenRecorder=new o.a(h.width,h.height,!0,!0),this.passEnabled=!0,this.scenes=[],this.passList=[],this.isEnable=!1,this._init(m,{antialias:h.antialias,stencil:h.stencil,alpha:h.alpha}),this._initScreenRecorder(this.gl)}_init(m,h){let T;try{T=m.getContext('webgl',h)||m.getContext('experimental-webgl',h)}catch(_){console.error('Could not initialise WebGL:',_.message)}T||console.error('Could not initialise WebGL'),this.gl=T,this.gl.viewport(0,0,this.width,this.height)}_initScreenRecorder(m){if(this.screenRecorder.init(m),!this.screenRecorder.depthTexture)for(const h of this.passList)this._disableDepthInTexture(h,m)}isInitialized(){return this.screenRecorder.isInitialized()}addScene(m){m.init(this.gl),this.scenes.push(m)}resize(m,h){this.width=m,this.height=h,this.gl.viewport(0,0,this.width,this.height),this.screenRecorder.resize(m,h,this.gl);for(const T of this.passList)T.resize(m,h)}_disableDepthInTexture(m,h){m.inDepthTexture&&m.setDepthTexture(!1,h)}addPass(m){m.init(this.gl,[]),this.screenRecorder.isInitialized()&&!this.screenRecorder.depthTexture&&this._disableDepthInTexture(m,this.gl),m.uWidth&&(m.uWidth.data=this.width),m.uHeight&&(m.uHeight.data=this.height),this.passList.push(m),this.isEnable=!0}removePass(m){const h=this.passList.indexOf(m);-1<h&&this.passList.splice(h,1),this.isEnable=0<this.passList.length}draw(){const m=this.gl,h=this.passList.length;if(this.passEnabled&&0<h&&0<this.scenes.length){this.screenRecorder.start(m,!0),this.scenes[0].draw(m),this.screenRecorder.stop(m),this.screenRecorder.pingpong();for(let T=0;T<h;T++){const _=this.passList[T],E=T>h-2;E||this.screenRecorder.start(m,!1),this.screenRecorder.pingpong(),_.inColorTexture&&_.inColorTexture.setTexture(this.screenRecorder.colorTexture),_.inDepthTexture&&this.screenRecorder.depthTexture&&_.inDepthTexture.setTexture(this.screenRecorder.depthTexture),_.draw(m),this.screenRecorder.stop(m)}}else 0<this.scenes.length&&this.scenes[0].draw(m)}}},function(d,n,u){'use strict';var o=u(1);let l=0;class m{constructor(h){this.id=l++,this.label=h,this.mipmap=!0,this.img=null,this.width=null,this.height=null,this.pointer=null,this.parameters=[],this.setType(),this.setInternalFormat(),this.setFormat(),this.setTarget()}resize(h,T,_=null){this.width=h,this.height=T,_?(_.bindTexture(this.target,this.pointer),_.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img)):this.updated=!0}setTempColor(h){this.setImg(new Uint8Array(h),1,1)}setImg(h=new Uint8Array([255,255,255,255]),T=1,_=1){this.img=h,this.width=T,this.height=_}setType(h=5121){this.type=h}setInternalFormat(h=6408){this.internalFormat=h}setFormat(h=6408){this.format=h}setTarget(h=3553){this.target=h}setParam(h,T){const _=this.parameters.find((E)=>E[0]===h);-1<_?this.parameters[_][1]=T:this.parameters.push([h,T])}isInitialized(){return!!this.pointer}static IS_POWER_OF_2(h){return 0==(h&h-1)}static SET_DATA(h){m.MAX_SIZE=h.getParameter(h.MAX_TEXTURE_SIZE),m.FORMAT={};const T=h.getParameter(h.COMPRESSED_TEXTURE_FORMATS);for(let _=0;_<T.length;_++)m.FORMAT[T[_]]=!0;m._DATA_INITIALIZED=!0}setDefaultParams(h){this.mipmap?this.setParam(h.TEXTURE_MIN_FILTER,h.LINEAR_MIPMAP_LINEAR):(this.setParam(h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),this.setParam(h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),this.setParam(h.TEXTURE_MIN_FILTER,h.LINEAR))}initParams(h){if(this.mipmap){const T=this.img;null===T?console.warn('You need an image to set the parameters of texture'):m.IS_POWER_OF_2(T.width)&&m.IS_POWER_OF_2(T.height)?h.generateMipmap(this.target):(this.mipmap=!1,console.warn('You need a power of 2 for the size of the mipmaped texture'))}1>this.parameters.length&&this.setDefaultParams(h);for(const[T,_]of this.parameters)h.texParameteri(this.target,T,_)}init(h){const T=h.createTexture();return m._DATA_INITIALIZED||m.SET_DATA(h),h.bindTexture(this.target,T),h.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.initParams(h),this._callOptimizer=o.a.getInstance(h),this.pointer=T,!0}bind(h,T,_){this._callOptimizer.optimizeTexture(this)||(h.uniform1i(T,_),h.activeTexture(h.TEXTURE0+_),h.bindTexture(this.target,this.pointer),this.updated&&(h.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.updated=!1))}free(h){h.bindTexture(h.TEXTURE_2D,null)}}n.a=m},function(d,n,u){'use strict';var o=u(7);class l extends o.a{constructor(m){super(),this.label=m}bind(m,h){super.bind(m),m.vertexAttribPointer(h,this.itemSize,this.itemType,!1,0,0)}clone(m=new l(this.label)){return m.label=this.label,super.clone(m),m}}n.a=l},function(d,n,u){'use strict';var o=u(5),l=u(0);class m extends l.a{constructor(h){super(h,35676,o.a.create()),this.updateNum=0,this.updated=!0,this.local=o.a.create(),this.parent=null}get global(){return this.update(),this._data}update(){const h=this.parent,T=null!==this.parent;if(this.updated||T&&this._parentUpdateNum!==h.updateNum){const _=this._data;T?(o.a.copy(h.global,_),o.a.multiply(_,this.local),this._parentUpdateNum=h.updateNum):o.a.copy(this.local,_),this.updateNum++,this.updated=!0}}clear(){o.a.identity(this.local),this.updateNum++,this.updated=!0}scale(h){o.a.scale(this.local,h),this.updateNum++,this.updated=!0}translate(h){o.a.translate(this.local,h),this.updateNum++,this.updated=!0}rotate(h,T){o.a.rotate(this.local,h,T),this.updateNum++,this.updated=!0}rotateX(h){o.a.rotateX(this.local,h),this.updateNum++,this.updated=!0}rotateY(h){o.a.rotateY(this.local,h),this.updateNum++,this.updated=!0}rotateZ(h){o.a.rotateZ(this.local,h),this.updateNum++,this.updated=!0}attach(h){this.parent=h,this._parentUpdateNum=h.updateNum,this.updateNum++,this.updated=!0}detach(){this.parent=null,this.updateNum++,this.updated=!0}}n.a=m},function(d,n,u){'use strict';var o=u(5),l=u(0);class m extends l.a{constructor(){super('uPMatrix',35676,o.a.create()),this.fovy=45,this.near=0.1,this.far=100;const h=o.a.create();this._matrix=h,this.updated=!0,this.updateNum=0,this._ratio=0,this.clear=()=>{o.a.identity(h),this.updated=!0},this.translate=(T)=>{o.a.translate(h,T),this.updated=!0},this.scale=(T)=>{o.a.scale(h,T),this.updated=!0},this.rotate=(T,_)=>{o.a.rotate(h,T,_),this.updated=!0},this.rotateX=(T)=>{o.a.rotateX(h,T),this.updated=!0},this.rotateY=(T)=>{o.a.rotateY(h,T),this.updated=!0},this.rotateZ=(T)=>{o.a.rotateZ(h,T),this.updated=!0},this.lookAt=(T,_,E)=>{o.a.lookAt(h,T,_,E),this.updated=!0}}get data(){return this.updated&&this.update(),this._data}get ratio(){return this._ratio}set ratio(h){this._ratio=h,this.updated=!0}resize(h,T){this._ratio=h/T,this.updated=!0}update(){o.a.perspective(this._data,this.fovy*_MathPI/180,this._ratio,this.near,this.far),o.a.multiply(this._data,this._matrix),this.updated=!1,this.updateNum++}}n.a=m},function(d,n){'use strict';n.a=class{constructor(){this.pointer=null}isInitialized(){return!!this.pointer}init(l){const m=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,m),this.pointer=m,!0}bind(l){l.bindFramebuffer(l.FRAMEBUFFER,this.pointer)}free(l){l.bindFramebuffer(l.FRAMEBUFFER,null)}}},function(d,n){'use strict';n.a=class{constructor(l,m){this.pointer=null,this.width=l,this.height=m}resize(l,m,h=null){this.width=l,this.height=m,h?(h.bindRenderbuffer(h.RENDERBUFFER,this.pointer),h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_COMPONENT16,l,m)):this.updated=!0}isInitialized(){return!!this.pointer}init(l){const m=l.createRenderbuffer();l.bindRenderbuffer(l.RENDERBUFFER,m),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,this.width,this.height),this.pointer=m}bind(l){l.bindRenderbuffer(l.RENDERBUFFER,renderBuffer),this.updated&&(l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,this.width,this.height),this.updated=!1)}}},function(d,n,u){'use strict';var o=u(10),l=u(15),m=u(14);class h{constructor(T,_,E=!0,I=!1){this.captureDepth=E,this.recordDepth=I,this.width=T,this.height=_,this.updated=!1,this._pingpong=!1,this._colorTextures=[this._genColorTexture('frameBufferColor0',T,_),this._genColorTexture('frameBufferColor1',T,_)],this.frameBuffer=new m.a}_genDepthTexture(T,_,E){const I=new o.a;return I.mipmap=!1,I.setInternalFormat(6402),I.setFormat(6402),I.setType(5123),I.setParam(10242,33071),I.setParam(10243,33071),I.setParam(10241,9728),I.setParam(10240,9728),I.setImg(null,_,E),I}_genColorTexture(T,_,E){const I=new o.a(T);return I.mipmap=!1,!1,I.setImg(null,_,E),I}pingpong(){this._pingpong=!this._pingpong}get colorTexture(){return this._colorTextures[this._pingpong?1:0]}resize(T,_,E){this.width=T,this.height=_,this.pingpong(),this.colorTexture.resize(T,_,E),this.pingpong(),this.colorTexture.resize(T,_,E),this.depthTexture&&this.depthTexture.resize(T,_,E),this.renderBuffer&&this.renderBuffer.resize(T,_,E)}isInitialized(){return!!this.frameBuffer.pointer}static SET_DATA(T){h.WEBGL_depth_texture=T.getExtension('WEBGL_depth_texture')||T.getExtension('WEBKIT_WEBGL_depth_texture')||T.getExtension('MOZ_WEBGL_depth_texture'),h._DATA_INITIALIZED=!0}init(T){return h._DATA_INITIALIZED||h.SET_DATA(T),this.recordDepth&&(h.WEBGL_depth_texture?(this.depthTexture=this._genDepthTexture('frameBufferDepth',this.width,this.height),this.depthTexture.init(T)):(console.warn('WEBGL_depth_texture Extension not available!'),this.recordDepth=!1)),this.captureDepth&&(this.renderBuffer=new l.a(this.width,this.height),this.renderBuffer.init(T)),this.frameBuffer.init(T),this.pingpong(),this.colorTexture.init(T),this.pingpong(),this.colorTexture.init(T),this.depthTexture?T.framebufferTexture2D(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.TEXTURE_2D,this.depthTexture.pointer,0):this.renderBuffer&&T.framebufferRenderbuffer(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.RENDERBUFFER,this.renderBuffer.pointer),T.bindTexture(T.TEXTURE_2D,null),T.bindFramebuffer(T.FRAMEBUFFER,null),T.bindRenderbuffer(T.RENDERBUFFER,null),!0}start(T,_=!0){this.frameBuffer.bind(T),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,this.colorTexture.pointer,0),this.depthTexture?T.framebufferTexture2D(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.TEXTURE_2D,_?this.depthTexture.pointer:null,0):this.renderBuffer&&T.framebufferRenderbuffer(T.FRAMEBUFFER,T.DEPTH_ATTACHMENT,T.RENDERBUFFER,_?this.renderBuffer.pointer:null)}stop(T){this.frameBuffer.free(T)}}n.a=h},function(d,n,u){'use strict';var l=u(10);class m extends l.a{constructor(h){super(h),this.srcs=[],this.setTempColor([255,255,255,255])}setTempColor(h){this.setImg(new Uint8Array(h),1,1)}addURL(h,T=0){const _={size:T,src:h,img:null,priority:0,isImage:!0,isValid:()=>!0,init:null};_.init=(E)=>{E.bindTexture(E.TEXTURE_2D,this.pointer),E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!0),E.texImage2D(E.TEXTURE_2D,0,6408,this.format,E.UNSIGNED_BYTE,_.img),this.img=_.img,this.initParams(E)},this.srcs.push(_)}static START_LOAD(h,T){if(0<T.length){T.sort((E,I)=>E.size===I.size?E.size-I.size:E.priority-I.priority);T.filter((E)=>E.size>=l.a.MAX_SIZE&&E.isValid(h));if(1<T.length){const E=T[0],I=T[T.length-1];m.LOAD(E,()=>{E.init(h),m.LOAD(I,()=>{I.init(h)})})}else if(0<T.length){const E=T[0];m.LOAD(E,()=>{E.init(h)})}else console.warn('The GPU can\'nt load a texture with size > ',l.a.MAX_SIZE)}else console.warn('URL of your smart texture not found')}static LOAD(h,T){if(h.isImage){const _=new Image;_.onload=()=>{T(h)},h.img=_,_.src=h.src}else{const _=new XMLHttpRequest;_.responseType='arraybuffer',_.open('GET',h.src,!0),_.onreadystatechange=()=>{_.readyState===XMLHttpRequest.DONE&&(200===_.status?(h.img=_.response,T(h)):console.error('fail to load image ',h.src,'status:',_.status,'statuc text:',_.statusText))},_.send()}}init(h,T){const _=super.init(h,T),E=this.pointer;return m.START_LOAD(h,this.srcs),_}}n.a=m},function(d,n,u){'use strict';var o=u(6),l=u(3),m=u(0),h=u(34);class T extends o.a{constructor(_,E='aVertexPosition',I='uSample'){const R=new l.a;R.addVertices(E,[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1],2),super(R,_)}resize(_,E){this.uWidth&&(this.uWidth.data=_),this.uHeight&&(this.uHeight.data=E)}useUWidth(_,E){const I=new m.a(_,5124,E);this.uWidth=I,this.addUniform(I)}useUHeight(_,E){const I=new m.a(_,5124,E);this.uHeight=I,this.addUniform(I)}useColorTexture(_){const E=new h.a(_);this.inColorTexture=E,this.addTexture(E)}useDepthTexture(_,E){const I=new h.a(_);this.inDepthTexture=I,this.addTexture(I);const R=new m.a(E,5124,1);this._inDetpthEnableUniform=R,this.addUniform(R)}setDepthTexture(_,E){this.removeTexture(this.inDepthTexture),_&&this.addTexture(this.inDepthTexture),this._inDetpthEnableUniform.data=_?1:0;const I=this.globalUniforms;this.dispose(),this.init(E,I)}}n.a=T},function(d,n){'use strict';function o(h,T,_,E,I,R,D,P,F,U){return h[0]=T,h[1]=_,h[2]=E,h[3]=I,h[4]=R,h[5]=D,h[6]=P,h[7]=F,h[8]=U,h}const l=1e-6;class m{constructor(){console.warn('Matrix3 is a static class')}static create(){const h=new Float32Array(9);return h[0]=1,h[4]=1,h[8]=1,h}static fromMarix4(h,T=new Float32Array(9)){return o(T,matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5],matrix[6],matrix[7],matrix[8])}static clone(h){return m.copy(h)}static copy(h,T=new Float32Array(9)){return T.set(h),T}static identity(h){return o(h,1,0,0,0,1,0,0,0,1)}static add(h,T){return h[0]+=T[0],h[1]+=T[1],h[2]+=T[2],h[3]+=T[3],h[4]+=T[4],h[5]+=T[5],h[6]+=T[6],h[7]+=T[7],h[8]+=T[8],h}static subtract(h,T){return h[0]-=T[0],h[1]-=T[1],h[2]-=T[2],h[3]-=T[3],h[4]-=T[4],h[5]-=T[5],h[6]-=T[6],h[7]-=T[7],h[8]-=T[8],h}static multiplyScalar(h,T){return h[0]*=T,h[1]*=T,h[2]*=T,h[3]*=T,h[4]*=T,h[5]*=T,h[6]*=T,h[7]*=T,h[8]*=T,h}static multiplyScalarAndAdd(h,T,_){return h[0]+=T[0]*_,h[1]+=T[1]*_,h[2]+=T[2]*_,h[3]+=T[3]*_,h[4]+=T[4]*_,h[5]+=T[5]*_,h[6]+=T[6]*_,h[7]+=T[7]*_,h[8]+=T[8]*_,h}static exactEquals(h,T){return h[0]===T[0]&&h[1]===T[1]&&h[2]===T[2]&&h[3]===T[3]&&h[4]===T[4]&&h[5]===T[5]&&h[6]===T[6]&&h[7]===T[7]&&h[8]===T[8]}static equals(h,T){const[_,E,I,R,D,P,F,U,L]=h,[N,A,C,M,v,B,O,k,X]=T;return _Mathabs(_-N)<=l*_Mathmax(1,_Mathabs(_),_Mathabs(N))&&_Mathabs(E-A)<=l*_Mathmax(1,_Mathabs(E),_Mathabs(A))&&_Mathabs(I-C)<=l*_Mathmax(1,_Mathabs(I),_Mathabs(C))&&_Mathabs(R-M)<=l*_Mathmax(1,_Mathabs(R),_Mathabs(M))&&_Mathabs(D-v)<=l*_Mathmax(1,_Mathabs(D),_Mathabs(v))&&_Mathabs(P-B)<=l*_Mathmax(1,_Mathabs(P),_Mathabs(B))&&_Mathabs(F-O)<=l*_Mathmax(1,_Mathabs(F),_Mathabs(O))&&_Mathabs(U-k)<=l*_Mathmax(1,_Mathabs(U),_Mathabs(k))&&_Mathabs(L-X)<=l*_Mathmax(1,_Mathabs(L),_Mathabs(X))}static transpose(h,T){if(T===h){const _=T[1],E=T[2],I=T[5];h[1]=T[3],h[2]=T[6],h[3]=_,h[5]=T[7],h[6]=E,h[7]=I}else o(h,T[0],T[4],T[6],T[1],T[4],T[5],T[2],T[7],T[8]);return h}static invert(h){const[T,_,E,I,R,D,P,F,U]=h,N=D*P-U*I,A=P*R-F*I;let C=T*b01+_*N+E*A;return C?(C=1/C,o(h,b01*C,(-U*_+E*F)*C,(D*_-E*R)*C,N*C,(U*T-E*P)*C,(-D*T+E*I)*C,A*C,(-F*T+_*P)*C,(R*T-_*I)*C)):h}static adjoint(h){const[T,_,E,I,R,D,P,F,U]=h;return o(h,R*U-D*F,E*F-_*U,_*D-E*R,D*P-I*U,T*U-E*P,E*I-T*D,I*F-R*P,_*P-T*F,T*R-_*I),h}static determinant(h){const[T,_,E,I,R,D,P,F,U]=h;return T*(U*R-D*F)+_*(-U*I+D*P)+E*(F*I-R*P)}static multiply(h,T){const[_,E,I,R,D,P,F,U,L]=h;let[N,A,C,M,v,B,O,k,X]=T;return o(h,N*_+A*R+C*F,N*E+A*D+C*U,N*I+A*P+C*L,M*_+v*R+B*F,M*E+v*D+B*U,M*I+v*P+B*L,O*_+k*R+X*F,O*E+k*D+X*U,O*I+k*P+X*L)}static translate(h,[T,_]){const[E,I,R,D,P,F,U,L,N]=h;return h[6]=T*E+_*D+U,h[7]=T*I+_*P+L,h[8]=T*R+_*F+N,h}static rotate(h,T){const N=_Mathsin(T),A=_Mathcos(T);return h[0]=A*_+80*R,h[1]=A*E+N*D,h[2]=A*I+N*P,h[3]=A*R-N*_,h[4]=A*D-N*E,h[5]=A*P-N*I,h}static scale(h,[T,_]){return h[0]*=T,h[1]*=T,h[2]*=T,h[3]*=_,h[4]*=_,h[5]*=_,h}static fromTranslation([h,T],_=new Float32Array(9)){return o(_,1,0,0,0,1,0,h,T,1)}static fromScaling([h,T],_=new Float32Array(9)){return o(_,h,0,0,0,T,0,0,0,1)}static fromMatrix2(h,T=new Float32Array(9)){return o(T,matrix2[0],matrix2[1],0,matrix2[2],matrix2[3],0,matrix2[4],matrix2[5],1)}static fromQuat([h,T,_,E],I=new Float32Array(9)){const R=h+h,D=T+T,P=_+_,F=h*R,U=T*R,L=T*D,N=_*R,A=_*D,C=_*P,M=E*R,v=E*D,B=E*P;return o(I,1-L-C,U-B,N+v,U+B,1-F-C,A-M,N-v,A+M,1-F-L)}static normalFromMatrix4(h,T=new Float32Array(9)){const[_,E,I,R,D,P,F,U,L,N,A,C,M,v,B,O]=h,k=_*P-E*D,X=_*F-I*D,H=_*U-R*D,G=E*F-I*P,V=E*U-R*P,W=I*U-R*F,Y=L*v-N*M,q=L*B-A*M,Z=L*O-C*M,K=N*B-A*v,$=N*O-C*v,J=A*O-C*B;let Q=k*J-X*$+H*K+G*Z-V*q+W*Y;return Q?void(Q=1/Q,o(T,(P*J-F*$+U*K)*Q,(F*Z-D*J-U*q)*Q,(D*$-P*Z+U*Y)*Q,(I*$-E*J-R*K)*Q,(_*J-I*Z+R*q)*Q,(E*Z-_*$-R*Y)*Q,(v*W-B*V+O*G)*Q,(B*H-M*W-O*X)*Q,(M*V-v*H+O*k)*Q)):T}static frob(h){return _Mathsqrt(_Mathpow(h[0],2)+_Mathpow(h[1],2)+_Mathpow(h[2],2)+_Mathpow(h[3],2)+_Mathpow(h[4],2)+_Mathpow(h[5],2)+_Mathpow(h[6],2)+_Mathpow(h[7],2)+_Mathpow(h[8],2))}}n.a=m},,,function(d,n,u){'use strict';var o=u(4);class l extends o.a{constructor(m,h){super(m,h),this.depthTest=!1,this.order=-1}}n.a=l},function(d,n,u){'use strict';var o=u(1);n.a=class{constructor(){this.meshs=[],this.order=0,this.visible=!0,this.mask=null,this._isInitialized=!1,this.sortCompare=(m,h)=>{if(m.order!==h.order)return m.order-h.order;return m.program&&h.program&&m.program!==h.program?m.program.id-h.program.id:m.textures&&h.textures&&0<m.textures.length&&0<m.textures.length?m.textures[0].id-h.textures[1].id:0}}setMask(m){this.mask=m}addMesh(m){this.meshs.push(m)}removeMesh(m){const h=this.meshs.indexOf(m);-1<h&&this.meshs.splice(h,1)}sort(){this.meshs.sort(this.sortCompare)}isInitialized(){if(null!==this.mask&&!this.mask.isInitialized())return!1;for(const m of this.meshs)if(!m.isInitialized())return!1;return!0}dispose(){for(const m of this.meshs)m.dispose();return!0}init(m){let h=!0;null!==this.mask&&this.mask.init(m);for(const T of this.meshs)T.init(m)||(h=!1);return this._callOptimizer=o.a.getInstance(m),h}draw(m,h=[]){this.mask&&this.mask.before(m);for(const T of this.meshs)T.draw(m,h);this.mask&&this.mask.after(m)}}},function(d,n,u){'use strict';var o=u(1);n.a=class{constructor(m){this.mesh=m,this.setMaskFunc(519,1,255),this.setDisplayFunc(517,0,255)}setMaskFunc(m,h,T){this.maskFunc=m,this.maskRef=h,this.maskMask=T}setDisplayFunc(m,h,T){this.displayFunc=m,this.displayRef=h,this.displayMask=T}isInitialized(){return this.mesh.isInitialized()}init(m){this.mesh.init(m),this._callOptimizer=o.a.getInstance(m)}before(m,h=[]){m.enable(2960),m.depthMask(!1),m.clear(1024),m.colorMask(!1,!1,!1,!1),m.stencilOp(7680,7680,7682),m.stencilFunc(this.maskFunc,this.maskRef,this.maskMask),this.mesh.draw(m,h),this._callOptimizer.optimizeProgram(null),m.stencilFunc(this.displayFunc,this.displayRef,this.displayMask),m.depthMask(!0),m.colorMask(!0,!0,!0,!0),m.stencilOp(7680,7680,7680)}after(m){m.disable(2960)}}},function(d,n,u){'use strict';var o=u(6),l=u(35);class m extends o.a{constructor(h,T){super(h,T),this.depthTest=!1;const _=new l.a('uMVMatrix');this.transform=_,this.addUniform(_)}get position(){return this.transform.getTranslation()}get rotation(){return this.transform.getRotation()}draw(h,T=[]){this.transform&&this.transform.update(),super.draw(h,T)}}n.a=m},function(d,n,u){'use strict';var o=u(5),l=u(0);const m=new Float32Array(3);class h extends l.a{constructor(T,_,E=1){super(T,35676,o.a.create()),this.camera3D=_,this.updateNum=-1,this.distance=E}get data(){return this.updateNum!==this.camera3D.updateNum&&this.update(),this._data}update(){const T=this.camera3D,_=T._matrix;o.a.getTranslation(_,m),m[0]=-m[0]*this.distance,m[1]=-m[1]*this.distance,m[2]=-m[2]*this.distance,o.a.perspective(this._data,T.fovy*_MathPI/180,T.ratio,T.near,T.far),o.a.translate(this._data,m),o.a.multiply(this._data,_),this.updateNum=this.camera3D.updateNum}}n.a=h},function(d,n,u){'use strict';var o=u(19),l=u(0);class m extends l.a{constructor(){super('uPMatrix',35675,o.a.create()),this._matrix=o.a.create(),this.updated=!0,this.updateNum=0,this._minX=-1,this._maxX=1,this._minY=-1,this._maxY=1,this.clear=()=>{matrix.identity(),this.updated=!0},this.translate=(h)=>{matrix.translate(h),this.updated=!0},this.scale=(h)=>{matrix.scale(h),this.updated=!0},this.rotate=(h)=>{matrix.rotate(h),this.updated=!0}}get data(){return this.updated&&this.update(),this._data}setArea(h,T,_,E){this._minX=h,this._minY=T,this._maxX=_,this._maxY=E,this.updated=!0}update(){o.a.identity(this._data);const h=this._maxX-this._minX,T=this._maxY-this._minY;o.a.scale(this._data,[1/h,1/T]),o.a.multiply(this._data,this._matrix),this.updated=!1,this.updateNum++}}n.a=m},function(d,n,u){'use strict';function o(I){return _NumberisInteger(I)?I.toFixed(1):I}var l=u(18),m=u(2),h=u(0);const T=`
    attribute vec3 aVertexPosition;
    varying vec2 vTextureCoord;

    void main(void)
    {
        vTextureCoord = vec2(aVertexPosition.x * 0.5 + 0.5, aVertexPosition.y * 0.5 + 0.5);
        gl_Position = vec4(aVertexPosition, 1.0);
    }`,_=`
    precision mediump float;
    varying vec2 vTextureCoord;
    uniform sampler2D uColor;
    uniform sampler2D uDepth;

    uniform vec3 uColorFog;
    
    uniform int uDepthEnable;

    void main(void)
    {
        $chunkcall
        gl_FragColor = color;
    }`;class E extends l.a{constructor({minDepth:I=0.1,maxDepth:R=0.2,minPower:D=0.2,maxPower:P=1,depthCurve:F=100,color:U=[1,1,1]}){super(null,'aVertexPosition','uColor'),this.useColorTexture('uColor'),this.useDepthTexture('uDepth','uDepthEnable');const L=new h.a('uColorFog',35665,U);this.addUniform(L);const N=this._initFragmentShader(I,R,D,P,F);this.program=new m.a(T,N)}_initFragmentShader(I,R,D,P,F){let U=`
            float depthValue = 0.0;
            if (uDepthEnable >= 0) {
                vec4 depth = texture2D(uDepth, vTextureCoord.xy);
                depthValue = pow(depth.x, ${o(F)});
                depthValue = (depthValue - ${o(I)}) / ${o(R-I)};
                depthValue = clamp(depthValue, ${o(D)}, ${o(P)});
            }
            vec4 originalColor = texture2D(uColor, vTextureCoord.xy); 
            vec4 color = vec4(mix(originalColor.xyz, uColorFog, depthValue), originalColor.w);
        `;const L=_.replace('$chunkcall',U);return L}}n.a=E},function(d,n,u){'use strict';function o(I){return _NumberisInteger(I)?I.toFixed(1):I}var l=u(18),m=u(2),h=u(0);const T=`
    attribute vec3 aVertexPosition;
    varying vec2 vTextureCoord;

    void main(void)
    {
        vTextureCoord = vec2(aVertexPosition.x * 0.5 + 0.5, aVertexPosition.y * 0.5 + 0.5);
        gl_Position = vec4(aVertexPosition, 1.0);
    }`,_=`
    precision mediump float;
    varying vec2 vTextureCoord;
    uniform sampler2D uColor;
    uniform sampler2D uDepth;
    uniform int uSize;
    uniform int uDepthEnable;

    $chunkfct

    void main(void)
    {
        $chunkcall
        gl_FragColor = color;
    }`;class E extends l.a{constructor({minDepth:I=0.1,maxDepth:R=0.2,samples:D=5,xBlur:P=!0,power:F=1,depthCurve:U=100}){super(null,'aVertexPosition','uColor'),this.power=F,this.xBlur=P,this.depthCurve=U,this.useColorTexture('uColor'),this.useDepthTexture('uDepth','uDepthEnable');const L=this._initFragmentShader(I,R,D);this.program=new m.a(T,L),P?this.useUWidth('uSize',1):this.useUHeight('uSize',1)}_initFragmentShader(I=0.1,R=0.3,D=5){const P=this.xBlur,F=o(this.power),U=[];for(let C=0;C<D;C++){const M=this._getKernels(C+1);U.push(M)}let L='';for(let C=0;C<U.length;C++){const M=U[C];L+=`
            vec4 blur${C+1}(sampler2D i, vec2 uv) {
                vec2 m;
                vec4 color = texture2D(i, uv) * ${o(M[0])};`;for(let v=1;v<M.length;v++)L+=`
                m = ${P?'vec2('+v+'.0 * '+F+' / float(uSize), 0.0)':'vec2(0.0, '+v+'.0 * '+F+' / float(uSize))'};
                color += texture2D(i, uv + m) * ${o(M[v])};
                color += texture2D(i, uv - m) * ${o(M[v])};`;L+='return color; }'}let N=`
            float depthValue = 0.0;
            vec4 color;
            if (uDepthEnable >= 0) {
                vec4 depth = texture2D(uDepth, vTextureCoord.xy);
                depthValue = pow(depth.x, ${o(this.depthCurve)});
                
                int blurPower = int(floor(0.5 + (depthValue - ${o(I)}) * ${o(D)} / ${o(R-I)}));   
        `;for(let C=0;C<D;C++){const M='blurPower'+(C>D-2?' >= '+C:1>C?' < 1':' == '+C);N+=`${0<C?' else if':'if'} ( ${M}) {
                color = blur${C+1}(uColor, vTextureCoord.xy);
            }`}N+=`
        } else {
            color = texture2D(uColor, vTextureCoord.xy);
        }
        `;const A=_.replace('$chunkfct',L).replace('$chunkcall',N);return A}_getKernels(I){const R=[];let D=0;for(let P=1;P<I+2;P++){const F=3*(P-1)/I,U=Math.exp(-F*F);D+=2>P?U:U+U,R.push(U)}for(let P=0;P<R.length;P++)R[P]/=D;return R}}n.a=E},,function(d,n,u){'use strict';function o(We=null){let Ye=0;We&&(We.wheelDelta?Ye=We.wheelDelta:We.detail?Ye=-40*We.detail:We.deltaY&&(Ye=-40*We.deltaY)),He-=Ye/1e3,He=_Mathmin(_Mathmax(He,0.37),3),Y.fovy=45*He}function m(We){const Ye=We.clientX,qe=We.clientY,Ze=(Ye-Ve[0])/Ge[0],Ke=(qe-Ve[1])/Ge[1];Ve[0]=Ye,Ve[1]=qe,ke+=2*(Ze*_MathPI),Xe+=Ke*_MathPI,Xe=_Mathmax(_Mathmin(Xe,0.3*_MathPI),0.3*-_MathPI)}function h(){const Ye=document.body;Ye.removeEventListener('mousemove',m),Ye.removeEventListener('mouseup',h),Ye.removeEventListener('mouseleave',h),Ye.classList.remove('is-grabbing')}function T(){const We=1;Ge[0]=window.innerWidth,Ge[1]=window.innerHeight,Me.resize(Ge[0]*We,Ge[1]*We),W.width=Ge[0]*We,W.height=Ge[1]*We,Y.resize(...Ge),q.setArea(0,0,...Ge)}function _(){Y.clear(),Y.translate([0,0,-He]),Y.rotate(Xe,[1,0,0]),Y.rotate(ke,[0,1,0]),ie.transform.rotateY(5e-3),_e.transform.rotate(-5e-3,[0,1,0]),Te.transform.rotate(0.01,[0,1,0]),Fe.transform.rotate(-0.01,[0,1,0]),Ue.transform.rotate(0.025,[0.72,-0.33,0.5]),Me.draw(),requestAnimationFrame(_)}Object.defineProperty(n,'__esModule',{value:!0});var E=u(0),I=u(12),R=u(26),D=u(11),P=u(2),F=u(3),U=u(17),L=u(6),N=u(25),A=u(4),C=u(23),M=u(24),v=u(22),B=u(27),O=u(13),k=u(8),X=u(18),H=u(9),G=u(29),V=u(28);const W=document.body.querySelector('canvas'),Y=new O.a,q=new B.a,Z=new k.a;Z.bgColor=[0,0,0.1,1],Z.depthTest=!0;const K=`      
    attribute vec3 aVertexPosition;
    attribute vec4 aVertexColor;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec4 vColor;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vColor = aVertexColor;
    }
`,$=`
    precision mediump float;

    varying vec4 vColor;

    void main(void) {
        gl_FragColor = vColor;
    }
`,J=new P.a(K,$),Q=`
    attribute vec3 aVertexPosition;
    attribute vec4 aVertexColor;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec4 vColor;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        float zDepth = 0.2 * (8.0 - gl_Position.z);
        vec4 modifyColor = vec4(aVertexColor.rgb * zDepth, aVertexColor.a);
        vColor = modifyColor;
    }
`,ee=new P.a(Q,$),re=new F.a;re.addVertices('aVertexPosition',[0,1,0,-1,-1,1,1,-1,1,0,1,0,1,-1,1,1,-1,-1,0,1,0,1,-1,-1,-1,-1,-1,0,1,0,-1,-1,-1,-1,-1,1],3),re.addVertices('aVertexColor',[1,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,1,1,0,0,1,0,1,0,1,0,0,1,1,1,0,0,1,0,0,1,1,0,1,0,1],4);const ie=new A.a(re,J);ie.transform.translate([-1.5,-1.5,0]),ie.addGlobalUniform(Y);const se=`      
    attribute vec2 aVertexPosition;

    uniform mat3 uMVMatrix;
    uniform mat3 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {
        vec3 pos = uPMatrix * uMVMatrix * vec3(aVertexPosition, 0.0);
        gl_Position = vec4(pos.xy, 0.0, 1.0);
    }
`,de=`
    precision mediump float;

    uniform sampler2D uDiffuse1;

    void main(void) {
        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);
    }
`,ne=new P.a(se,de),le=new F.a;le.addVertices('aVertexPosition',[-1,-1,-1,1,1,-1,-1,1,1,1,1,-1],2);const pe=new N.a(le,ne);pe.order=1,pe.transform.scale([320,320]),pe.addGlobalUniform(q);const fe=new C.a;fe.addMesh(ie),Z.addMesh(fe),fe.setMask(new M.a(pe));const he=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],ce=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],ge=[[1,0,0,1],[1,1,0,1],[0,1,0,1],[1,0.5,0.5,1],[1,0,1,1],[0,0,1,1]];let be=[];for(let We in ge)for(let Ye=0;4>Ye;Ye++)be=be.concat(ge[We]);const xe=new F.a;xe.addVertices('aVertexPosition',he,3),xe.addVertices('aVertexColor',be,4),xe.addIndices(ce);const Te=new A.a(xe,ee);Te.transform.translate([1.5,-1.5,0]),Te.addGlobalUniform(Y),Z.addMesh(Te);const _e=new A.a(re,J);_e.transform.translate([-1.5,1.5,0]),_e.transform.scale([1,-1,1]),_e.addGlobalUniform(Y),Z.addMesh(_e);const Ee=`   
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vTextureCoord = aTextureCoord;
    }`,Ie=`
    precision mediump float;

    varying vec2 vTextureCoord;

    uniform sampler2D uDiffuse1;
    uniform sampler2D uDiffuse2;

    void main(void) {
        vec4 color1 = texture2D(uDiffuse1, vec2(vTextureCoord.s, vTextureCoord.t));
        vec4 color2 = texture2D(uDiffuse2, vec2(vTextureCoord.s, vTextureCoord.t));
        float power = ((sin(vTextureCoord.s * 3.1415)) * (sin(vTextureCoord.t * 3.1415)));
        gl_FragColor = mix(color1, color2, power);
    }`,Re=new P.a(Ee,Ie);const Pe=new U.a('uDiffuse1');Pe.addURL('assets/cube-diffuse.jpg');const we=new U.a('uDiffuse2');we.setParam(10240,9728),we.setParam(10241,9728),we.addURL('assets/cube-diffuse-2.png');const ye=new F.a;ye.addVertices('aVertexPosition',he,3),ye.addVertices('aTextureCoord',[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1],2),ye.addIndices(ce);const Fe=new A.a(ye,Re);Fe.addTexture(Pe),Fe.addTexture(we),Fe.transform.translate([1.5,1.5,0]),Fe.addGlobalUniform(Y),Z.addMesh(Fe);const Ue=new A.a(ye,Re);Ue.addTexture(Pe),Ue.addTexture(we),Ue.transform.translate([0,0,-8]),Ue.addGlobalUniform(Y),Z.addMesh(Ue);const Le=`   
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;

    varying vec2 vTextureCoord;

    void main(void) {

        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vTextureCoord = aTextureCoord;
    }`,Ne=`
    precision mediump float;

    varying vec2 vTextureCoord;

    uniform sampler2D uDiffuse1;

    void main(void) {
        vec4 color1 = texture2D(uDiffuse1, vec2(vTextureCoord.s, vTextureCoord.t));
        gl_FragColor = color1;
    }`,Ae=new R.a('uPMatrix',Y,1),Se=new P.a(Le,Ne),Ce=new v.a(ye,Se);Ce.addTexture(Pe),Ce.addUniform(Ae),Z.addMesh(Ce),Z.sort();const Me=new H.a(W);Me.passEnabled=!0,Me.addScene(Z);const ze=new V.a({minDepth:0.5,maxDepth:0.6,minPower:0,maxPower:0.5,depthCurve:100,color:[0.9,0.95,1]});Me.addPass(ze);const ve={minDepth:0.95,maxDepth:1,samples:20,xBlur:!0,power:1,depthCurve:1},Be=new G.a(ve);Me.addPass(Be),ve.xBlur=!1;const Oe=new G.a(ve);Me.addPass(Oe);let ke=0,Xe=0,He=2.5;const Ge=[0,0],Ve=[0,0];document.body.addEventListener('mousedown',function(We){const Ye=document.body;Ve[0]=We.clientX,Ve[1]=We.clientY,Ye.removeEventListener('mousemove',m),Ye.removeEventListener('mouseup',h),Ye.removeEventListener('mouseleave',h),Ye.addEventListener('mousemove',m),Ye.addEventListener('mouseup',h),Ye.addEventListener('mouseleave',h),Ye.classList.add('is-grabbing')}),window.addEventListener('wheel',o),window.onresize=T,T(),o(),window.scene=Z,window.render=Me,_()},,,function(d,n){'use strict';n.a=class{constructor(l){this.label=l}isInitialized(){return!0}init(){return!0}setTexture(l){this.pointer=l.pointer,this.target=l.target}bind(l,m,h){l.uniform1i(m,h),l.activeTexture(l.TEXTURE0+h),l.bindTexture(this.target,this.pointer)}}},function(d,n,u){'use strict';var o=u(19),l=u(0);class m extends l.a{constructor(h){super(h,35675,o.a.create()),this.updateNum=0,this.updated=!0,this.local=o.a.create(),this.parent=null}get global(){return this.update(),this._data}update(){const h=this.parent,T=null!==this.parent;if(this.updated||T&&this._parentUpdateNum!==h.updateNum){const _=this._data;T?(o.a.copy(h.global,_),o.a.multiply(_,this.local),this._parentUpdateNum=h.updateNum):o.a.copy(this.local,_),this.updateNum++,this.updated=!0}}clear(){o.a.identity(this.local),this.updateNum++,this.updated=!0}scale(h){o.a.scale(this.local,h),this.updateNum++,this.updated=!0}translate(h){o.a.translate(this.local,h),this.updateNum++,this.updated=!0}rotate(h){o.a.rotate(this.local,h),this.updateNum++,this.updated=!0}attach(h){this.parent=h,this._parentUpdateNum=h.updateNum,this.updateNum++,this.updated=!0}detach(){this.parent=null,this.updateNum++,this.updated=!0}}n.a=m}]);