!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=33)}([function(t,e,r){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e,r,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,t),this.label=e,this.type=r,this._data=n,this._init(r,a),this.updated=!0}return a(t,[{key:"_init",value:function(t,e){var r=this;switch(this.type){case 35675:this.bind=function(t,e){t.uniformMatrix3fv(e,!1,r.data)};break;case 35676:this.bind=function(t,e){t.uniformMatrix4fv(e,!1,r.data)};break;case 35664:this.bind=function(t,e){t.uniform2f.apply(t,[e].concat(n(r.data)))};break;case 35665:this.bind=function(t,e){t.uniform3f.apply(t,[e].concat(n(r.data)))};break;case 5124:this.bind=function(t,e){t.uniform1i(e,r.data)};break;case-1:this.bind=function(t,e){t.uniform1fv(e,r.data)};break;default:console.error("Uniform type unknow: {label:",this.label,", type:",t,"}")}}},{key:"data",get:function(){return this._data},set:function(t){this._data=t,this.updated=!0}}]),t}();e.default=o},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(){n(this,t),this.lastTexture=null,this.lastProgram=null,this.lastDepthTest=!1}return i(t,[{key:"optimizeTexture",value:function(t){var e=this.lastTexture;return this.lastTexture=t,t===e}},{key:"optimizeProgram",value:function(t){var e=this.lastProgram;return this.lastProgram=t,t===e}},{key:"optimizeDepthTest",value:function(t){var e=this.lastDepthTest;return this.lastDepthTest=t,e===t}}],[{key:"getInstance",value:function(e){var r=t.glList.indexOf(e);if(r<0){var n=new t;return t.glList.push(e),t.list.push(n),n}return t.list[r]}}]),t}();a.glList=[],a.list=[],e.default=a},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=0,o=function(){function t(e,r){n(this,t),this.vertexShaderSrc=e,this.fragmentShaderSrc=r,this.attribLocation={},this.uniformLocation={},this.textureLocation={},this.textureIndex={},this.textureNum=0,this.id=a++}return i(t,[{key:"isInitialized",value:function(){return!!this.pointer}},{key:"init",value:function(t){this.vertexShader=this._createShader(t,35633,this.vertexShaderSrc),this.fragmentShader=this._createShader(t,35632,this.fragmentShaderSrc);var e=t.createProgram();return t.attachShader(e,this.vertexShader),t.attachShader(e,this.fragmentShader),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)?(t.useProgram(e),this.pointer=e,!0):(console.error("Shader initialization error"),!1)}},{key:"getAttribLocation",value:function(t,e){var r=e.label;if(!this.attribLocation.hasOwnProperty(r)){var n=t.getAttribLocation(this.pointer,r);return t.enableVertexAttribArray(n),this.attribLocation[r]=n,n}return this.attribLocation[r]}},{key:"getUniformLocation",value:function(t,e){var r=e.label;if(!this.uniformLocation.hasOwnProperty(r)){var n=t.getUniformLocation(this.pointer,r);return this.uniformLocation[r]=n,n}return this.uniformLocation[r]}},{key:"getTextureLocationIndex",value:function(t,e){var r=e.label;if(!this.textureLocation.hasOwnProperty(r)||!this.textureIndex.hasOwnProperty(r)){var n=t.getUniformLocation(this.pointer,r);return this.textureLocation[r]=n,this.textureIndex[r]=this.textureNum,[n,this.textureNum++]}return[this.textureLocation[r],this.textureIndex[r]]}},{key:"bind",value:function(t){t.useProgram(this.pointer)}},{key:"_createShader",value:function(t,e,r){var n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:console.error("Une erreur est survenue au cours de la compilation du shader: "+t.getShaderInfoLog(n))}}]),t}();e.default=o},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(7),u=n(o),s=r(11),l=n(s),f=function(){function t(){i(this,t),this.attributes=[],this.buffers=[],this.hasIndices=!1,this.numItems=0}return a(t,[{key:"addVertices",value:function(t,e,r){var n=new l.default(t);n.setArray(new Float32Array(e),34962),n.setItems(5126,r),this.attributes.push(n),this.numItems<1&&(this.numItems=e.length/r)}},{key:"addIndices",value:function(t){var e=new u.default;e.setArray(new Uint16Array(t),34963),e.setItems(5125,1),this.hasIndices=!0,this.buffers.push(e),this.numItems=t.length}},{key:"display",value:function(t){this.hasIndices?t.drawElements(t.TRIANGLES,this.numItems,t.UNSIGNED_SHORT,0):t.drawArrays(t.TRIANGLES,0,this.numItems)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t;return e.attributes=this.attributes.map(function(t){return t.clone()}),e.buffers=this.buffers.map(function(t){return t.clone()}),e.hasIndices=this.hasIndices,e.numItems=this.numItems,e}}]),t}();e.default=f},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},l=r(6),f=n(l),h=r(12),c=n(h),d=function(t){function e(t,r){i(this,e);var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));n.depthTest=!0;var o=new c.default("uMVMatrix");return n.transform=o,n.addUniform(o),n}return o(e,t),u(e,[{key:"draw",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.transform&&this.transform.update(),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t,r)}},{key:"position",get:function(){return this.transform.getTranslation()}},{key:"rotation",get:function(){return this.transform.getRotation()}}]),e}(f.default);e.default=d},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,r,n,i,a,o,u,s,l,f,h,c,d,p,v,y){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=u,t[7]=s,t[8]=l,t[9]=f,t[10]=h,t[11]=c,t[12]=d,t[13]=p,t[14]=v,t[15]=y,t}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function(){function t(){n(this,t),console.warn("Matrix4 is a static class")}return o(t,null,[{key:"create",value:function(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}},{key:"clone",value:function(e){return t.copy(e)}},{key:"copy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16);return e.set(t),e}},{key:"identity",value:function(t){return i(t,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}},{key:"add",value:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[3],t[4]+=e[4],t[5]+=e[5],t[6]+=e[6],t[7]+=e[7],t[8]+=e[8],t[9]+=e[9],t[10]+=e[10],t[11]+=e[11],t[12]+=e[12],t[13]+=e[13],t[14]+=e[14],t[15]+=e[15],t}},{key:"subtract",value:function(t,e){return t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t[3]-=e[3],t[4]-=e[4],t[5]-=e[5],t[6]-=e[6],t[7]-=e[7],t[8]-=e[8],t[9]-=e[9],t[10]-=e[10],t[11]-=e[11],t[12]-=e[12],t[13]-=e[13],t[14]-=e[14],t[15]-=e[15],t}},{key:"multiplyScalar",value:function(t){return m1[0]*=t,m1[1]*=t,m1[2]*=t,m1[3]*=t,m1[4]*=t,m1[5]*=t,m1[6]*=t,m1[7]*=t,m1[8]*=t,m1[9]*=t,m1[10]*=t,m1[11]*=t,m1[12]*=t,m1[13]*=t,m1[14]*=t,m1[15]*=t,m1}},{key:"multiplyScalarAndAdd",value:function(t,e,r){return t[0]+=e[0]*r,t[1]+=e[1]*r,t[2]+=e[2]*r,t[3]+=e[3]*r,t[4]+=e[4]*r,t[5]+=e[5]*r,t[6]+=e[6]*r,t[7]+=e[7]*r,t[8]+=e[8]*r,t[9]+=e[9]*r,t[10]+=e[10]*r,t[11]+=e[11]*r,t[12]+=e[12]*r,t[13]+=e[13]*r,t[14]+=e[14]*r,t[15]+=e[15]*r,t}},{key:"exactEquals",value:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}},{key:"equals",value:function(t,e){var r=a(t,16),n=r[0],i=r[1],o=r[2],u=r[3],s=r[4],l=r[5],f=r[6],h=r[7],c=r[8],d=r[9],p=r[10],v=r[11],y=r[12],b=r[13],m=r[14],g=r[15],_=a(e,16),w=_[0],T=_[1],M=_[2],x=_[3],k=_[4],E=_[5],O=_[6],P=_[7],I=_[8],R=_[9],A=_[10],S=_[11],F=_[12],j=_[13],D=_[14],C=_[15];return Math.abs(n-w)<=1e-6*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-T)<=1e-6*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(o-M)<=1e-6*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(u-x)<=1e-6*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(s-k)<=1e-6*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(l-E)<=1e-6*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(f-O)<=1e-6*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(h-P)<=1e-6*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(c-I)<=1e-6*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(d-R)<=1e-6*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(p-A)<=1e-6*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(v-S)<=1e-6*Math.max(1,Math.abs(v),Math.abs(S))&&Math.abs(y-F)<=1e-6*Math.max(1,Math.abs(y),Math.abs(F))&&Math.abs(b-j)<=1e-6*Math.max(1,Math.abs(b),Math.abs(j))&&Math.abs(m-D)<=1e-6*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(g-C)<=1e-6*Math.max(1,Math.abs(g),Math.abs(C))}},{key:"transpose",value:function(t,e){if(e===t){var r=e[1],n=e[2],a=e[3],o=e[6],u=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=a,t[13]=u,t[14]=s}else i(t,e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]);return t}},{key:"invert",value:function(t){var e=a(t,16),r=e[0],n=e[1],o=e[2],u=e[3],s=e[4],l=e[5],f=e[6],h=e[7],c=e[8],d=e[9],p=e[10],v=e[11],y=e[12],b=e[13],m=e[14],g=e[15],_=r*l-n*s,w=r*f-o*s,T=r*h-u*s,M=n*f-o*l,x=n*h-u*l,k=o*h-u*f,E=c*b-d*y,O=c*m-p*y,P=c*g-v*y,I=d*m-p*b,R=d*g-v*b,A=p*g-v*m,S=_*A-w*R+T*I+M*P-x*O+k*E;return S?(S=1/S,i(t,(l*A-f*R+h*I)*S,(o*R-n*A-u*I)*S,(b*k-m*x+g*M)*S,(p*x-d*k-v*M)*S,(f*P-s*A-h*O)*S,(r*A-o*P+u*O)*S,(m*T-y*k-g*w)*S,(c*k-p*T+v*w)*S,(s*R-l*P+h*E)*S,(n*P-r*R-u*E)*S,(y*x-b*T+g*_)*S,(d*T-c*x-v*_)*S,(l*O-s*I-f*E)*S,(r*I-n*O+o*E)*S,(b*w-y*M-m*_)*S,(c*M-d*w+p*_)*S)):t}},{key:"adjoint",value:function(t){var e=a(t,16),r=e[0],n=e[1],o=e[2],u=e[3],s=e[4],l=e[5],f=e[6],h=e[7],c=e[8],d=e[9],p=e[10],v=e[11],y=e[12],b=e[13],m=e[14],g=e[15];return i(t,l*(p*g-v*m)-d*(f*g-h*m)+b*(f*v-h*p),-(n*(p*g-v*m)-d*(o*g-u*m)+b*(o*v-u*p)),n*(f*g-h*m)-l*(o*g-u*m)+b*(o*h-u*f),-(n*(f*v-h*p)-l*(o*v-u*p)+d*(o*h-u*f)),-(s*(p*g-v*m)-c*(f*g-h*m)+y*(f*v-h*p)),r*(p*g-v*m)-c*(o*g-u*m)+y*(o*v-u*p),-(r*(f*g-h*m)-s*(o*g-u*m)+y*(o*h-u*f)),r*(f*v-h*p)-s*(o*v-u*p)+c*(o*h-u*f),s*(d*g-v*b)-c*(l*g-h*b)+y*(l*v-h*d),-(r*(d*g-v*b)-c*(n*g-u*b)+y*(n*v-u*d)),r*(l*g-h*b)-s*(n*g-u*b)+y*(n*h-u*l),-(r*(l*v-h*d)-s*(n*v-u*d)+c*(n*h-u*l)),-(s*(d*m-p*b)-c*(l*m-f*b)+y*(l*p-f*d)),r*(d*m-p*b)-c*(n*m-o*b)+y*(n*p-o*d),-(r*(l*m-f*b)-s*(n*m-o*b)+y*(n*f-o*l)),r*(l*p-f*d)-s*(n*p-o*d)+c*(n*f-o*l))}},{key:"determinant",value:function(t){var e=a(t,16),r=e[0],n=e[1],i=e[2],o=e[3],u=e[4],s=e[5],l=e[6],f=e[7],h=e[8],c=e[9],d=e[10],p=e[11],v=e[12],y=e[13],b=e[14],m=e[15];return(r*s-n*u)*(d*m-p*b)-(r*l-i*u)*(c*m-p*y)+(r*f-o*u)*(c*b-d*y)+(n*l-i*s)*(h*m-p*v)-(n*f-o*s)*(h*b-d*v)+(i*f-o*l)*(h*y-c*v)}},{key:"multiply",value:function(t,e){var r=a(t,16),n=r[0],i=r[1],o=r[2],u=r[3],s=r[4],l=r[5],f=r[6],h=r[7],c=r[8],d=r[9],p=r[10],v=r[11],y=r[12],b=r[13],m=r[14],g=r[15],_=a(e,4),w=_[0],T=_[1],M=_[2],x=_[3];return t[0]=w*n+T*s+M*c+x*y,t[1]=w*i+T*l+M*d+x*b,t[2]=w*o+T*f+M*p+x*m,t[3]=w*u+T*h+M*v+x*g,w=e[4],T=e[5],M=e[6],x=e[7],t[4]=w*n+T*s+M*c+x*y,t[5]=w*i+T*l+M*d+x*b,t[6]=w*o+T*f+M*p+x*m,t[7]=w*u+T*h+M*v+x*g,w=e[8],T=e[9],M=e[10],x=e[11],t[8]=w*n+T*s+M*c+x*y,t[9]=w*i+T*l+M*d+x*b,t[10]=w*o+T*f+M*p+x*m,t[11]=w*u+T*h+M*v+x*g,w=e[12],T=e[13],M=e[14],x=e[15],t[12]=w*n+T*s+M*c+x*y,t[13]=w*i+T*l+M*d+x*b,t[14]=w*o+T*f+M*p+x*m,t[15]=w*u+T*h+M*v+x*g,t}},{key:"translate",value:function(t,e){var r=a(e,3),n=r[0],i=r[1],o=r[2];return t[12]=t[0]*n+t[4]*i+t[8]*o+t[12],t[13]=t[1]*n+t[5]*i+t[9]*o+t[13],t[14]=t[2]*n+t[6]*i+t[10]*o+t[14],t[15]=t[3]*n+t[7]*i+t[11]*o+t[15],t}},{key:"scale",value:function(t,e){var r=a(e,3),n=r[0],i=r[1],o=r[2];return t[0]*=n,t[1]*=n,t[2]*=n,t[3]*=n,t[4]*=i,t[5]*=i,t[6]*=i,t[7]*=i,t[8]*=o,t[9]*=o,t[10]*=o,t[11]*=o,t}},{key:"rotate",value:function(t,e,r){var n=a(r,3),i=n[0],o=n[1],u=n[2],s=Math.sqrt(i*i+o*o+u*u);if(Math.abs(s)>1e-6){s=1/s,i*=s,o*=s,u*=s;var l=Math.sin(e),f=Math.cos(e),h=1-f,c=a(t,12),d=c[0],p=c[1],v=c[2],y=c[3],b=c[4],m=c[5],g=c[6],_=c[7],w=c[8],T=c[9],M=c[10],x=c[11],k=i*i*h+f,E=o*i*h+u*l,O=u*i*h-o*l,P=i*o*h-u*l,I=o*o*h+f,R=u*o*h+i*l,A=i*u*h+o*l,S=o*u*h-i*l,F=u*u*h+f;t[0]=d*k+b*E+w*O,t[1]=p*k+m*E+T*O,t[2]=v*k+g*E+M*O,t[3]=y*k+_*E+x*O,t[4]=d*P+b*I+w*R,t[5]=p*P+m*I+T*R,t[6]=v*P+g*I+M*R,t[7]=y*P+_*I+x*R,t[8]=d*A+b*S+w*F,t[9]=p*A+m*S+T*F,t[10]=v*A+g*S+M*F,t[11]=y*A+_*S+x*F}return t}},{key:"rotateX",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),i=t[4],a=t[5],o=t[6],u=t[7],s=t[8],l=t[9],f=t[10],h=t[11];return t[4]=i*n+s*r,t[5]=a*n+l*r,t[6]=o*n+f*r,t[7]=u*n+h*r,t[8]=s*n-i*r,t[9]=l*n-a*r,t[10]=f*n-o*r,t[11]=h*n-u*r,t}},{key:"rotateY",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),i=a(t,4),o=i[0],u=i[1],s=i[2],l=i[3],f=t[8],h=t[9],c=t[10],d=t[11];return t[0]=o*n-f*r,t[1]=u*n-h*r,t[2]=s*n-c*r,t[3]=l*n-d*r,t[8]=o*r+f*n,t[9]=u*r+h*n,t[10]=s*r+c*n,t[11]=l*r+d*n,t}},{key:"rotateZ",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),i=a(t,8),o=i[0],u=i[1],s=i[2],l=i[3],f=i[4],h=i[5],c=i[6],d=i[7];return t[0]=o*n+f*r,t[1]=u*n+h*r,t[2]=s*n+c*r,t[3]=l*n+d*r,t[4]=f*n-o*r,t[5]=h*n-u*r,t[6]=c*n-s*r,t[7]=d*n-l*r,t}},{key:"fromTranslation",value:function(t){var e=a(t,3),r=e[0],n=e[1],o=e[2];return i(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),1,0,0,0,0,1,0,0,0,0,1,0,r,n,o,1)}},{key:"fromScaling",value:function(t){var e=a(t,3),r=e[0],n=e[1],o=e[2];return i(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),r,0,0,0,0,n,0,0,0,0,o,0,0,0,0,1)}},{key:"fromRotation",value:function(t,e){var r=a(e,3),n=r[0],o=r[1],u=r[2],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Float32Array(16),l=Math.sqrt(n*n+o*o+u*u);if(Math.abs(l)>1e-6){l=1/l,n*=l,o*=l,u*=l;var f=Math.sin(t),h=Math.cos(t),c=1-h;i(s,n*n*c+h,o*n*c+u*f,u*n*c-o*f,0,n*o*c-u*f,o*o*c+h,u*o*c+n*f,0,n*u*c+o*f,o*u*c-n*f,u*u*c+h,0,0,0,0,1)}return s}},{key:"fromXRotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),r=Math.sin(t),n=Math.cos(t);return i(e,1,0,0,0,0,n,r,0,0,-r,n,0,0,0,0,1)}},{key:"fromYRotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),r=Math.sin(t),n=Math.cos(t);return i(e,n,0,-r,0,0,1,0,0,r,0,n,0,0,0,0,1)}},{key:"fromZRotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),r=Math.sin(t),n=Math.cos(t);return i(e,n,r,0,0,-r,n,0,0,0,0,1,0,0,0,0,1)}},{key:"fromQuat",value:function(t){var e=a(t,4),r=e[0],n=e[1],o=e[2],u=e[3],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(16),l=r+r,f=n+n,h=o+o,c=r*l,d=n*l,p=n*f,v=o*l,y=o*f,b=o*h,m=u*l,g=u*f,_=u*h;return i(s,1-p-b,d+_,v-g,0,d-_,1-c-b,y+m,0,v+g,y-m,1-c-p,0,0,0,0,1)}},{key:"fromQuatTranslation",value:function(t,e){var r=a(t,4),n=r[0],o=r[1],u=r[2],s=r[3],l=a(e,3),f=l[0],h=l[1],c=l[2],d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Float32Array(16),p=n+n,v=o+o,y=u+u,b=n*p,m=n*v,g=n*y,_=o*v,w=o*y,T=u*y,M=s*p,x=s*v,k=s*y;return i(d,1-(_+T),m+k,g-x,0,m-k,1-(b+T),w+M,0,g+x,w-M,1-(b+_),0,f,h,c,1)}},{key:"fromQuatTranslationScale",value:function(t,e,r){var n=a(t,4),o=n[0],u=n[1],s=n[2],l=n[3],f=a(e,3),h=f[0],c=f[1],d=f[2],p=a(r,3),v=p[0],y=p[1],b=p[2],m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Float32Array(16),g=o+o,_=u+u,w=s+s,T=o*g,M=o*_,x=o*w,k=u*_,E=u*w,O=s*w,P=l*g,I=l*_,R=l*w;return i(m,(1-(k+O))*v,(M+R)*v,(x-I)*v,0,(M-R)*y,(1-(T+O))*y,(E+P)*y,0,(x+I)*b,(E-P)*b,(1-(T+k))*b,0,h,c,d,1)}},{key:"fromQuatTranslationScaleOrigin",value:function(t,e,r,n){var o=a(t,4),u=o[0],s=o[1],l=o[2],f=o[3],h=a(e,3),c=h[0],d=h[1],p=h[2],v=a(r,3),y=v[0],b=v[1],m=v[2],g=a(n,3),_=g[0],w=g[1],T=g[2],M=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Float32Array(16),x=u+u,k=s+s,E=l+l,O=u*x,P=u*k,I=u*E,R=s*k,A=s*E,S=l*E,F=f*x,j=f*k,D=f*E;return i(M,(1-(R+S))*y,(P+D)*y,(I-j)*y,0,(P-D)*b,(1-(O+S))*b,(A+F)*b,0,(I+j)*m,(A-F)*m,(1-(O+R))*m,0,c+_-(M[0]*_+M[4]*w+M[8]*T),d+w-(M[1]*_+M[5]*w+M[9]*T),p+T-(M[2]*_+M[6]*w+M[10]*T),1),M}},{key:"getTranslation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(3);return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}},{key:"getQuat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(4),r=t[0]+t[5]+t[10];if(r>0){var n=2*Math.sqrt(r+1);e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n,e[3]=.25*n}else if(t[0]>t[5]&t[0]>t[10]){var i=2*Math.sqrt(1+t[0]-t[5]-t[10]);e[0]=.25*i,e[1]=(t[1]+t[4])/i,e[2]=(t[8]+t[2])/i,e[3]=(t[6]-t[9])/i}else if(t[5]>t[10]){var a=Math.sqrt(1+t[5]-t[0]-t[10]);e[0]=(t[1]+t[4])/a*2,e[1]=.25*a,e[2]=(t[6]+t[9])/a,e[3]=(t[8]-t[2])/a}else{var o=2*Math.sqrt(1+t[10]-t[0]-t[5]);e[0]=(t[8]+t[2])/o,e[1]=(t[6]+t[9])/o,e[2]=.25*o,e[3]=(t[1]-t[4])/o}return e}},{key:"frustrum",value:function(t,e,r,n,a,o,u){var s=1/(r-e),l=1/(a-n),f=1/(o-u);return i(t,2*o*s,0,0,0,0,2*o*l,0,0,(r+e)*s,(a+n)*l,(u+o)*f,-1,0,0,u*o*2*f,0)}},{key:"perspective",value:function(t,e,r,n,a){var o=1/Math.tan(e/2),u=1/(n-a);return i(t,o/r,0,0,0,0,o,0,0,0,0,(a+n)*u,-1,0,0,2*a*n*u,0)}},{key:"perspectiveFromFieldOfView",value:function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),u=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(u+s),f=2/(a+o);return i(t,l,0,0,0,0,f,0,0,-(u-s)*l*.5,(a-o)*f*.5,n/(r-n),-1,0,0,n*r/(r-n),0)}},{key:"ortho",value:function(t,e,r,n,a,o,u){var s=1/(e-r),l=1/(n-a),f=1/(o-u);return i(t,-2*s,0,0,0,0,-2*l,0,0,0,0,2*f,0,(e+r)*s,(a+n)*l,(u+o)*f,1)}},{key:"lookAt",value:function(e,r,n,o){var u=a(r,3),s=u[0],l=u[1],f=u[2],h=a(o,3),c=h[0],d=h[1],p=h[2],v=a(n,3),y=v[0],b=v[1],m=v[2];if(Math.abs(s-y)<1e-6&&Math.abs(l-b)<1e-6&&Math.abs(f-m)<1e-6)return t.identity(e);var g=s-y,_=l-b,w=f-m,T=1/Math.sqrt(g*g+_*_+w*w);g*=T,_*=T,w*=T;var M=d*w-p*_,x=p*g-c*w,k=c*_-d*g;T=Math.sqrt(M*M+x*x+k*k),T?(T=1/T,M*=T,x*=T,k*=T):(M=0,x=0,k=0);var E=_*k-w*x,O=w*M-g*k,P=g*x-_*M;return T=Math.sqrt(E*E+O*O+P*P),T?(T=1/T,E*=T,O*=T,P*=T):(E=0,O=0,P=0),i(e,M,E,g,0,x,O,_,0,k,P,w,0,-(M*s+x*l+k*f),-(E*s+O*l+P*f),-(g*s+_*l+w*f),1)}},{key:"frob",value:function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}}]),t}();e.default=u},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(1),u=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(e,r){n(this,t),this.geom=e,this.program=r,this.uniforms=[],this.globalUniforms=[],this.textures=[],this.localCalls=[],this.globalCalls=[],this.order=1,this.visible=!0,this.depthTest=!1,this.blending={},this._isInitialized=!1}return a(t,[{key:"addBlending",value:function(t,e){this.blending[t]=e}},{key:"addUniform",value:function(t){this.uniforms.push(t)}},{key:"removeUniform",value:function(t){var e=this.uniforms.indexOf(t);e>-1&&this.uniforms.splice(e,1)}},{key:"addGlobalUniform",value:function(t){this.globalUniforms.push(t)}},{key:"removeGlobalUniform",value:function(t){var e=this.globalUniforms.indexOf(t);e>-1&&this.globalUniforms.splice(e,1)}},{key:"addTexture",value:function(t){this.textures.push(t)}},{key:"removeTexture",value:function(t){var e=this.textures.indexOf(t);e>-1&&this.textures.splice(e,1)}},{key:"isInitialized",value:function(){var t=this._isInitialized;if(t)return t;this.program.isInitialized()||(t=!1);var e=!0,r=!1,n=void 0;try{for(var i,a=this.geom.attributes[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){i.value.isInitialized()||(t=!1)}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}var o=!0,u=!1,s=void 0;try{for(var l,f=this.geom.buffers[Symbol.iterator]();!(o=(l=f.next()).done);o=!0){l.value.isInitialized()||(t=!1)}}catch(t){u=!0,s=t}finally{try{!o&&f.return&&f.return()}finally{if(u)throw s}}var h=!0,c=!1,d=void 0;try{for(var p,v=this.textures[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){p.value.isInitialized()||(t=!1)}}catch(t){c=!0,d=t}finally{try{!h&&v.return&&v.return()}finally{if(c)throw d}}return t}},{key:"_setCalls",value:function(t){var e=this,r=this.program,n=!0,a=!1,o=void 0;try{for(var u,s=this.geom.attributes[Symbol.iterator]();!(n=(u=s.next()).done);n=!0){var l=u.value,f=r.getAttribLocation(t,l);this.localCalls.push(l.bind.bind(l,t,f))}}catch(t){a=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}var h=!0,c=!1,d=void 0;try{for(var p,v=this.geom.buffers[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var y=p.value;this.localCalls.push(y.bind.bind(y,t))}}catch(t){c=!0,d=t}finally{try{!h&&v.return&&v.return()}finally{if(c)throw d}}var b=!0,m=!1,g=void 0;try{for(var _,w=this.uniforms[Symbol.iterator]();!(b=(_=w.next()).done);b=!0){var T=_.value,f=r.getUniformLocation(t,T);this.localCalls.push(T.bind.bind(T,t,f))}}catch(t){m=!0,g=t}finally{try{!b&&w.return&&w.return()}finally{if(m)throw g}}var M=!0,x=!1,k=void 0;try{for(var E,O=this.textures[Symbol.iterator]();!(M=(E=O.next()).done);M=!0){var P=E.value,I=r.getTextureLocationIndex(t,P),R=i(I,2),f=R[0],A=R[1];this.localCalls.push(P.bind.bind(P,t,f,A))}}catch(t){x=!0,k=t}finally{try{!M&&O.return&&O.return()}finally{if(x)throw k}}var S=!0,F=!1,j=void 0;try{for(var D,C=this.globalUniforms[Symbol.iterator]();!(S=(D=C.next()).done);S=!0){var U=D.value;!function(n){var i=r.getUniformLocation(t,n);e.globalCalls.push(function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]||n.updated)&&(n.bind.call(n,t,i),n.updated=!1)})}(U)}}catch(t){F=!0,j=t}finally{try{!S&&C.return&&C.return()}finally{if(F)throw j}}}},{key:"_initData",value:function(t){var e=(this.program,!0),r=!0,n=!1,i=void 0;try{for(var a,o=this.geom.attributes[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var u=a.value;u.isInitialized()||u.init(t)||(e=!1)}}catch(t){n=!0,i=t}finally{try{!r&&o.return&&o.return()}finally{if(n)throw i}}var s=!0,l=!1,f=void 0;try{for(var h,c=this.geom.buffers[Symbol.iterator]();!(s=(h=c.next()).done);s=!0){var d=h.value;d.isInitialized()||d.init(t)||(e=!1)}}catch(t){l=!0,f=t}finally{try{!s&&c.return&&c.return()}finally{if(l)throw f}}var p=!0,v=!1,y=void 0;try{for(var b,m=this.textures[Symbol.iterator]();!(p=(b=m.next()).done);p=!0){var g=b.value;g.isInitialized()||g.init(t)||(e=!1)}}catch(t){v=!0,y=t}finally{try{!p&&m.return&&m.return()}finally{if(v)throw y}}return e}},{key:"dispose",value:function(){this._isInitialized=!1,this.localCalls.length=0}},{key:"init",value:function(t){var e=(this.program,!0);return this.program.isInitialized()?this.program.bind(t):this.program.init(t)||(e=!1),this._initData(t)||(e=!1),e&&this.localCalls.length<1&&this._setCalls(t),this._callOptimizer=u.default.getInstance(t),this._isInitialized=e,e}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST));var r=this.program;if(this._callOptimizer.optimizeProgram(r)){var n=!0,i=!1,a=void 0;try{for(var o,u=this.globalCalls[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){(0,o.value)(!1)}}catch(t){i=!0,a=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}}else{this.program.bind(t);var s=!0,l=!1,f=void 0;try{for(var h,c=this.globalCalls[Symbol.iterator]();!(s=(h=c.next()).done);s=!0){(0,h.value)(!0)}}catch(t){l=!0,f=t}finally{try{!s&&c.return&&c.return()}finally{if(l)throw f}}}var d=Object.keys(this.blending),p=!0,v=!1,y=void 0;try{for(var b,m=d[Symbol.iterator]();!(p=(b=m.next()).done);p=!0){var g=b.value;t.blendFunc(g,this.blending[g])}}catch(t){v=!0,y=t}finally{try{!p&&m.return&&m.return()}finally{if(v)throw y}}d.length>0&&t.enable(3042);var _=!0,w=!1,T=void 0;try{for(var M,x=this.localCalls[Symbol.iterator]();!(_=(M=x.next()).done);_=!0){(0,M.value)()}}catch(t){w=!0,T=t}finally{try{!_&&x.return&&x.return()}finally{if(w)throw T}}var k=!0,E=!1,O=void 0;try{for(var P,I=e[Symbol.iterator]();!(k=(P=I.next()).done);k=!0){(0,P.value)()}}catch(t){E=!0,O=t}finally{try{!k&&I.return&&I.return()}finally{if(E)throw O}}this.geom.display(t)}}]),t}();e.default=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(){n(this,t),this.pointer=null,this.gl=null,this.arrayType=34962,this.data=null,this.arrayUsage=35044}return i(t,[{key:"isInitialized",value:function(){return!!this.pointer}},{key:"setArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.arrayType,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.arrayUsage;this.arrayType=e,this.data=t,this.arrayUsage=r;var n=this.gl;n&&(n.bindBuffer(e,this.pointer),n.bufferData(e,t,arrayUsage))}},{key:"setItems",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5126,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;this.itemType=t,this.itemSize=e}},{key:"init",value:function(t){var e=t.createBuffer();return t.bindBuffer(this.arrayType,e),t.bufferData(this.arrayType,this.data,this.arrayUsage),this.pointer=e,this.gl=t,!0}},{key:"bind",value:function(t){t.bindBuffer(this.arrayType,this.pointer)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t;return e.setArray(this.data,this.arrayType,this.arrayUsage),e.setItems(this.itemType,this.itemSize),e}}]),t}();e.default=a},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(1),u=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(){n(this,t),this.meshes=[],this.depthTest=!0,this.sortCompare=function(t,e){return t.order!==e.order?t.order-e.order:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.textures&&e.textures&&t.textures.length>0&&t.textures.length>0?t.textures[0].id-e.textures[1].id:0},this._updateList=[]}return a(t,[{key:"addMesh",value:function(t){this.meshes.push(t)}},{key:"removeMesh",value:function(t){var e=this.meshes.indexOf(t);e>-1&&this.meshes.splice(e,1)}},{key:"sort",value:function(){this.meshes.sort(this.sortCompare)}},{key:"init",value:function(t){console.log(t),this._callOptimizer=u.default.getInstance(t)}},{key:"draw",value:function(t){for(;this._updateList.length>0;)this._updateList.pop()(t);this._callOptimizer.optimizeDepthTest(this.depthTest)||(this.depthTest?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT);var e=!0,r=!1,n=void 0;try{for(var i,a=this.meshes[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o.visible&&(o.isInitialized()?o.draw(t):(o.init(t),o.draw(t)))}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}}},{key:"bgColor",set:function(t){var e=i(t,4),r=e[0],n=e[1],a=e[2],o=e[3],u=void 0===o?1:o;this._updateList.push(function(t){return t.clearColor(r,n,a,u)}),this._bgColor=[r,n,a,u]},get:function(){return this._bgColor}}]),t}();e.default=s},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(16),o=function(t){return t&&t.__esModule?t:{default:t}}(a),u=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{antialias:!0,stencil:!0,alpha:!0,width:640,height:360};n(this,t),this.width=r.width,this.height=r.height,this.screenRecorder=new o.default(r.width,r.height,!0,!0),this.passEnabled=!0,this.scenes=[],this.passList=[],this.isEnable=!1,this._init(e,{antialias:r.antialias,stencil:r.stencil,alpha:r.alpha}),this._initScreenRecorder(this.gl)}return i(t,[{key:"_init",value:function(t,e){var r=void 0;try{r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)}catch(t){console.error("Could not initialise WebGL:",t.message)}r||console.error("Could not initialise WebGL"),this.gl=r,this.gl.viewport(0,0,this.width,this.height)}},{key:"_initScreenRecorder",value:function(t){if(this.screenRecorder.init(t),!this.screenRecorder.depthTexture){var e=!0,r=!1,n=void 0;try{for(var i,a=this.passList[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;this._disableDepthInTexture(o,t)}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}}}},{key:"isInitialized",value:function(){return this.screenRecorder.isInitialized()}},{key:"addScene",value:function(t){t.init(this.gl),this.scenes.push(t)}},{key:"resize",value:function(t,e){this.width=t,this.height=e,this.gl.viewport(0,0,this.width,this.height),this.screenRecorder.resize(t,e,this.gl);var r=!0,n=!1,i=void 0;try{for(var a,o=this.passList[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){a.value.resize(t,e)}}catch(t){n=!0,i=t}finally{try{!r&&o.return&&o.return()}finally{if(n)throw i}}}},{key:"_disableDepthInTexture",value:function(t,e){t.inDepthTexture&&t.setDepthTexture(!1,e)}},{key:"addPass",value:function(t){t.init(this.gl,[]),this.screenRecorder.isInitialized()&&!this.screenRecorder.depthTexture&&this._disableDepthInTexture(t,this.gl),t.uWidth&&(t.uWidth.data=this.width),t.uHeight&&(t.uHeight.data=this.height),this.passList.push(t),this.isEnable=!0}},{key:"removePass",value:function(t){var e=this.passList.indexOf(t);e>-1&&this.passList.splice(e,1),this.isEnable=this.passList.length>0}},{key:"draw",value:function(){var t=this.gl,e=this.passList.length;if(this.passEnabled&&e>0&&this.scenes.length>0){this.screenRecorder.start(t,!0),this.scenes[0].draw(t),this.screenRecorder.stop(t),this.screenRecorder.pingpong();for(var r=0;r<e;r++){var n=this.passList[r];r>e-2||this.screenRecorder.start(t,!1),this.screenRecorder.pingpong(),n.inColorTexture&&n.inColorTexture.setTexture(this.screenRecorder.colorTexture),n.inDepthTexture&&this.screenRecorder.depthTexture&&n.inDepthTexture.setTexture(this.screenRecorder.depthTexture),n.draw(t),this.screenRecorder.stop(t)}}else this.scenes.length>0&&this.scenes[0].draw(t)}}]),t}();e.default=u},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){i=!0,a=t}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(1),u=function(t){return t&&t.__esModule?t:{default:t}}(o),s=0,l=function(){function t(e){n(this,t),this.id=s++,this.label=e,this.mipmap=!0,this.img=null,this.width=null,this.height=null,this.pointer=null,this.parameters=[],this.setType(),this.setInternalFormat(),this.setFormat(),this.setTarget()}return a(t,[{key:"resize",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.width=t,this.height=e,r?(r.bindTexture(this.target,this.pointer),r.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img)):this.updated=!0}},{key:"setTempColor",value:function(t){this.setImg(new Uint8Array(t),1,1)}},{key:"setImg",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array([255,255,255,255]),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.img=t,this.width=e,this.height=r}},{key:"setType",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5121;this.type=t}},{key:"setInternalFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6408;this.internalFormat=t}},{key:"setFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6408;this.format=t}},{key:"setTarget",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3553;this.target=t}},{key:"setParam",value:function(t,e){var r=this.parameters.find(function(e){return e[0]===t});r>-1?this.parameters[r][1]=e:this.parameters.push([t,e])}},{key:"isInitialized",value:function(){return!!this.pointer}},{key:"setDefaultParams",value:function(t){this.mipmap?this.setParam(t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR):(this.setParam(t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),this.setParam(t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this.setParam(t.TEXTURE_MIN_FILTER,t.LINEAR))}},{key:"initParams",value:function(e){if(this.mipmap){var r=this.img;null===r?console.warn("You need an image to set the parameters of texture"):t.IS_POWER_OF_2(r.width)&&t.IS_POWER_OF_2(r.height)?e.generateMipmap(this.target):(this.mipmap=!1,console.warn("You need a power of 2 for the size of the mipmaped texture"))}this.parameters.length<1&&this.setDefaultParams(e);var n=!0,a=!1,o=void 0;try{for(var u,s=this.parameters[Symbol.iterator]();!(n=(u=s.next()).done);n=!0){var l=u.value,f=i(l,2),h=f[0],c=f[1];e.texParameteri(this.target,h,c)}}catch(t){a=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}}},{key:"init",value:function(e){var r=e.createTexture();return t._DATA_INITIALIZED||t.SET_DATA(e),e.bindTexture(this.target,r),e.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.initParams(e),this._callOptimizer=u.default.getInstance(e),this.pointer=r,!0}},{key:"bind",value:function(t,e,r){this._callOptimizer.optimizeTexture(this)||(t.uniform1i(e,r),t.activeTexture(t.TEXTURE0+r),t.bindTexture(this.target,this.pointer),this.updated&&(t.texImage2D(this.target,0,this.internalFormat,this.width,this.height,0,this.format,this.type,this.img),this.updated=!1))}},{key:"free",value:function(t){t.bindTexture(t.TEXTURE_2D,null)}}],[{key:"IS_POWER_OF_2",value:function(t){return 0==(t&t-1)}},{key:"SET_DATA",value:function(e){t.MAX_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE),t.FORMAT={};for(var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)t.FORMAT[r[n]]=!0;t._DATA_INITIALIZED=!0}}]),t}();e.default=l},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},s=r(7),l=function(t){return t&&t.__esModule?t:{default:t}}(s),f=function(t){function e(t){n(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.label=t,r}return a(e,t),o(e,[{key:"bind",value:function(t,r){u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,t),t.vertexAttribPointer(r,this.itemSize,this.itemType,!1,0,0)}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e(this.label);return t.label=this.label,u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clone",this).call(this,t),t}}]),e}(l.default);e.default=f},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(5),l=n(s),f=r(0),h=n(f),c=function(t){function e(t){i(this,e);var r=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,35676,l.default.create()));return r.updateNum=0,r.updated=!0,r.local=l.default.create(),r.parent=null,r}return o(e,t),u(e,[{key:"update",value:function(){var t=this.parent,e=null!==this.parent;if(this.updated||e&&this._parentUpdateNum!==t.updateNum){var r=this._data;e?(l.default.copy(t.global,r),l.default.multiply(r,this.local),this._parentUpdateNum=t.updateNum):l.default.copy(this.local,r),this.updateNum++,this.updated=!0}}},{key:"clear",value:function(){l.default.identity(this.local),this.updateNum++,this.updated=!0}},{key:"scale",value:function(t){l.default.scale(this.local,t),this.updateNum++,this.updated=!0}},{key:"translate",value:function(t){l.default.translate(this.local,t),this.updateNum++,this.updated=!0}},{key:"rotate",value:function(t,e){l.default.rotate(this.local,t,e),this.updateNum++,this.updated=!0}},{key:"rotateX",value:function(t){l.default.rotateX(this.local,t),this.updateNum++,this.updated=!0}},{key:"rotateY",value:function(t){l.default.rotateY(this.local,t),this.updateNum++,this.updated=!0}},{key:"rotateZ",value:function(t){l.default.rotateZ(this.local,t),this.updateNum++,this.updated=!0}},{key:"attach",value:function(t){this.parent=t,this._parentUpdateNum=t.updateNum,this.updateNum++,this.updated=!0}},{key:"detach",value:function(){this.parent=null,this.updateNum++,this.updated=!0}},{key:"global",get:function(){return this.update(),this._data}}]),e}(h.default);e.default=c},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(5),l=n(s),f=r(0),h=n(f),c=function(t){function e(){i(this,e);var t=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"uPMatrix",35676,l.default.create()));t.fovy=45,t.near=.1,t.far=100;var r=l.default.create();return t._matrix=r,t.updated=!0,t.updateNum=0,t._ratio=0,t.clear=function(){l.default.identity(r),t.updated=!0},t.translate=function(e){l.default.translate(r,e),t.updated=!0},t.scale=function(e){l.default.scale(r,e),t.updated=!0},t.rotate=function(e,n){l.default.rotate(r,e,n),t.updated=!0},t.rotateX=function(e){l.default.rotateX(r,e),t.updated=!0},t.rotateY=function(e){l.default.rotateY(r,e),t.updated=!0},t.rotateZ=function(e){l.default.rotateZ(r,e),t.updated=!0},t.lookAt=function(e,n,i){l.default.lookAt(r,e,n,i),t.updated=!0},t}return o(e,t),u(e,[{key:"resize",value:function(t,e){this._ratio=t/e,this.updated=!0}},{key:"update",value:function(){l.default.perspective(this._data,this.fovy*Math.PI/180,this._ratio,this.near,this.far),l.default.multiply(this._data,this._matrix),this.updated=!1,this.updateNum++}},{key:"data",get:function(){return this.updated&&this.update(),this._data}},{key:"ratio",get:function(){return this._ratio},set:function(t){this._ratio=t,this.updated=!0}}]),e}(h.default);e.default=c},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(){n(this,t),this.pointer=null}return i(t,[{key:"isInitialized",value:function(){return!!this.pointer}},{key:"init",value:function(t){var e=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,e),this.pointer=e,!0}},{key:"bind",value:function(t){t.bindFramebuffer(t.FRAMEBUFFER,this.pointer)}},{key:"free",value:function(t){t.bindFramebuffer(t.FRAMEBUFFER,null)}}]),t}();e.default=a},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(e,r){n(this,t),this.pointer=null,this.width=e,this.height=r}return i(t,[{key:"resize",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.width=t,this.height=e,r?(r.bindRenderbuffer(r.RENDERBUFFER,this.pointer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,t,e)):this.updated=!0}},{key:"isInitialized",value:function(){return!!this.pointer}},{key:"init",value:function(t){var e=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,e),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),this.pointer=e}},{key:"bind",value:function(t){t.bindRenderbuffer(t.RENDERBUFFER,renderBuffer),this.updated&&(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),this.updated=!1)}}]),t}();e.default=a},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(10),u=n(o),s=r(15),l=n(s),f=r(14),h=n(f),c=function(){function t(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,t),this.captureDepth=n,this.recordDepth=a,this.width=e,this.height=r,this.updated=!1,this._pingpong=!1,this._colorTextures=[this._genColorTexture("frameBufferColor0",e,r),this._genColorTexture("frameBufferColor1",e,r)],this.frameBuffer=new h.default}return a(t,[{key:"_genDepthTexture",value:function(t,e,r){var n=new u.default;return n.mipmap=!1,n.setInternalFormat(6402),n.setFormat(6402),n.setType(5123),n.setParam(10242,33071),n.setParam(10243,33071),n.setParam(10241,9728),n.setParam(10240,9728),n.setImg(null,e,r),n}},{key:"_genColorTexture",value:function(t,e,r){var n=new u.default(t);return n.mipmap=!1,n.setImg(null,e,r),n}},{key:"pingpong",value:function(){this._pingpong=!this._pingpong}},{key:"resize",value:function(t,e,r){this.width=t,this.height=e,this.pingpong(),this.colorTexture.resize(t,e,r),this.pingpong(),this.colorTexture.resize(t,e,r),this.depthTexture&&this.depthTexture.resize(t,e,r),this.renderBuffer&&this.renderBuffer.resize(t,e,r)}},{key:"isInitialized",value:function(){return!!this.frameBuffer.pointer}},{key:"init",value:function(e){return t._DATA_INITIALIZED||t.SET_DATA(e),this.recordDepth&&(t.WEBGL_depth_texture?(this.depthTexture=this._genDepthTexture("frameBufferDepth",this.width,this.height),this.depthTexture.init(e)):(console.warn("WEBGL_depth_texture Extension not available!"),this.recordDepth=!1)),this.captureDepth&&(this.renderBuffer=new l.default(this.width,this.height),this.renderBuffer.init(e)),this.frameBuffer.init(e),this.pingpong(),this.colorTexture.init(e),this.pingpong(),this.colorTexture.init(e),this.depthTexture?e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this.depthTexture.pointer,0):this.renderBuffer&&e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.renderBuffer.pointer),e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),!0}},{key:"start",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.frameBuffer.bind(t),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.colorTexture.pointer,0),this.depthTexture?t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,e?this.depthTexture.pointer:null,0):this.renderBuffer&&t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e?this.renderBuffer.pointer:null)}},{key:"stop",value:function(t){this.frameBuffer.free(t)}},{key:"colorTexture",get:function(){return this._colorTextures[this._pingpong?1:0]}}],[{key:"SET_DATA",value:function(e){t.WEBGL_depth_texture=e.getExtension("WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture"),t._DATA_INITIALIZED=!0}}]),t}();e.default=c},,,,function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},s=r(3),l=function(t){return t&&t.__esModule?t:{default:t}}(s),f=[-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5],h=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],c=[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1],d=function(t){function e(){n(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.addVertices("aVertexPosition",f,3),t.addIndices(h),t}return a(e,t),o(e,[{key:"addColors",value:function(t,e,r,n,i,a){var o=[t,e,r,n,i,a],u=[];for(var s in o)for(var l=0;l<4;l++)u=u.concat(o[s]);this.addVertices("aVertexColor",u,4)}},{key:"addUV",value:function(){this.addVertices("aTextureCoord",c,2)}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e;return u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clone",this).call(this,t)}}]),e}(l.default);e.default=d},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},s=r(3),l=function(t){return t&&t.__esModule?t:{default:t}}(s),f=[-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5],h=[0,1,2,0,2,3,4,5,6,4,6,7,3,2,6,3,6,5,0,4,7,0,7,1,7,6,2,7,2,1,0,3,5,0,5,4],c=function(t){function e(){n(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.addVertices("aVertexPosition",f,3),t.addIndices(h),t}return a(e,t),o(e,[{key:"addColors",value:function(t,e,r,n,i,a,o,u){var s=[t,e,r,n,i,a,o,u],l=[];for(var f in s)l=l.concat(s[f]);this.addVertices("aVertexColor",l,4)}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new CubeGeom;return u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clone",this).call(this,t)}}]),e}(l.default);e.default=c},,,,,,,,,,,,function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(){return[Math.random(),Math.random(),Math.random(),1]}function a(){var t=[window.innerWidth,window.innerHeight];x.resize(1*t[0],1*t[1]),w.width=1*t[0],w.height=1*t[1],T.resize.apply(T,t)}function o(){R.transform.rotate(.01,[0,1,.5]),A.transform.rotate(-.1,[1.5,.1,.5]),S.transform.rotate(.1,[1,.5,-.5]),x.draw(),requestAnimationFrame(o)}var u=r(2),s=n(u),l=r(20),f=n(l),h=r(21),c=n(h),d=r(4),p=n(d),v=r(13),y=n(v),b=r(8),m=n(b),g=r(9),_=n(g),w=document.body.querySelector("canvas"),T=new y.default;T.translate([0,0,-10]);var M=new m.default;M.bgColor=[.5,0,.5,1],M.depthTest=!0;var x=new _.default(w);x.passEnabled=!1,x.addScene(M);var k=new s.default("      \n    attribute vec3 aVertexPosition;\n    attribute vec4 aVertexColor;\n\n    uniform mat4 uMVMatrix;\n    uniform mat4 uPMatrix;\n\n    varying vec4 vColor;\n    varying vec3 vPos;\n\n    void main(void) {\n        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n        vColor = aVertexColor;\n        vPos = aVertexPosition;\n    }\n","\n    precision mediump float;\n\n    varying vec4 vColor;\n    varying vec3 vPos;\n\n    // https://stackoverflow.com/questions/5149544/can-i-generate-a-random-number-inside-a-pixel-shader\n    float random( vec2 p ) // Version 2\n    {\n        // e^pi (Gelfond's constant)\n        // 2^sqrt(2) (GelfondSchneider constant)\n        vec2 r = vec2( 23.14069263277926, 2.665144142690225 );\n        // return fract( cos( mod( 12345678., 256. * dot(p,r) ) ) ); // ver1\n        return fract(cos(dot(p,r)) * 123456.); // ver2\n    }\n\n    void main(void)\n    {\n        vec4 noise = vec4(\n            random(vPos.xy),\n            random(vPos.yz),\n            random(vPos.xz),\n            0.0);\n        gl_FragColor = vColor + noise * 0.001;\n    }\n"),E=[i(),i(),i(),i(),i(),i()],O=[i(),i(),i(),i(),i(),i(),i(),i()],P=new f.default;P.addColors.apply(P,E);var I=new c.default;I.addColors.apply(I,O);var R=new p.default(I,k);R.transform.scale([2,2,2]),R.addGlobalUniform(T),M.addMesh(R);var A=new p.default(P,k);A.transform.translate([-1.5,0,0]),A.transform.scale([.5,.5,.5]),A.transform.attach(R.transform),A.addGlobalUniform(T),M.addMesh(A);var S=new p.default(I,k);S.transform.translate([0,0,-1.5]),S.transform.scale([.5,.5,.5]),S.transform.attach(A.transform),S.addGlobalUniform(T),M.addMesh(S),window.onresize=a,a(),window.scene=M,o()}]);